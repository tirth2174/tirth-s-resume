//
//  Copyright 2019 mParticle, Inc.
//
//  Licensed under the Apache License, Version 2.0 (the "License");
//  you may not use this file except in compliance with the License.
//  You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
//  Unless required by applicable law or agreed to in writing, software
//  distributed under the License is distributed on an "AS IS" BASIS,
//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//  See the License for the specific language governing permissions and
//  limitations under the License.
//
//  Uses portions of code from jQuery
//  jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license

window.mParticle = window.mParticle || {};;
window.mParticle.config = window.mParticle.config || {};;
window.mParticle.config.serviceUrl = 'jssdk.mparticle.com/v2/JS/';;
window.mParticle.config.secureServiceUrl = 'jssdks.mparticle.com/v2/JS/';;
window.mParticle.config.appName = window.mParticle.config.appName || "Anchor.fm";;
window.mParticle.config.minWebviewBridgeVersion = 1;
window.mParticle.config.workspaceToken = "5D85E968";;
window.mParticle.config.aliasMaxWindow = 90;
window.mParticle.config.kitConfigs = window.mParticle.config.kitConfigs || [];;
window.mParticle.config.pixelConfigs = window.mParticle.config.pixelConfigs || [];;
window.mParticle.config.flags = {"eventsV3":"100","eventBatchingIntervalMillis":"5000","offlineStorage":"100"};
window.mParticle.config.dataPlan = window.mParticle.config.dataPlan || {};;
window.mParticle.config.dataPlan.document = null;
var mParticle=function(){function a(n){"@babel/helpers - typeof";return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},a(n)}function br(n,t){var i,r;if(a(n)!=="object"||n===null)return n;if(i=n[Symbol.toPrimitive],i!==undefined){if(r=i.call(n,t||"default"),a(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.");}return(t==="string"?String:Number)(n)}function kr(n){var t=br(n,"string");return a(t)==="symbol"?t:String(t)}function ei(n,t,i){return t=kr(t),t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function ti(n,t){function i(){this.constructor=n}if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");oi(n,t);n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}function at(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})}function vt(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f}function gr(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n["default"]:n}function ut(n){var t=0,r,i;if(n===undefined||n===null)return 0;if(n=n.toString().toLowerCase(),Array.prototype.reduce)return n.split("").reduce(function(n,t){return n=(n<<5)-n+t.charCodeAt(0),n&n},0);if(n.length===0)return t;for(i=0;i<n.length;i++)r=n.charCodeAt(i),t=(t<<5)-t+r,t=t&t;return t}function di(n,t,r){var f,s,e,h,o,c;if(!n||!t||t.length<1)return null;var l=r.Identity.getCurrentUser(),a=[],u=null;for(f=0,s=t;f<s.length;f++)e=s[f],e&&(u=e,h=hi(e),h&&a.push(h));return u?(o=null,y(u.ConsentState)?y(l)||(o=l.getConsentState()):o=u.ConsentState,c={source_request_id:r._Helpers.generateUniqueId(),mpid:n,timestamp_unixtime_ms:(new Date).getTime(),environment:u.Debug?i.BatchEnvironmentEnum.development:i.BatchEnvironmentEnum.production,events:a,mp_deviceid:u.DeviceId,sdk_version:u.SDKVersion,application_info:{application_version:u.AppVersion,application_name:u.AppName,package:u.Package,sideloaded_kits_count:r._Store.sideloadedKitsCount},device_info:{platform:i.DeviceInformationPlatformEnum.web,screen_width:window.screen.width,screen_height:window.screen.height},user_attributes:u.UserAttributes,user_identities:gu(u.UserIdentities),consent_state:bu(o),integration_attributes:u.IntegrationAttributes},u.DataPlan&&u.DataPlan.PlanId&&(c.context={data_plan:{plan_id:u.DataPlan.PlanId,plan_version:u.DataPlan.PlanVersion||undefined}}),c):null}function bu(n){if(y(n))return null;return{gdpr:ku(n.getGDPRConsentState()),ccpa:du(n.getCCPAConsentState())}}function ku(n){var i,t;if(!n)return null;i={};for(t in n)n.hasOwnProperty(t)&&(i[t]={consented:n[t].Consented,hardware_id:n[t].HardwareId,document:n[t].ConsentDocument,timestamp_unixtime_ms:n[t].Timestamp,location:n[t].Location});return i}function du(n){if(!n)return null;return{data_sale_opt_out:{consented:n.Consented,hardware_id:n.HardwareId,document:n.ConsentDocument,timestamp_unixtime_ms:n.Timestamp,location:n.Location}}}function gu(t){var i,u,f,r;if(!t||!t.length)return null;for(i={},u=0,f=t;u<f.length;u++){r=f[u];switch(r.Type){case n.IdentityType.CustomerId:i.customer_id=r.Identity;break;case n.IdentityType.Email:i.email=r.Identity;break;case n.IdentityType.Facebook:i.facebook=r.Identity;break;case n.IdentityType.FacebookCustomAudienceId:i.facebook_custom_audience_id=r.Identity;break;case n.IdentityType.Google:i.google=r.Identity;break;case n.IdentityType.Microsoft:i.microsoft=r.Identity;break;case n.IdentityType.Other:i.other=r.Identity;break;case n.IdentityType.Other2:i.other_id_2=r.Identity;break;case n.IdentityType.Other3:i.other_id_3=r.Identity;break;case n.IdentityType.Other4:i.other_id_4=r.Identity;break;case n.IdentityType.Other5:i.other_id_5=r.Identity;break;case n.IdentityType.Other6:i.other_id_6=r.Identity;break;case n.IdentityType.Other7:i.other_id_7=r.Identity;break;case n.IdentityType.Other8:i.other_id_8=r.Identity;break;case n.IdentityType.Other9:i.other_id_9=r.Identity;break;case n.IdentityType.Other10:i.other_id_10=r.Identity;break;case n.IdentityType.MobileNumber:i.mobile_number=r.Identity;break;case n.IdentityType.PhoneNumber2:i.phone_number_2=r.Identity;break;case n.IdentityType.PhoneNumber3:i.phone_number_3=r.Identity}}return i}function hi(t){if(!t)return null;switch(t.EventDataType){case n.MessageType.AppStateTransition:return cf(t);case n.MessageType.Commerce:return sf(t);case n.MessageType.CrashReport:return hf(t);case n.MessageType.OptOut:return yf(t);case n.MessageType.PageEvent:return pf(t);case n.MessageType.PageView:return vf(t);case n.MessageType.Profile:return null;case n.MessageType.SessionEnd:return lf(t);case n.MessageType.SessionStart:return af(t);case n.MessageType.UserAttributeChange:return kf(t);case n.MessageType.UserIdentityChange:return df(t)}return null}function nf(n){if(!n)return i.ProductActionActionEnum.unknown;switch(n){case w.AddToCart:return i.ProductActionActionEnum.addToCart;case w.AddToWishlist:return i.ProductActionActionEnum.addToWishlist;case w.Checkout:return i.ProductActionActionEnum.checkout;case w.CheckoutOption:return i.ProductActionActionEnum.checkoutOption;case w.Click:return i.ProductActionActionEnum.click;case w.Purchase:return i.ProductActionActionEnum.purchase;case w.Refund:return i.ProductActionActionEnum.refund;case w.RemoveFromCart:return i.ProductActionActionEnum.removeFromCart;case w.RemoveFromWishlist:return i.ProductActionActionEnum.removeFromWishlist;case w.ViewDetail:return i.ProductActionActionEnum.viewDetail;default:return i.ProductActionActionEnum.unknown}}function tf(n){if(!n.ProductAction)return null;return{action:nf(n.ProductAction.ProductActionType),checkout_step:n.ProductAction.CheckoutStep,checkout_options:n.ProductAction.CheckoutOptions,transaction_id:n.ProductAction.TransactionId,affiliation:n.ProductAction.Affiliation,total_amount:n.ProductAction.TotalAmount,tax_amount:n.ProductAction.TaxAmount,shipping_amount:n.ProductAction.ShippingAmount,coupon_code:n.ProductAction.CouponCode,products:ci(n.ProductAction.ProductList)}}function ci(n){var r,i,u,t,f;if(!n||!n.length)return null;for(r=[],i=0,u=n;i<u.length;i++)t=u[i],f={id:t.Sku,name:t.Name,brand:t.Brand,category:t.Category,variant:t.Variant,total_product_amount:t.TotalAmount,position:t.Position,price:t.Price,quantity:t.Quantity,coupon_code:t.CouponCode,custom_attributes:t.Attributes},r.push(f);return r}function rf(n){if(!n.PromotionAction)return null;return{action:n.PromotionAction.PromotionActionType,promotions:uf(n.PromotionAction.PromotionList)}}function uf(n){var r,i,u,t,f;if(!n||!n.length)return null;for(r=[],i=0,u=n;i<u.length;i++)t=u[i],f={id:t.Id,name:t.Name,creative:t.Creative,position:t.Position},r.push(f);return r}function ff(n){var i,t,r,u,f;if(!n.ProductImpressions)return null;for(i=[],t=0,r=n.ProductImpressions;t<r.length;t++)u=r[t],f={product_impression_list:u.ProductImpressionList,products:ci(u.ProductList)},i.push(f);return i}function ef(n){if(!n.ShoppingCart||!n.ShoppingCart.ProductList||!n.ShoppingCart.ProductList.length)return null;return{products:ci(n.ShoppingCart.ProductList)}}function sf(n){var r=d(n),t={custom_flags:n.CustomFlags,product_action:tf(n),promotion_action:rf(n),product_impressions:ff(n),shopping_cart:ef(n),currency_code:n.CurrencyCode};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.commerceEvent,data:t}}function hf(n){var r=d(n),t={message:n.EventName};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.crashReport,data:t}}function cf(n){var r=d(n),t={application_transition_type:i.ApplicationStateTransitionEventDataApplicationTransitionTypeEnum.applicationInitialized,is_first_run:n.IsFirstRun,is_upgrade:!1,launch_referral:n.LaunchReferral};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.applicationStateTransition,data:t}}function lf(n){var r=d(n),t={session_duration_ms:n.SessionLength};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.sessionEnd,data:t}}function af(n){var r=d(n),t={};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.sessionStart,data:t}}function vf(n){var r=d(n),t={custom_flags:n.CustomFlags,screen_name:n.EventName};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.screenView,data:t}}function yf(n){var r=d(n),t={is_opted_out:n.OptOut};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.optOut,data:t}}function pf(n){var r=d(n),t={custom_event_type:wf(n.EventCategory),custom_flags:n.CustomFlags,event_name:n.EventName};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.customEvent,data:t}}function wf(t){switch(t){case n.EventType.Other:return i.CustomEventDataCustomEventTypeEnum.other;case n.EventType.Location:return i.CustomEventDataCustomEventTypeEnum.location;case n.EventType.Navigation:return i.CustomEventDataCustomEventTypeEnum.navigation;case n.EventType.Search:return i.CustomEventDataCustomEventTypeEnum.search;case n.EventType.Social:return i.CustomEventDataCustomEventTypeEnum.social;case n.EventType.Transaction:return i.CustomEventDataCustomEventTypeEnum.transaction;case n.EventType.UserContent:return i.CustomEventDataCustomEventTypeEnum.userContent;case n.EventType.UserPreference:return i.CustomEventDataCustomEventTypeEnum.userPreference;case n.EventType.Media:return i.CustomEventDataCustomEventTypeEnum.media;case n.CommerceEventType.ProductAddToCart:return i.CommerceEventDataCustomEventTypeEnum.addToCart;case n.CommerceEventType.ProductAddToWishlist:return i.CommerceEventDataCustomEventTypeEnum.addToWishlist;case n.CommerceEventType.ProductCheckout:return i.CommerceEventDataCustomEventTypeEnum.checkout;case n.CommerceEventType.ProductCheckoutOption:return i.CommerceEventDataCustomEventTypeEnum.checkoutOption;case n.CommerceEventType.ProductClick:return i.CommerceEventDataCustomEventTypeEnum.click;case n.CommerceEventType.ProductImpression:return i.CommerceEventDataCustomEventTypeEnum.impression;case n.CommerceEventType.ProductPurchase:return i.CommerceEventDataCustomEventTypeEnum.purchase;case n.CommerceEventType.ProductRefund:return i.CommerceEventDataCustomEventTypeEnum.refund;case n.CommerceEventType.ProductRemoveFromCart:return i.CommerceEventDataCustomEventTypeEnum.removeFromCart;case n.CommerceEventType.ProductRemoveFromWishlist:return i.CommerceEventDataCustomEventTypeEnum.removeFromWishlist;case n.CommerceEventType.ProductViewDetail:return i.CommerceEventDataCustomEventTypeEnum.viewDetail;case n.CommerceEventType.PromotionClick:return i.CommerceEventDataCustomEventTypeEnum.promotionClick;case n.CommerceEventType.PromotionView:return i.CommerceEventDataCustomEventTypeEnum.promotionView;default:return i.CustomEventDataCustomEventTypeEnum.unknown}}function d(n){return{timestamp_unixtime_ms:n.Timestamp,session_uuid:n.SessionId,session_start_unixtime_ms:n.SessionStartDate,custom_attributes:n.EventAttributes,location:bf(n.Location),source_message_id:n.SourceMessageId}}function bf(n){return n&&Object.keys(n).length?{latitude:n.lat,longitude:n.lng}:null}function kf(n){var r=d(n),t={user_attribute_name:n.UserAttributeChanges.UserAttributeName,"new":n.UserAttributeChanges.New,old:n.UserAttributeChanges.Old,deleted:n.UserAttributeChanges.Deleted,is_new_attribute:n.UserAttributeChanges.IsNewAttribute};return t=tt(tt({},t),r),{event_type:i.EventTypeEnum.userAttributeChange,data:t}}function df(n){var r=d(n),t={"new":{identity_type:gi(n.UserIdentityChanges.New.IdentityType),identity:n.UserIdentityChanges.New.Identity||null,timestamp_unixtime_ms:n.Timestamp,created_this_batch:n.UserIdentityChanges.New.CreatedThisBatch},old:{identity_type:gi(n.UserIdentityChanges.Old.IdentityType),identity:n.UserIdentityChanges.Old.Identity||null,timestamp_unixtime_ms:n.Timestamp,created_this_batch:n.UserIdentityChanges.Old.CreatedThisBatch}};return t=Object.assign(t,r),{event_type:i.EventTypeEnum.userIdentityChange,data:t}}function gi(n){switch(n){case o.other:return i.IdentityTypeEnum.other;case o.customerId:return i.IdentityTypeEnum.customerId;case o.facebook:return i.IdentityTypeEnum.facebook;case o.twitter:return i.IdentityTypeEnum.twitter;case o.google:return i.IdentityTypeEnum.google;case o.microsoft:return i.IdentityTypeEnum.microsoft;case o.yahoo:return i.IdentityTypeEnum.yahoo;case o.email:return i.IdentityTypeEnum.email;case o.alias:return i.IdentityTypeEnum.alias;case o.facebookCustomAudienceId:return i.IdentityTypeEnum.facebookCustomAudienceId;case o.otherId2:return i.IdentityTypeEnum.otherId2;case o.otherId3:return i.IdentityTypeEnum.otherId3;case o.otherId4:return i.IdentityTypeEnum.otherId4;case o.otherId5:return i.IdentityTypeEnum.otherId5;case o.otherId6:return i.IdentityTypeEnum.otherId6;case o.otherId7:return i.IdentityTypeEnum.otherId7;case o.otherId8:return i.IdentityTypeEnum.otherId8;case o.otherId9:return i.IdentityTypeEnum.otherId9;case o.otherId10:return i.IdentityTypeEnum.otherId10;case o.mobileNumber:return i.IdentityTypeEnum.mobileNumber;case o.phoneNumber2:return i.IdentityTypeEnum.phoneNumber2;case o.phoneNumber3:return i.IdentityTypeEnum.phoneNumber3}}function ue(i,r){this.uploader=null;var u=this;this.queueEventForBatchUpload=function(n){if(!this.uploader){var r=i._Helpers.getFeatureFlag(t.FeatureFlags.EventBatchingIntervalMillis);this.uploader=new te(i,r)}this.uploader.queueEvent(n);i._Persistence.update()};this.processQueuedEvents=function(){var r,n=i.Identity.getCurrentUser(),t;n&&(r=n.getMPID());i._Store.eventQueue.length&&r&&(t=i._Store.eventQueue,i._Store.eventQueue=[],this.appendUserInfoToEvents(n,t),t.forEach(function(n){u.sendEventToServer(n)}))};this.appendUserInfoToEvents=function(n,t){t.forEach(function(t){t.MPID||i._ServerModel.appendUserInfo(n,t)})};this.sendEventToServer=function(u,f){var s=i._Helpers.extend({shouldUploadEvent:!0},f),o,e;if(i._Store.webviewBridgeEnabled){i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.LogEvent,JSON.stringify(u));return}if(e=i.Identity.getCurrentUser(),e&&(o=e.getMPID()),i._Store.requireDelay=i._Helpers.isDelayedByIntegration(i._preInit.integrationDelays,i._Store.integrationDelayTimeoutStart,Date.now()),!o||i._Store.requireDelay||!i._Store.configurationLoaded){i.Logger.verbose("Event was added to eventQueue. eventQueue will be processed once a valid MPID is returned or there is no more integration imposed delay.");i._Store.eventQueue.push(u);return}(this.processQueuedEvents(),y(u))||(s.shouldUploadEvent&&this.queueEventForBatchUpload(u),u.EventName!==n.MessageType.AppStateTransition&&(r&&r.kitBlockingEnabled&&(u=r.createBlockedEvent(u)),u&&i._Forwarders.sendEventToForwarders(u)))};this.sendBatchForwardingStatsToServer=function(n,t){var r,u;try{r=i._Helpers.createServiceUrl(i._Store.SDKConfig.v2SecureServiceUrl,i._Store.devToken);u={uuid:i._Helpers.generateUniqueId(),data:n};t&&(t.open("post",r+"/Forwarding"),t.send(JSON.stringify(u)))}catch(f){i.Logger.error("Error sending forwarding stats to mParticle servers.")}};this.sendSingleForwardingStatsToServer=function(n){var r,u,f,t;try{f=function(){t.readyState===4&&t.status===202&&i.Logger.verbose("Successfully sent  "+t.statusText+" from server")};t=i._Helpers.createXHR(f);r=i._Helpers.createServiceUrl(i._Store.SDKConfig.v1SecureServiceUrl,i._Store.devToken);u=n;t&&(t.open("post",r+"/Forwarding"),t.send(JSON.stringify(u)))}catch(e){i.Logger.error("Error sending forwarding stats to mParticle servers.")}};this.prepareForwardingStats=function(n,r){var f,e=i._Forwarders.getForwarderStatsQueue();n&&n.isVisible&&(f={mid:n.id,esid:n.eventSubscriptionId,n:r.EventName,attrs:r.EventAttributes,sdk:r.SDKVersion,dt:r.EventDataType,et:r.EventCategory,dbg:r.Debug,ct:r.Timestamp,eec:r.ExpandedEventCount,dp:r.DataPlan},i._Helpers.getFeatureFlag(t.FeatureFlags.ReportBatching)?(e.push(f),i._Forwarders.setForwarderStatsQueue(e)):u.sendSingleForwardingStatsToServer(f))}}function fe(t){var i=this;this.canLog=function(){return t._Store.isEnabled&&(t._Store.devToken||t._Store.webviewBridgeEnabled)?!0:!1};this.getFeatureFlag=function(n){return t._Store.SDKConfig.flags.hasOwnProperty(n)?t._Store.SDKConfig.flags[n]:null};this.invokeCallback=function(n,r,u,f,e){n||t.Logger.warning("There is no callback provided");try{i.Validators.isFunction(n)&&n({httpCode:r,body:u,getUser:function(){return f?f:t.Identity.getCurrentUser()},getPreviousUser:function(){if(e)return t.Identity.getUser(e);var i=t.Identity.getUsers(),n=i.shift(),r=f||t.Identity.getCurrentUser();return n&&r&&n.getMPID()===r.getMPID()&&(n=i.shift()),n||null}})}catch(o){t.Logger.error("There was an error with your callback: "+o)}};this.invokeAliasCallback=function(n,r,u){n||t.Logger.warning("There is no callback provided");try{if(i.Validators.isFunction(n)){var f={httpCode:r};u&&(f.message=u);n(f)}}catch(e){t.Logger.error("There was an error with your callback: "+e)}};this.extend=function(){var o,e,u,r,s,h,t=arguments[0]||{},f=1,l=arguments.length,c=!1,n={hasOwn:Object.prototype.hasOwnProperty,class2type:{},type:function(t){return t==null?String(t):n.class2type[Object.prototype.toString.call(t)]||"object"},isPlainObject:function(t){if(!t||n.type(t)!=="object"||t.nodeType||n.isWindow(t))return!1;try{if(t.constructor&&!n.hasOwn.call(t,"constructor")&&!n.hasOwn.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(var i in t);return i===undefined||n.hasOwn.call(t,i)},isArray:Array.isArray||function(t){return n.type(t)==="array"},isFunction:function(t){return n.type(t)==="function"},isWindow:function(n){return n!=null&&n==n.window}};for(typeof t=="boolean"&&(c=t,t=arguments[1]||{},f=2),a(t)==="object"||n.isFunction(t)||(t={}),l===f&&(t=this,--f);f<l;f++)if((o=arguments[f])!=null)for(e in o)(u=t[e],r=o[e],t!==r)&&(c&&r&&(n.isPlainObject(r)||(s=n.isArray(r)))?(s?(s=!1,h=u&&n.isArray(u)?u:[]):h=u&&n.isPlainObject(u)?u:{},t[e]=i.extend(c,h,r)):r!==undefined&&(t[e]=r));return t};this.createServiceUrl=function(n,i){var u=window.mParticle&&t._Store.SDKConfig.forceHttps?"https://":window.location.protocol+"//",r;return r=t._Store.SDKConfig.forceHttps?"https://"+n:u+n,i&&(r=r+i),r};this.createXHR=function(n){var i;try{i=new window.XMLHttpRequest}catch(r){t.Logger.error("Error creating XMLHttpRequest object.")}if(i&&n&&"withCredentials"in i)i.onreadystatechange=n;else if(typeof XDomainRequest!="undefined"){t.Logger.verbose("Creating XDomainRequest object");try{i=new window.XDomainRequest;i.onload=n}catch(r){t.Logger.error("Error creating XDomainRequest object")}}return i};this.filterUserIdentities=function(t,r){var e=[],u,f,o;if(t&&Object.keys(t).length)for(u in t)t.hasOwnProperty(u)&&(f=n.IdentityType.getIdentityType(u),i.inArray(r,f)||(o={Type:f,Identity:t[u]},f===n.IdentityType.CustomerId?e.unshift(o):e.push(o)));return e};this.filterUserIdentitiesForForwarders=function(t,r){var f={},u,e;if(t&&Object.keys(t).length)for(u in t)t.hasOwnProperty(u)&&(e=h.hashUserIdentity(n.IdentityType.getIdentityType(u)),i.inArray(r,e)||(f[u]=t[u]));return f};this.filterUserAttributes=function(n,t){var u={},r,f;if(n&&Object.keys(n).length)for(r in n)n.hasOwnProperty(r)&&(f=h.hashUserAttribute(r),i.inArray(t,f)||(u[r]=n[r]));return u};this.isFilteredUserAttribute=function(n,t){var r=h.hashUserAttribute(n);return t&&i.inArray(t,r)};this.isEventType=function(t){for(var i in n.EventType)if(n.EventType.hasOwnProperty(i)&&n.EventType[i]===t)return!0;return!1};this.sanitizeAttributes=function(n,r){var f,u;if(!n||!i.isObject(n))return null;f={};for(u in n)n.hasOwnProperty(u)&&i.Validators.isValidAttributeValue(n[u])?f[u]=n[u]:t.Logger.warning("For '"+r+"', the corresponding attribute value of '"+u+"' must be a string, number, boolean, or null.");return f};this.isDelayedByIntegration=function(n,i,r){if(r-i>t._Store.SDKConfig.integrationDelayTimeout)return!1;for(var u in n){if(n[u]===!0)return!0;continue}return!1};this.createMainStorageName=function(n){return n?ii.currentStorageName+"_"+n:ii.currentStorageName};this.createProductStorageName=function(n){return n?ii.currentStorageProductsName+"_"+n:ii.currentStorageProductsName};this.converted=yu;this.findKeyInObject=fu;this.parseNumber=pt;this.inArray=uu;this.isObject=k;this.decoded=vu;this.returnConvertedBoolean=au;this.parseStringOrNumber=et;this.generateHash=ut;this.generateUniqueId=wi;this.Validators=ir}function ee(n){var t=this;this.isBridgeV2Available=function(n){if(!n)return!1;var i=rr+"_"+n+"_v2",t=li+"_"+n+"_v2";return window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.hasOwnProperty(t)?!0:window.mParticle&&window.mParticle.uiwebviewBridgeName&&window.mParticle.uiwebviewBridgeName===t?!0:window.hasOwnProperty(i)?!0:!1};this.isWebviewEnabled=function(i,r){return(n._Store.bridgeV2Available=t.isBridgeV2Available(i),n._Store.bridgeV1Available=t.isBridgeV1Available(),r===2)?n._Store.bridgeV2Available:window.mParticle&&window.mParticle.uiwebviewBridgeName&&window.mParticle.uiwebviewBridgeName!==li+"_"+i+"_v2"?!1:r<2?n._Store.bridgeV2Available||n._Store.bridgeV1Available:!1};this.isBridgeV1Available=function(){return n._Store.SDKConfig.useNativeSdk||window.mParticleAndroid||n._Store.SDKConfig.isIOS?!0:!1};this.sendToNative=function(i,r){if(n._Store.bridgeV2Available&&n._Store.SDKConfig.minWebviewBridgeVersion===2){t.sendViaBridgeV2(i,r,n._Store.SDKConfig.requiredWebviewBridgeName);return}if(n._Store.bridgeV2Available&&n._Store.SDKConfig.minWebviewBridgeVersion<2){t.sendViaBridgeV2(i,r,n._Store.SDKConfig.requiredWebviewBridgeName);return}if(n._Store.bridgeV1Available&&n._Store.SDKConfig.minWebviewBridgeVersion<2){t.sendViaBridgeV1(i,r);return}};this.sendViaBridgeV1=function(i,r){window.mParticleAndroid&&window.mParticleAndroid.hasOwnProperty(i)?(n.Logger.verbose(wt.InformationMessages.SendAndroid+i),window.mParticleAndroid[i](r)):n._Store.SDKConfig.isIOS&&(n.Logger.verbose(wt.InformationMessages.SendIOS+i),t.sendViaIframeToIOS(i,r))};this.sendViaIframeToIOS=function(n,t){var i=document.createElement("IFRAME");i.setAttribute("src","mp-sdk://"+n+"/"+encodeURIComponent(t));document.documentElement.appendChild(i);i.parentNode.removeChild(i)};this.sendViaBridgeV2=function(i,r,u){if(u){var h=rr+"_"+u+"_v2",e=window[h],f=li+"_"+u+"_v2",o,s;if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[f]&&(o=window.webkit.messageHandlers[f]),n.uiwebviewBridgeName===f&&(s=n[f]),e&&e.hasOwnProperty(i)){n.Logger.verbose(wt.InformationMessages.SendAndroid+i);e[i](r);return}o?(n.Logger.verbose(wt.InformationMessages.SendIOS+i),o.postMessage(JSON.stringify({path:i,value:r?JSON.parse(r):null}))):s&&(n.Logger.verbose(wt.InformationMessages.SendIOS+i),t.sendViaIframeToIOS(i,r))}}}function oe(n){var t=this;this.attemptCookieSync=function(i,r,u){var f,s,h,c,o,e;r&&!n._Store.webviewBridgeEnabled&&n._Store.pixelConfigurations.forEach(function(l){e=!1;l.filteringConsentRuleValues&&l.filteringConsentRuleValues.values&&l.filteringConsentRuleValues.values.length&&(e=!0);f={moduleId:l.moduleId,frequencyCap:l.frequencyCap,pixelUrl:t.replaceAmp(l.pixelUrl),redirectUrl:l.redirectUrl?t.replaceAmp(l.redirectUrl):null,filteringConsentRuleValues:l.filteringConsentRuleValues};h=t.replaceMPID(f.pixelUrl,r);c=f.redirectUrl?t.replaceMPID(f.redirectUrl,r):"";o=h+encodeURIComponent(c);var a=n._Persistence.getPersistence();if(i&&i!==r){a&&a[r]&&(a[r].csd||(a[r].csd={}),t.performCookieSync(o,f.moduleId,r,a[r].csd,f.filteringConsentRuleValues,u,e));return}a[r]&&(a[r].csd||(a[r].csd={}),s=a[r].csd[f.moduleId.toString()]?a[r].csd[f.moduleId.toString()]:null,s?(new Date).getTime()>new Date(s).getTime()+f.frequencyCap*864e5&&t.performCookieSync(o,f.moduleId,r,a[r].csd,f.filteringConsentRuleValues,u,e):t.performCookieSync(o,f.moduleId,r,a[r].csd,f.filteringConsentRuleValues,u,e))})};this.replaceMPID=function(n,t){return n.replace("%%mpid%%",t)};this.replaceAmp=function(n){return n.replace(/&amp;/g,"&")};this.performCookieSync=function(t,i,r,u,f,e,o){if((!o||!e)&&n._Consent.isEnabledForUserConsent(f,n.Identity.getCurrentUser())){var s=document.createElement("img");n.Logger.verbose(ur.InformationMessages.CookieSync);s.onload=function(){u[i.toString()]=(new Date).getTime();n._Persistence.saveUserCookieSyncDatesToPersistence(r,u)};s.src=t}}}function se(t){var i=this;this.initialize=function(){var r,n;t._Store.sessionId?(r=t._Store.SDKConfig.sessionTimeout*6e4,new Date>new Date(t._Store.dateLastEventSent.getTime()+r)?(i.endSession(),i.startNewSession()):(n=t._Persistence.getPersistence(),n&&!n.cu&&(t.Identity.identify(t._Store.SDKConfig.identifyRequest,t._Store.SDKConfig.identityCallback),t._Store.identifyCalled=!0,t._Store.SDKConfig.identityCallback=null))):i.startNewSession()};this.getSession=function(){return t._Store.sessionId};this.startNewSession=function(){var r,u,f;t.Logger.verbose(st.InformationMessages.StartingNewSession);t._Helpers.canLog()?(t._Store.sessionId=t._Helpers.generateUniqueId().toUpperCase(),r=t.Identity.getCurrentUser(),u=r?r.getMPID():null,u&&(t._Store.currentSessionMPIDs=[u]),t._Store.sessionStartDate||(f=new Date,t._Store.sessionStartDate=f,t._Store.dateLastEventSent=f),i.setSessionTimer(),t._Store.identifyCalled||(t.Identity.identify(t._Store.SDKConfig.identifyRequest,t._Store.SDKConfig.identityCallback),t._Store.identifyCalled=!0,t._Store.SDKConfig.identityCallback=null),t._Events.logEvent({messageType:n.MessageType.SessionStart})):t.Logger.verbose(st.InformationMessages.AbandonStartSession)};this.endSession=function(r){var f,u,e,o;if(t.Logger.verbose(st.InformationMessages.StartingEndSession),r)t._Events.logEvent({messageType:n.MessageType.SessionEnd}),t._Store.sessionId=null,t._Store.dateLastEventSent=null,t._Store.sessionAttributes={},t._Persistence.update();else if(t._Helpers.canLog()){if(u=t._Persistence.getPersistence(),!u)return;if(u.gs&&!u.gs.sid){t.Logger.verbose(st.InformationMessages.NoSessionToEnd);return}u.gs.sid&&t._Store.sessionId!==u.gs.sid&&(t._Store.sessionId=u.gs.sid);u.gs&&u.gs.les&&(f=t._Store.SDKConfig.sessionTimeout*6e4,o=(new Date).getTime(),e=o-u.gs.les,e<f?i.setSessionTimer():(t._Events.logEvent({messageType:n.MessageType.SessionEnd}),t._Store.sessionId=null,t._Store.dateLastEventSent=null,t._Store.sessionStartDate=null,t._Store.sessionAttributes={},t._Persistence.update()))}else t.Logger.verbose(st.InformationMessages.AbandonEndSession)};this.setSessionTimer=function(){var n=t._Store.SDKConfig.sessionTimeout*6e4;t._Store.globalTimer=window.setTimeout(function(){i.endSession()},n)};this.resetSessionTimer=function(){t._Store.webviewBridgeEnabled||(t._Store.sessionId||i.startNewSession(),i.clearSessionTimeout(),i.setSessionTimer());i.startNewSessionIfNeeded()};this.clearSessionTimeout=function(){clearTimeout(t._Store.globalTimer)};this.startNewSessionIfNeeded=function(){if(!t._Store.webviewBridgeEnabled){var n=t._Persistence.getPersistence();!t._Store.sessionId&&n&&(n.sid?t._Store.sessionId=n.sid:i.startNewSession())}}}function he(t){var i=this;this.convertTransactionAttributesToProductAction=function(n,t){n.hasOwnProperty("Id")&&(t.TransactionId=n.Id);n.hasOwnProperty("Affiliation")&&(t.Affiliation=n.Affiliation);n.hasOwnProperty("CouponCode")&&(t.CouponCode=n.CouponCode);n.hasOwnProperty("Revenue")&&(t.TotalAmount=this.sanitizeAmount(n.Revenue,"Revenue"));n.hasOwnProperty("Shipping")&&(t.ShippingAmount=this.sanitizeAmount(n.Shipping,"Shipping"));n.hasOwnProperty("Tax")&&(t.TaxAmount=this.sanitizeAmount(n.Tax,"Tax"));n.hasOwnProperty("Step")&&(t.CheckoutStep=n.Step);n.hasOwnProperty("Option")&&(t.CheckoutOptions=n.Option)};this.getProductActionEventName=function(t){switch(t){case n.ProductActionType.AddToCart:return"AddToCart";case n.ProductActionType.AddToWishlist:return"AddToWishlist";case n.ProductActionType.Checkout:return"Checkout";case n.ProductActionType.CheckoutOption:return"CheckoutOption";case n.ProductActionType.Click:return"Click";case n.ProductActionType.Purchase:return"Purchase";case n.ProductActionType.Refund:return"Refund";case n.ProductActionType.RemoveFromCart:return"RemoveFromCart";case n.ProductActionType.RemoveFromWishlist:return"RemoveFromWishlist";case n.ProductActionType.ViewDetail:return"ViewDetail";case n.ProductActionType.Unknown:default:return"Unknown"}};this.getPromotionActionEventName=function(t){switch(t){case n.PromotionActionType.PromotionClick:return"PromotionClick";case n.PromotionActionType.PromotionView:return"PromotionView";default:return"Unknown"}};this.convertProductActionToEventType=function(i){switch(i){case n.ProductActionType.AddToCart:return n.CommerceEventType.ProductAddToCart;case n.ProductActionType.AddToWishlist:return n.CommerceEventType.ProductAddToWishlist;case n.ProductActionType.Checkout:return n.CommerceEventType.ProductCheckout;case n.ProductActionType.CheckoutOption:return n.CommerceEventType.ProductCheckoutOption;case n.ProductActionType.Click:return n.CommerceEventType.ProductClick;case n.ProductActionType.Purchase:return n.CommerceEventType.ProductPurchase;case n.ProductActionType.Refund:return n.CommerceEventType.ProductRefund;case n.ProductActionType.RemoveFromCart:return n.CommerceEventType.ProductRemoveFromCart;case n.ProductActionType.RemoveFromWishlist:return n.CommerceEventType.ProductRemoveFromWishlist;case n.ProductActionType.Unknown:return n.EventType.Unknown;case n.ProductActionType.ViewDetail:return n.CommerceEventType.ProductViewDetail;default:return t.Logger.error("Could not convert product action type "+i+" to event type"),null}};this.convertPromotionActionToEventType=function(i){switch(i){case n.PromotionActionType.PromotionClick:return n.CommerceEventType.PromotionClick;case n.PromotionActionType.PromotionView:return n.CommerceEventType.PromotionView;default:return t.Logger.error("Could not convert promotion action type "+i+" to event type"),null}};this.generateExpandedEcommerceName=function(n,t){return"eCommerce - "+n+" - "+(t?"Total":"Item")};this.extractProductAttributes=function(n,t){t.CouponCode&&(n["Coupon Code"]=t.CouponCode);t.Brand&&(n.Brand=t.Brand);t.Category&&(n.Category=t.Category);t.Name&&(n.Name=t.Name);t.Sku&&(n.Id=t.Sku);t.Price&&(n["Item Price"]=t.Price);t.Quantity&&(n.Quantity=t.Quantity);t.Position&&(n.Position=t.Position);t.Variant&&(n.Variant=t.Variant);n["Total Product Amount"]=t.TotalAmount||0};this.extractTransactionId=function(n,t){t.TransactionId&&(n["Transaction Id"]=t.TransactionId)};this.extractActionAttributes=function(n,t){i.extractTransactionId(n,t);t.Affiliation&&(n.Affiliation=t.Affiliation);t.CouponCode&&(n["Coupon Code"]=t.CouponCode);t.TotalAmount&&(n["Total Amount"]=t.TotalAmount);t.ShippingAmount&&(n["Shipping Amount"]=t.ShippingAmount);t.TaxAmount&&(n["Tax Amount"]=t.TaxAmount);t.CheckoutOptions&&(n["Checkout Options"]=t.CheckoutOptions);t.CheckoutStep&&(n["Checkout Step"]=t.CheckoutStep)};this.extractPromotionAttributes=function(n,t){t.Id&&(n.Id=t.Id);t.Creative&&(n.Creative=t.Creative);t.Name&&(n.Name=t.Name);t.Position&&(n.Position=t.Position)};this.buildProductList=function(n,t){return t?Array.isArray(t)?t:[t]:n.ShoppingCart.ProductList};this.createProduct=function(n,i,r,u,f,e,o,s,h,c){if(c=t._Helpers.sanitizeAttributes(c,n),typeof n!="string")return t.Logger.error("Name is required when creating a product"),null;if(!t._Helpers.Validators.isStringOrNumber(i))return t.Logger.error("SKU is required when creating a product, and must be a string or a number"),null;if(t._Helpers.Validators.isStringOrNumber(r))r=t._Helpers.parseNumber(r);else return t.Logger.error("Price is required when creating a product, and must be a string or a number"),null;return s&&!t._Helpers.Validators.isNumber(s)&&(t.Logger.error("Position must be a number, it will be set to null."),s=null),u=t._Helpers.Validators.isStringOrNumber(u)?t._Helpers.parseNumber(u):1,{Name:n,Sku:i,Price:r,Quantity:u,Brand:o,Variant:f,Category:e,Position:s,CouponCode:h,TotalAmount:u*r,Attributes:c}};this.createPromotion=function(n,i,r,u){return t._Helpers.Validators.isStringOrNumber(n)?{Id:n,Creative:i,Name:r,Position:u}:(t.Logger.error(bt.ErrorMessages.PromotionIdRequired),null)};this.createImpression=function(n,i){return typeof n!="string"?(t.Logger.error("Name is required when creating an impression."),null):i?{Name:n,Product:i}:(t.Logger.error("Product is required when creating an impression."),null)};this.createTransactionAttributes=function(n,i,r,u,f,e){return t._Helpers.Validators.isStringOrNumber(n)?{Id:n,Affiliation:i,CouponCode:r,Revenue:u,Shipping:f,Tax:e}:(t.Logger.error(bt.ErrorMessages.TransactionIdRequired),null)};this.expandProductImpression=function(r){var u=[];return r.ProductImpressions?(r.ProductImpressions.forEach(function(f){f.ProductList&&f.ProductList.forEach(function(e){var o=t._Helpers.extend(!1,{},r.EventAttributes),s,h;if(e.Attributes)for(s in e.Attributes)o[s]=e.Attributes[s];i.extractProductAttributes(o,e);f.ProductImpressionList&&(o["Product Impression List"]=f.ProductImpressionList);h=t._ServerModel.createEventObject({messageType:n.MessageType.PageEvent,name:i.generateExpandedEcommerceName("Impression"),data:o,eventType:n.EventType.Transaction});u.push(h)})}),u):u};this.expandCommerceEvent=function(n){return n?i.expandProductAction(n).concat(i.expandPromotionAction(n)).concat(i.expandProductImpression(n)):null};this.expandPromotionAction=function(r){var u=[],f;return r.PromotionAction?(f=r.PromotionAction.PromotionList,f.forEach(function(f){var e=t._Helpers.extend(!1,{},r.EventAttributes),o;i.extractPromotionAttributes(e,f);o=t._ServerModel.createEventObject({messageType:n.MessageType.PageEvent,name:i.generateExpandedEcommerceName(n.PromotionActionType.getExpansionName(r.PromotionAction.PromotionActionType)),data:e,eventType:n.EventType.Transaction});u.push(o)}),u):u};this.expandProductAction=function(r){var u=[],e,f,s,o;return r.ProductAction?(e=!1,r.ProductAction.ProductActionType===n.ProductActionType.Purchase||r.ProductAction.ProductActionType===n.ProductActionType.Refund?(f=t._Helpers.extend(!1,{},r.EventAttributes),f["Product Count"]=r.ProductAction.ProductList?r.ProductAction.ProductList.length:0,i.extractActionAttributes(f,r.ProductAction),r.CurrencyCode&&(f["Currency Code"]=r.CurrencyCode),s=t._ServerModel.createEventObject({messageType:n.MessageType.PageEvent,name:i.generateExpandedEcommerceName(n.ProductActionType.getExpansionName(r.ProductAction.ProductActionType),!0),data:f,eventType:n.EventType.Transaction}),u.push(s)):e=!0,o=r.ProductAction.ProductList,!o)?u:(o.forEach(function(f){var o=t._Helpers.extend(!1,r.EventAttributes,f.Attributes),s;e?i.extractActionAttributes(o,r.ProductAction):i.extractTransactionId(o,r.ProductAction);i.extractProductAttributes(o,f);s=t._ServerModel.createEventObject({messageType:n.MessageType.PageEvent,name:i.generateExpandedEcommerceName(n.ProductActionType.getExpansionName(r.ProductAction.ProductActionType)),data:o,eventType:n.EventType.Transaction});u.push(s)}),u):u};this.createCommerceEventObject=function(i){var r;return(t.Logger.verbose(bt.InformationMessages.StartingLogCommerceEvent),t._Helpers.canLog())?(r=t._ServerModel.createEventObject({messageType:n.MessageType.Commerce}),r.EventName="eCommerce - ",r.CurrencyCode=t._Store.currencyCode,r.ShoppingCart=[],r.CustomFlags=i,r):(t.Logger.verbose(bt.InformationMessages.AbandonLogEvent),null)};this.sanitizeAmount=function(n,i){if(!t._Helpers.Validators.isStringOrNumber(n)){var r=[i,"must be of type number. A",a(n),"was passed. Converting to 0"].join(" ");return t.Logger.warning(r),0}return t._Helpers.parseNumber(n)}}function ce(n){var r={};for(var i in t.DefaultConfig)t.DefaultConfig.hasOwnProperty(i)&&(r[i]=t.DefaultConfig[i]);if(n)for(i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);for(i in t.DefaultUrls)r[i]=t.DefaultUrls[i];return r}function fr(n,i){var o={isEnabled:!0,sessionAttributes:{},currentSessionMPIDs:[],consentState:null,sessionId:null,isFirstRun:null,clientId:null,deviceId:null,devToken:null,serverSettings:{},dateLastEventSent:null,sessionStartDate:null,currentPosition:null,isTracking:!1,watchPositionId:null,cartProducts:[],eventQueue:[],currencyCode:null,globalTimer:null,context:null,configurationLoaded:!1,identityCallInFlight:!1,SDKConfig:{},nonCurrentUserMPIDs:{},identifyCalled:!1,isLoggedIn:!1,cookieSyncDates:{},integrationAttributes:{},requireDelay:!0,isLocalStorageAvailable:null,storageName:null,prodStorageName:null,activeForwarders:[],kits:{},sideloadedKits:[],configuredForwarders:[],pixelConfigurations:[],wrapperSDKInfo:{name:"none",version:null,isInfoSet:!1}},f,e,r,u;for(f in o)this[f]=o[f];this.integrationDelayTimeoutStart=Date.now();this.SDKConfig=ce(n);n&&(n.deviceId&&(this.deviceId=n.deviceId),this.SDKConfig.isDevelopmentMode=n.hasOwnProperty("isDevelopmentMode")?i._Helpers.returnConvertedBoolean(n.isDevelopmentMode):!1,n.hasOwnProperty("v1SecureServiceUrl")&&(this.SDKConfig.v1SecureServiceUrl=n.v1SecureServiceUrl),n.hasOwnProperty("v2SecureServiceUrl")&&(this.SDKConfig.v2SecureServiceUrl=n.v2SecureServiceUrl),n.hasOwnProperty("v3SecureServiceUrl")&&(this.SDKConfig.v3SecureServiceUrl=n.v3SecureServiceUrl),n.hasOwnProperty("identityUrl")&&(this.SDKConfig.identityUrl=n.identityUrl),n.hasOwnProperty("aliasUrl")&&(this.SDKConfig.aliasUrl=n.aliasUrl),n.hasOwnProperty("configUrl")&&(this.SDKConfig.configUrl=n.configUrl),n.hasOwnProperty("logLevel")&&(this.SDKConfig.logLevel=n.logLevel),this.SDKConfig.useNativeSdk=!!n.useNativeSdk,this.SDKConfig.kits=n.kits||{},this.SDKConfig.sideloadedKits=n.sideloadedKits||[],this.SDKConfig.isIOS=n.hasOwnProperty("isIOS")?n.isIOS:window.mParticle&&window.mParticle.isIOS?window.mParticle.isIOS:!1,this.SDKConfig.useCookieStorage=n.hasOwnProperty("useCookieStorage")?n.useCookieStorage:!1,this.SDKConfig.maxProducts=n.hasOwnProperty("maxProducts")?n.maxProducts:t.DefaultConfig.maxProducts,this.SDKConfig.maxCookieSize=n.hasOwnProperty("maxCookieSize")?n.maxCookieSize:t.DefaultConfig.maxCookieSize,n.hasOwnProperty("appName")&&(this.SDKConfig.appName=n.appName),n.hasOwnProperty("package")&&(this.SDKConfig.package=n.package),this.SDKConfig.integrationDelayTimeout=n.hasOwnProperty("integrationDelayTimeout")?n.integrationDelayTimeout:t.DefaultConfig.integrationDelayTimeout,n.hasOwnProperty("identifyRequest")&&(this.SDKConfig.identifyRequest=n.identifyRequest),n.hasOwnProperty("identityCallback")&&(e=n.identityCallback,i._Helpers.Validators.isFunction(e)?this.SDKConfig.identityCallback=n.identityCallback:i.Logger.warning("The optional callback must be a function. You tried entering a(n) "+a(e)+" . Callback not set. Please set your callback again.")),n.hasOwnProperty("appVersion")&&(this.SDKConfig.appVersion=n.appVersion),n.hasOwnProperty("appName")&&(this.SDKConfig.appName=n.appName),n.hasOwnProperty("sessionTimeout")&&(this.SDKConfig.sessionTimeout=n.sessionTimeout),n.hasOwnProperty("dataPlan")?(this.SDKConfig.dataPlan={PlanVersion:null,PlanId:null},r=n.dataPlan,r.planId&&(wu(r.planId)?this.SDKConfig.dataPlan.PlanId=r.planId:i.Logger.error("Your data plan id must be a string and match the data plan slug format (i.e. under_case_slug)")),r.planVersion&&(si(r.planVersion)?this.SDKConfig.dataPlan.PlanVersion=r.planVersion:i.Logger.error("Your data plan version must be a number"))):this.SDKConfig.dataPlan={},this.SDKConfig.forceHttps=n.hasOwnProperty("forceHttps")?n.forceHttps:!0,this.SDKConfig.customFlags=n.customFlags||{},this.SDKConfig.minWebviewBridgeVersion=n.hasOwnProperty("minWebviewBridgeVersion")?n.minWebviewBridgeVersion:1,this.SDKConfig.aliasMaxWindow=n.hasOwnProperty("aliasMaxWindow")?n.aliasMaxWindow:t.DefaultConfig.aliasMaxWindow,n.hasOwnProperty("dataPlanOptions")&&(u=n.dataPlanOptions,u.hasOwnProperty("dataPlanVersion")&&u.hasOwnProperty("blockUserAttributes")&&u.hasOwnProperty("blockEventAttributes")&&u.hasOwnProperty("blockEvents")&&u.hasOwnProperty("blockUserIdentities")||i.Logger.error('Ensure your config.dataPlanOptions object has the following keys: a "dataPlanVersion" object, and "blockUserAttributes", "blockEventAttributes", "blockEvents", "blockUserIdentities" booleans')),n.hasOwnProperty("onCreateBatch")&&(typeof n.onCreateBatch=="function"?this.SDKConfig.onCreateBatch=n.onCreateBatch:(i.Logger.error("config.onCreateBatch must be a function"),this.SDKConfig.onCreateBatch=undefined)),n.hasOwnProperty("flags")||(this.SDKConfig.flags={}),this.SDKConfig.flags.hasOwnProperty(t.FeatureFlags.EventBatchingIntervalMillis)||(this.SDKConfig.flags[t.FeatureFlags.EventBatchingIntervalMillis]=t.DefaultConfig.uploadInterval),this.SDKConfig.flags.hasOwnProperty(t.FeatureFlags.ReportBatching)||(this.SDKConfig.flags[t.FeatureFlags.ReportBatching]=!1),this.SDKConfig.flags.hasOwnProperty(t.FeatureFlags.OfflineStorage)||(this.SDKConfig.flags[t.FeatureFlags.OfflineStorage]=0))}function le(n){var i=this,t=n.logLevel||"warning";this.logger=n.hasOwnProperty("logger")?n.logger:new ae;this.verbose=function(n){t!=="none"&&i.logger.verbose&&t==="verbose"&&i.logger.verbose(n)};this.warning=function(n){t!=="none"&&i.logger.warning&&(t==="verbose"||t==="warning")&&i.logger.warning(n)};this.error=function(n){t!=="none"&&i.logger.error&&i.logger.error(n)};this.setLogLevel=function(n){t=n}}function ae(){this.verbose=function(n){console&&console.info&&console.info(n)};this.error=function(n){console&&console.error&&console.error(n)};this.warning=function(n){console&&console.warn&&console.warn(n)}}function ve(n){function u(t){var i=n._Store;return t.gs.sid=i.sessionId,t.gs.ie=i.isEnabled,t.gs.sa=i.sessionAttributes,t.gs.ss=i.serverSettings,t.gs.dt=i.devToken,t.gs.les=i.dateLastEventSent?i.dateLastEventSent.getTime():null,t.gs.av=i.SDKConfig.appVersion,t.gs.cgid=i.clientId,t.gs.das=i.deviceId,t.gs.c=i.context,t.gs.ssd=i.sessionStartDate?i.sessionStartDate.getTime():0,t.gs.ia=i.integrationAttributes,t}function i(n){localStorage.removeItem(n)}function r(n,i,r){return t.encodePersistence(JSON.stringify(n))+";expires="+i+";path=/"+r}var t=this;this.useLocalStorage=function(){return!n._Store.SDKConfig.useCookieStorage&&n._Store.isLocalStorageAvailable};this.initializeStorage=function(){var o,r,i,u,e,s,f;try{r=t.getLocalStorage();i=t.getCookie();r||i?n._Store.isFirstRun=!1:(n._Store.isFirstRun=!0,n._Store.mpid=0);n._Store.isLocalStorageAvailable||(n._Store.SDKConfig.useCookieStorage=!0);n._Store.isLocalStorageAvailable?(o=window.localStorage,n._Store.SDKConfig.useCookieStorage?(r?(u=i?n._Helpers.extend(!1,r,i):r,o.removeItem(n._Store.storageName)):i&&(u=i),t.storeDataInMemory(u)):i?(u=r?n._Helpers.extend(!1,r,i):i,t.storeDataInMemory(u),t.expireCookies(n._Store.storageName)):t.storeDataInMemory(r)):t.storeDataInMemory(i);try{n._Store.isLocalStorageAvailable&&(e=localStorage.getItem(n._Store.prodStorageName),e&&(s=JSON.parse(g.decode(e))),n._Store.mpid&&t.storeProductsInMemory(s,n._Store.mpid))}catch(h){n._Store.isLocalStorageAvailable&&localStorage.removeItem(n._Store.prodStorageName);n._Store.cartProducts=[];n.Logger.error("Error loading products in initialization: "+h)}for(f in u)u.hasOwnProperty(f)&&(kt[f]||(n._Store.nonCurrentUserMPIDs[f]=u[f]));t.update()}catch(h){t.useLocalStorage()&&n._Store.isLocalStorageAvailable?localStorage.removeItem(n._Store.storageName):t.expireCookies(n._Store.storageName);n.Logger.error("Error initializing storage: "+h)}};this.update=function(){n._Store.webviewBridgeEnabled||(n._Store.SDKConfig.useCookieStorage&&t.setCookie(),t.setLocalStorage())};this.storeProductsInMemory=function(t,i){if(t)try{n._Store.cartProducts=t[i]&&t[i].cp?t[i].cp:[]}catch(r){n.Logger.error(ht.ErrorMessages.CookieParseError)}};this.storeDataInMemory=function(t,i){try{t?(n._Store.mpid=i?i:t.cu||0,t.gs=t.gs||{},n._Store.sessionId=t.gs.sid||n._Store.sessionId,n._Store.isEnabled=typeof t.gs.ie!="undefined"?t.gs.ie:n._Store.isEnabled,n._Store.sessionAttributes=t.gs.sa||n._Store.sessionAttributes,n._Store.serverSettings=t.gs.ss||n._Store.serverSettings,n._Store.devToken=n._Store.devToken||t.gs.dt,n._Store.SDKConfig.appVersion=n._Store.SDKConfig.appVersion||t.gs.av,n._Store.clientId=t.gs.cgid||n._Store.clientId||n._Helpers.generateUniqueId(),n._Store.deviceId=n._Store.deviceId||t.gs.das||n._Helpers.generateUniqueId(),n._Store.integrationAttributes=t.gs.ia||{},n._Store.context=t.gs.c||n._Store.context,n._Store.currentSessionMPIDs=t.gs.csm||n._Store.currentSessionMPIDs,n._Store.isLoggedIn=t.l===!0,t.gs.les&&(n._Store.dateLastEventSent=new Date(t.gs.les)),n._Store.sessionStartDate=t.gs.ssd?new Date(t.gs.ssd):new Date,t=i?t[i]:t[t.cu]):(n.Logger.verbose(ht.InformationMessages.CookieNotFound),n._Store.clientId=n._Store.clientId||n._Helpers.generateUniqueId(),n._Store.deviceId=n._Store.deviceId||n._Helpers.generateUniqueId())}catch(r){n.Logger.error(ht.ErrorMessages.CookieParseError)}};this.determineLocalStorageAvailability=function(n){var t;window.mParticle&&window.mParticle._forceNoLocalStorage&&(n=undefined);try{return n.setItem("mparticle","test"),t=n.getItem("mparticle")==="test",n.removeItem("mparticle"),t&&n}catch(i){return!1}};this.getUserProductsFromLS=function(t){if(!n._Store.isLocalStorageAvailable)return[];var r,i,u=localStorage.getItem(n._Store.prodStorageName);if(u&&(r=g.decode(u)),t)try{return r&&(i=JSON.parse(r)),r&&i[t]&&i[t].cp&&Array.isArray(i[t].cp)?i[t].cp:[]}catch(f){return[]}else return[]};this.getAllUserProductsFromLS=function(){var i,r=localStorage.getItem(n._Store.prodStorageName),t;r&&(i=g.decode(r));try{t=JSON.parse(i)}catch(u){t={}}return t};this.setLocalStorage=function(){if(n._Store.isLocalStorageAvailable){var o=n._Store.storageName,r=t.getAllUserProductsFromLS(),i=t.getLocalStorage()||{},e=n.Identity.getCurrentUser(),f=e?e.getMPID():null,s={cp:r[f]?r[f].cp:[]};if(f){r=r||{};r[f]=s;try{window.localStorage.setItem(encodeURIComponent(n._Store.prodStorageName),g.encode(JSON.stringify(r)))}catch(h){n.Logger.error("Error with setting products on localStorage.")}}if(!n._Store.SDKConfig.useCookieStorage){i.gs=i.gs||{};i.l=n._Store.isLoggedIn?1:0;n._Store.sessionId&&(i.gs.csm=n._Store.currentSessionMPIDs);i.gs.ie=n._Store.isEnabled;f&&(i.cu=f);Object.keys(n._Store.nonCurrentUserMPIDs).length&&(i=n._Helpers.extend({},i,n._Store.nonCurrentUserMPIDs),n._Store.nonCurrentUserMPIDs={});i=u(i);try{window.localStorage.setItem(encodeURIComponent(o),t.encodePersistence(JSON.stringify(i)))}catch(h){n.Logger.error("Error with setting localStorage item.")}}}};this.getLocalStorage=function(){if(!n._Store.isLocalStorageAvailable)return null;var f=n._Store.storageName,i=t.decodePersistence(window.localStorage.getItem(f)),u={},r;if(i){i=JSON.parse(i);for(r in i)i.hasOwnProperty(r)&&(u[r]=i[r])}return Object.keys(u).length?u:null};this.expireCookies=function(n){var i=new Date,u,f,r;r=t.getCookieDomain();f=r===""?"":";domain="+r;i.setTime(i.getTime()-864e5);u="; expires="+i.toUTCString();document.cookie=n+"="+u+"; path=/"+f};this.getCookie=function(){var s=window.document.cookie.split("; "),i=n._Store.storageName,r,h,e,u,o,f=i?undefined:{};for(n.Logger.verbose(ht.InformationMessages.CookieSearch),r=0,h=s.length;r<h;r++){try{e=s[r].split("=");u=e.shift();o=e.join("=")}catch(c){n.Logger.verbose("Unable to parse cookie: "+u+". Skipping.")}if(i&&i===u){f=n._Helpers.converted(o);break}i||(f[u]=n._Helpers.converted(o))}return f?(n.Logger.verbose(ht.InformationMessages.CookieFound),JSON.parse(t.decodePersistence(f))):null};this.setCookie=function(){var r,e=n.Identity.getCurrentUser();e&&(r=e.getMPID());var h=new Date,c=n._Store.storageName,i=t.getCookie()||{},l=new Date(h.getTime()+n._Store.SDKConfig.cookieExpiration*864e5).toGMTString(),f,o,s;f=t.getCookieDomain();o=f===""?"":";domain="+f;i.gs=i.gs||{};n._Store.sessionId&&(i.gs.csm=n._Store.currentSessionMPIDs);r&&(i.cu=r);i.l=n._Store.isLoggedIn?1:0;i=u(i);Object.keys(n._Store.nonCurrentUserMPIDs).length&&(i=n._Helpers.extend({},i,n._Store.nonCurrentUserMPIDs),n._Store.nonCurrentUserMPIDs={});s=t.reduceAndEncodePersistence(i,l,o,n._Store.SDKConfig.maxCookieSize);n.Logger.verbose(ht.InformationMessages.CookieSet);window.document.cookie=encodeURIComponent(c)+"="+s};this.reduceAndEncodePersistence=function(t,i,u,f){var e,c=t.gs.csm?t.gs.csm:[],o,s,h,l,a,v;if(c.length){s={};for(h in t)t.hasOwnProperty(h)&&(kt[h]||h===t.cu||(s[h]=1));if(Object.keys(s).length)for(l in s)e=r(t,i,u),e.length>f&&s.hasOwnProperty(l)&&c.indexOf(l)===-1&&delete t[l];for(a=0;a<c.length;a++)if(e=r(t,i,u),e.length>f)v=c[a],t[v]?(n.Logger.verbose("Size of new encoded cookie is larger than maxCookieSize setting of "+f+". Removing from cookie the earliest logged in MPID containing: "+JSON.stringify(t[v],0,2)),delete t[v]):n.Logger.error("Unable to save MPID data to cookies because the resulting encoded cookie is larger than the maxCookieSize setting of "+f+". We recommend using a maxCookieSize of 1500.");else break}else for(o in t)t.hasOwnProperty(o)&&(e=r(t,i,u),e.length>f&&(kt[o]||o===t.cu||delete t[o]));return e};this.findPrevCookiesBasedOnUI=function(i){var r=n._Persistence.getPersistence(),f,e,u,o,s;if(i)for(e in i.userIdentities)if(r&&Object.keys(r).length)for(u in r)if(r[u].mpid){o=r[u].ui;for(s in o)if(e===s&&i.userIdentities[e]===o[s]){f=u;break}}f&&t.storeDataInMemory(r,f)};this.encodePersistence=function(t){var i,r;t=JSON.parse(t);for(i in t.gs)t.gs.hasOwnProperty(i)&&(ri[i]?t.gs[i]?Array.isArray(t.gs[i])&&t.gs[i].length||n._Helpers.isObject(t.gs[i])&&Object.keys(t.gs[i]).length?t.gs[i]=g.encode(JSON.stringify(t.gs[i])):delete t.gs[i]:delete t.gs[i]:i==="ie"?t.gs[i]=t.gs[i]?1:0:t.gs[i]||delete t.gs[i]);for(r in t)if(t.hasOwnProperty(r)&&!kt[r])for(i in t[r])t[r].hasOwnProperty(i)&&ri[i]&&(n._Helpers.isObject(t[r][i])&&Object.keys(t[r][i]).length?t[r][i]=g.encode(JSON.stringify(t[r][i])):delete t[r][i]);return iu(JSON.stringify(t))};this.decodePersistence=function(t){var i,r;try{if(t){if(t=JSON.parse(ru(t)),n._Helpers.isObject(t)&&Object.keys(t).length){for(i in t.gs)t.gs.hasOwnProperty(i)&&(ri[i]?t.gs[i]=JSON.parse(g.decode(t.gs[i])):i==="ie"&&(t.gs[i]=Boolean(t.gs[i])));for(r in t)if(t.hasOwnProperty(r))if(kt[r])r==="l"&&(t[r]=Boolean(t[r]));else for(i in t[r])t[r].hasOwnProperty(i)&&ri[i]&&t[r][i].length&&(t[r][i]=JSON.parse(g.decode(t[r][i])))}return JSON.stringify(t)}}catch(u){n.Logger.error("Problem with decoding cookie",u)}};this.getCookieDomain=function(){if(n._Store.SDKConfig.cookieDomain)return n._Store.SDKConfig.cookieDomain;var i=t.getDomain(document,location.hostname);return i===""?"":"."+i};this.getDomain=function(n,t){for(var r,u="mptest=cookie",f=t.split("."),i=f.length-1;i>=0;i--)if(r=f.slice(i).join("."),n.cookie=u+";domain=."+r+";",n.cookie.indexOf(u)>-1)return n.cookie=u.split("=")[0]+"=;domain=."+r+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",r;return""};this.getUserIdentities=function(n){var i=t.getPersistence();return i&&i[n]&&i[n].ui?i[n].ui:{}};this.getAllUserAttributes=function(n){var i=t.getPersistence();return i&&i[n]&&i[n].ua?i[n].ua:{}};this.getCartProducts=function(t){var i,r=localStorage.getItem(n._Store.prodStorageName);return r&&(i=JSON.parse(g.decode(r)),i&&i[t]&&i[t].cp)?i[t].cp:[]};this.setCartProducts=function(t){if(n._Store.isLocalStorageAvailable)try{window.localStorage.setItem(encodeURIComponent(n._Store.prodStorageName),g.encode(JSON.stringify(t)))}catch(i){n.Logger.error("Error with setting products on localStorage.")}};this.saveUserIdentitiesToPersistence=function(n,i){if(i){var r=t.getPersistence();r&&(r[n]?r[n].ui=i:r[n]={ui:i},t.savePersistence(r))}};this.saveUserAttributesToPersistence=function(n,i){var r=t.getPersistence();i&&(r&&(r[n]?r[n].ui=i:r[n]={ui:i}),t.savePersistence(r))};this.saveUserCookieSyncDatesToPersistence=function(n,i){if(i){var r=t.getPersistence();r&&(r[n]?r[n].csd=i:r[n]={csd:i});t.savePersistence(r)}};this.saveUserConsentStateToCookies=function(i,r){if(r||r===null){var u=t.getPersistence();u&&(u[i]?u[i].con=n._Consent.ConsentSerialization.toMinifiedJsonObject(r):u[i]={con:n._Consent.ConsentSerialization.toMinifiedJsonObject(r)},t.savePersistence(u))}};this.savePersistence=function(i){var e=t.encodePersistence(JSON.stringify(i)),o=new Date,s=n._Store.storageName,h=new Date(o.getTime()+n._Store.SDKConfig.cookieExpiration*864e5).toGMTString(),r=t.getCookieDomain(),u,f;u=r===""?"":";domain="+r;n._Store.SDKConfig.useCookieStorage?(f=t.reduceAndEncodePersistence(i,h,u,n._Store.SDKConfig.maxCookieSize),window.document.cookie=encodeURIComponent(s)+"="+f):n._Store.isLocalStorageAvailable&&localStorage.setItem(n._Store.storageName,e)};this.getPersistence=function(){return this.useLocalStorage()?this.getLocalStorage():this.getCookie()};this.getConsentState=function(i){var r=t.getPersistence();return r&&r[i]&&r[i].con?n._Consent.ConsentSerialization.fromMinifiedJsonObject(r[i].con):null};this.getFirstSeenTime=function(n){if(!n)return null;var i=t.getPersistence();return i&&i[n]&&i[n].fst?i[n].fst:null};this.setFirstSeenTime=function(n,i){if(n){i||(i=(new Date).getTime());var r=t.getPersistence();r&&(r[n]||(r[n]={}),r[n].fst||(r[n].fst=i,t.savePersistence(r)))}};this.getLastSeenTime=function(i){if(!i)return null;if(i===n.Identity.getCurrentUser().getMPID())return(new Date).getTime();var r=t.getPersistence();return r&&r[i]&&r[i].lst?r[i].lst:null};this.setLastSeenTime=function(n,i){if(n){i||(i=(new Date).getTime());var r=t.getPersistence();r&&r[n]&&(r[n].lst=i,t.savePersistence(r))}};this.getDeviceId=function(){return n._Store.deviceId};this.setDeviceId=function(i){n._Store.deviceId=i;t.update()};this.resetPersistence=function(){if(i(ft.localStorageName),i(ft.localStorageNameV3),i(ft.localStorageNameV4),i(n._Store.prodStorageName),i(n._Store.storageName),i(ft.localStorageProductsV4),t.expireCookies(ft.cookieName),t.expireCookies(ft.cookieNameV2),t.expireCookies(ft.cookieNameV3),t.expireCookies(ft.cookieNameV4),t.expireCookies(n._Store.prodStorageName),t.expireCookies(n._Store.storageName),mParticle._isTestEnv){var r="abcdef";i(n._Helpers.createMainStorageName(r));t.expireCookies(n._Helpers.createMainStorageName(r));i(n._Helpers.createProductStorageName(r))}};this.forwardingStatsBatches={uploadsTable:{},forwardingStatsEventQueue:[]}}function ye(t){var i=this;this.logEvent=function(n,i){if(t.Logger.verbose(ot.InformationMessages.StartingLogEvent+": "+n.name),t._Helpers.canLog()){var r=t._ServerModel.createEventObject(n);t._APIClient.sendEventToServer(r,i)}else t.Logger.verbose(ot.InformationMessages.AbandonLogEvent)};this.startTracking=function(n){function u(r){t._Store.currentPosition={lat:r.coords.latitude,lng:r.coords.longitude};i(n,r);n=null;t._Store.isTracking=!0}function f(){i(n);n=null;t._Store.isTracking=!1}function i(n,i){if(n)try{i?n(i):n()}catch(r){t.Logger.error("Error invoking the callback passed to startTrackingLocation.");t.Logger.error(r)}}if(t._Store.isTracking){var r={coords:{latitude:t._Store.currentPosition.lat,longitude:t._Store.currentPosition.lng}};i(n,r)}else"geolocation"in navigator&&(t._Store.watchPositionId=navigator.geolocation.watchPosition(u,f))};this.stopTracking=function(){t._Store.isTracking&&(navigator.geolocation.clearWatch(t._Store.watchPositionId),t._Store.currentPosition=null,t._Store.isTracking=!1)};this.logOptOut=function(){t.Logger.verbose(ot.InformationMessages.StartingLogOptOut);var i=t._ServerModel.createEventObject({messageType:n.MessageType.OptOut,eventType:n.EventType.Other});t._APIClient.sendEventToServer(i)};this.logAST=function(){i.logEvent({messageType:n.MessageType.AppStateTransition})};this.logCheckoutEvent=function(r,u,f,e){var o=t._Ecommerce.createCommerceEventObject(e);o&&(o.EventName+=t._Ecommerce.getProductActionEventName(n.ProductActionType.Checkout),o.EventCategory=n.CommerceEventType.ProductCheckout,o.ProductAction={ProductActionType:n.ProductActionType.Checkout,CheckoutStep:r,CheckoutOptions:u,ProductList:[]},i.logCommerceEvent(o,f))};this.logProductActionEvent=function(n,r,u,f,e,o){var s=t._Ecommerce.createCommerceEventObject(f),h=Array.isArray(r)?r:[r];h.forEach(function(n){n.TotalAmount&&(n.TotalAmount=t._Ecommerce.sanitizeAmount(n.TotalAmount,"TotalAmount"));n.Position&&(n.Position=t._Ecommerce.sanitizeAmount(n.Position,"Position"));n.Price&&(n.Price=t._Ecommerce.sanitizeAmount(n.Price,"Price"));n.Quantity&&(n.Quantity=t._Ecommerce.sanitizeAmount(n.Quantity,"Quantity"))});s&&(s.EventCategory=t._Ecommerce.convertProductActionToEventType(n),s.EventName+=t._Ecommerce.getProductActionEventName(n),s.ProductAction={ProductActionType:n,ProductList:h},t._Helpers.isObject(e)&&t._Ecommerce.convertTransactionAttributesToProductAction(e,s.ProductAction),i.logCommerceEvent(s,u,o))};this.logPurchaseEvent=function(r,u,f,e){var o=t._Ecommerce.createCommerceEventObject(e);o&&(o.EventName+=t._Ecommerce.getProductActionEventName(n.ProductActionType.Purchase),o.EventCategory=n.CommerceEventType.ProductPurchase,o.ProductAction={ProductActionType:n.ProductActionType.Purchase},o.ProductAction.ProductList=t._Ecommerce.buildProductList(o,u),t._Ecommerce.convertTransactionAttributesToProductAction(r,o.ProductAction),i.logCommerceEvent(o,f))};this.logRefundEvent=function(r,u,f,e){if(!r){t.Logger.error(ot.ErrorMessages.TransactionRequired);return}var o=t._Ecommerce.createCommerceEventObject(e);o&&(o.EventName+=t._Ecommerce.getProductActionEventName(n.ProductActionType.Refund),o.EventCategory=n.CommerceEventType.ProductRefund,o.ProductAction={ProductActionType:n.ProductActionType.Refund},o.ProductAction.ProductList=t._Ecommerce.buildProductList(o,u),t._Ecommerce.convertTransactionAttributesToProductAction(r,o.ProductAction),i.logCommerceEvent(o,f))};this.logPromotionEvent=function(n,r,u,f,e){var o=t._Ecommerce.createCommerceEventObject(f);o&&(o.EventName+=t._Ecommerce.getPromotionActionEventName(n),o.EventCategory=t._Ecommerce.convertPromotionActionToEventType(n),o.PromotionAction={PromotionActionType:n,PromotionList:Array.isArray(r)?r:[r]},i.logCommerceEvent(o,u,e))};this.logImpressionEvent=function(r,u,f,e){var o=t._Ecommerce.createCommerceEventObject(f);o&&(o.EventName+="Impression",o.EventCategory=n.CommerceEventType.ProductImpression,Array.isArray(r)||(r=[r]),o.ProductImpressions=[],r.forEach(function(n){o.ProductImpressions.push({ProductImpressionList:n.Name,ProductList:Array.isArray(n.Product)?n.Product:[n.Product]})}),i.logCommerceEvent(o,u,e))};this.logCommerceEvent=function(n,i,r){if(t.Logger.verbose(ot.InformationMessages.StartingLogCommerceEvent),n.ProductAction&&n.EventCategory===null){t.Logger.error("Commerce event not sent.  The mParticle.ProductActionType you passed was invalid. Re-check your code.");return}i=t._Helpers.sanitizeAttributes(i,n.EventName);t._Helpers.canLog()?(t._Store.webviewBridgeEnabled&&(n.ShoppingCart={}),i&&(n.EventAttributes=i),t._APIClient.sendEventToServer(n,r),t._Persistence.update()):t.Logger.verbose(ot.InformationMessages.AbandonLogEvent)};this.addEventHandler=function(r,u,f,e,o){var h=[],l=function(r){var u=function(){s.href?window.location.href=s.href:s.submit&&s.submit()};t.Logger.verbose("DOM event triggered, handling event");i.logEvent({messageType:n.MessageType.PageEvent,name:typeof f=="function"?f(s):f,data:typeof e=="function"?e(s):e,eventType:o||n.EventType.Other});(s.href&&s.target!=="_blank"||s.submit)&&(r.preventDefault?r.preventDefault():r.returnValue=!1,setTimeout(u,t._Store.SDKConfig.timeout))},s,c;if(!u){t.Logger.error("Can't bind event, selector is required");return}if(typeof u=="string"?h=document.querySelectorAll(u):u.nodeType&&(h=[u]),h.length)for(t.Logger.verbose("Found "+h.length+" element"+(h.length>1?"s":"")+", attaching event handlers"),c=0;c<h.length;c++)s=h[c],s.addEventListener?s.addEventListener(r,l,!1):s.attachEvent?s.attachEvent("on"+r,l):s["on"+r]=l;else t.Logger.verbose("No elements found")}}function er(t,i,r,u){var f=this;return{getUserIdentities:function(){var f={},o=r._Persistence.getUserIdentities(t),e,s;for(e in o)o.hasOwnProperty(e)&&(s=n.IdentityType.getIdentityName(r._Helpers.parseNumber(e)),u&&(!u||u.isIdentityBlocked(s))||(f[s]=o[e]));return f=r._Helpers.filterUserIdentitiesForForwarders(f,i.userIdentityFilters),{userIdentities:f}},getMPID:function(){return t},getUserAttributesLists:function(n){var i,e={},t;i=f.getAllUserAttributes();for(t in i)i.hasOwnProperty(t)&&Array.isArray(i[t])&&(u&&(!u||u.isAttributeKeyBlocked(t))||(e[t]=i[t].slice()));return r._Helpers.filterUserAttributes(e,n.userAttributeFilters)},getAllUserAttributes:function(){var e={},f=r._Persistence.getAllUserAttributes(t),n;if(f)for(n in f)f.hasOwnProperty(n)&&(u&&(!u||u.isAttributeKeyBlocked(n))||(e[n]=Array.isArray(f[n])?f[n].slice():f[n]));return r._Helpers.filterUserAttributes(e,i.userAttributeFilters)}}}function pe(t,i){var r=this,u={setUserAttribute:"setUserAttribute",removeUserAttribute:"removeUserAttribute"};this.initForwarders=function(n,i){var u=t.Identity.getCurrentUser();!t._Store.webviewBridgeEnabled&&t._Store.configuredForwarders&&(t._Store.configuredForwarders.sort(function(n,t){return n.settings.PriorityValue=n.settings.PriorityValue||0,t.settings.PriorityValue=t.settings.PriorityValue||0,-1*(n.settings.PriorityValue-t.settings.PriorityValue)}),t._Store.activeForwarders=t._Store.configuredForwarders.filter(function(f){if(!t._Consent.isEnabledForUserConsent(f.filteringConsentRuleValues,u)||!r.isEnabledForUserAttributes(f.filteringUserAttributeValue,u)||!r.isEnabledForUnknownUser(f.excludeAnonymousUser,u))return!1;var e=t._Helpers.filterUserIdentities(n,f.userIdentityFilters),o=t._Helpers.filterUserAttributes(u?u.getAllUserAttributes():{},f.userAttributeFilters);return f.initialized||(f.logger=t.Logger,f.init(f.settings,i,!1,null,o,e,t._Store.SDKConfig.appVersion,t._Store.SDKConfig.appName,t._Store.SDKConfig.customFlags,t._Store.clientId),f.initialized=!0),!0}))};this.isEnabledForUserAttributes=function(n,i){var e,o,r,f,u;if(!n||!t._Helpers.isObject(n)||!Object.keys(n).length)return!0;if(i)r=i.getAllUserAttributes();else return!1;f=!1;try{if(r&&t._Helpers.isObject(r)&&Object.keys(r).length)for(u in r)if(r.hasOwnProperty(u)&&(e=h.hashAttributeConditionalForwarding(u),o=h.hashAttributeConditionalForwarding(r[u]),e===n.userAttributeName&&o===n.userAttributeValue)){f=!0;break}return n?n.includeOnMatch===f:!0}catch(s){return!0}};this.isEnabledForUnknownUser=function(n,t){return(!t||!t.isLoggedIn())&&n?!1:!0};this.applyToForwarders=function(n,i){t._Store.activeForwarders.length&&t._Store.activeForwarders.forEach(function(r){var f=r[n],u;if(f)try{u=r[n](i);u&&t.Logger.verbose(u)}catch(e){t.Logger.verbose(e)}})};this.sendEventToForwarders=function(i){var u,o,s,w=function(n,i){n.UserIdentities&&n.UserIdentities.length&&n.UserIdentities.forEach(function(r,u){t._Helpers.inArray(i,h.hashUserIdentity(r.Type))&&(n.UserIdentities.splice(u,1),u>0&&u--)})},y=function(n,i){var u,r;if(i)for(r in n.EventAttributes)n.EventAttributes.hasOwnProperty(r)&&(u=h.hashEventAttributeKey(n.EventCategory,n.EventName,r),t._Helpers.inArray(i,u)&&delete n.EventAttributes[r])},e=function(n,i){return n&&n.length&&t._Helpers.inArray(n,i)?!0:!1},b=[n.MessageType.PageEvent,n.MessageType.PageView,n.MessageType.Commerce],r,f,c,l,a,p,v;if(!t._Store.webviewBridgeEnabled&&t._Store.activeForwarders)for(o=h.hashEventName(i.EventName,i.EventCategory),s=h.hashEventType(i.EventCategory),r=0;r<t._Store.activeForwarders.length;r++){if(b.indexOf(i.EventDataType)>-1&&t._Store.activeForwarders[r].filteringEventAttributeValue&&t._Store.activeForwarders[r].filteringEventAttributeValue.eventAttributeName&&t._Store.activeForwarders[r].filteringEventAttributeValue.eventAttributeValue){if(f=null,i.EventAttributes)for(c in i.EventAttributes)if(l=h.hashAttributeConditionalForwarding(c),l===t._Store.activeForwarders[r].filteringEventAttributeValue.eventAttributeName&&(f={name:l,value:h.hashAttributeConditionalForwarding(i.EventAttributes[c])}),f)break;if(a=f!==null&&f.value===t._Store.activeForwarders[r].filteringEventAttributeValue.eventAttributeValue,p=t._Store.activeForwarders[r].filteringEventAttributeValue.includeOnMatch===!0?a:!a,!p)continue}if(u={},u=t._Helpers.extend(!0,u,i),i.EventDataType===n.MessageType.PageEvent&&(e(t._Store.activeForwarders[r].eventNameFilters,o)||e(t._Store.activeForwarders[r].eventTypeFilters,s)))continue;else if(i.EventDataType===n.MessageType.Commerce&&e(t._Store.activeForwarders[r].eventTypeFilters,s))continue;else if(i.EventDataType===n.MessageType.PageView&&e(t._Store.activeForwarders[r].screenNameFilters,o))continue;u.EventAttributes&&(i.EventDataType===n.MessageType.PageEvent?y(u,t._Store.activeForwarders[r].attributeFilters):i.EventDataType===n.MessageType.PageView&&y(u,t._Store.activeForwarders[r].screenAttributeFilters));w(u,t._Store.activeForwarders[r].userIdentityFilters);u.UserAttributes=t._Helpers.filterUserAttributes(u.UserAttributes,t._Store.activeForwarders[r].userAttributeFilters);t._Store.activeForwarders[r].process&&(t.Logger.verbose("Sending message to forwarder: "+t._Store.activeForwarders[r].name),v=t._Store.activeForwarders[r].process(u),v&&t.Logger.verbose(v))}};this.handleForwarderUserAttributes=function(n,r,f){i&&i.isAttributeKeyBlocked(r)||!t._Store.activeForwarders.length||t._Store.activeForwarders.forEach(function(i){var o=i[n],e;if(o&&!t._Helpers.isFilteredUserAttribute(r,i.userAttributeFilters))try{n===u.setUserAttribute?e=i.setUserAttribute(r,f):n===u.removeUserAttribute&&(e=i.removeUserAttribute(r));e&&t.Logger.verbose(e)}catch(s){t.Logger.error(s)}})};this.setForwarderUserIdentities=function(n){t._Store.activeForwarders.forEach(function(i){var r=t._Helpers.filterUserIdentities(n,i.userIdentityFilters);i.setUserIdentity&&r.forEach(function(n){var r=i.setUserIdentity(n.Identity,n.Type);r&&t.Logger.verbose(r)})})};this.setForwarderOnUserIdentified=function(n){t._Store.activeForwarders.forEach(function(r){var f=er(n.getMPID(),r,t,i),u;r.onUserIdentified&&(u=r.onUserIdentified(f),u&&t.Logger.verbose(u))})};this.setForwarderOnIdentityComplete=function(n,r){var u;t._Store.activeForwarders.forEach(function(f){var e=er(n.getMPID(),f,t,i);r==="identify"?f.onIdentifyComplete&&(u=f.onIdentifyComplete(e),u&&t.Logger.verbose(u)):r==="login"?f.onLoginComplete&&(u=f.onLoginComplete(e),u&&t.Logger.verbose(u)):r==="logout"?f.onLogoutComplete&&(u=f.onLogoutComplete(e),u&&t.Logger.verbose(u)):r==="modify"&&f.onModifyComplete&&(u=f.onModifyComplete(e),u&&t.Logger.verbose(u))})};this.getForwarderStatsQueue=function(){return t._Persistence.forwardingStatsBatches.forwardingStatsEventQueue};this.setForwarderStatsQueue=function(n){t._Persistence.forwardingStatsBatches.forwardingStatsEventQueue=n};this.processForwarders=function(n,i){n?(this.processUIEnabledKits(n),this.processSideloadedKits(n),r.initForwarders(t._Store.SDKConfig.identifyRequest.userIdentities,i)):t.Logger.warning("No config was passed. Cannot process forwarders")};this.processUIEnabledKits=function(n){var i=this.returnKitConstructors();try{Array.isArray(n.kitConfigs)&&n.kitConfigs.length&&n.kitConfigs.forEach(function(n){r.configureUIEnabledKit(n,i)})}catch(u){t.Logger.error("MP Kits not configured propertly. Kits may not be initialized. "+u)}};this.returnKitConstructors=function(){var n={};return y(t._Store.SDKConfig.kits)?y(t._preInit.forwarderConstructors)||t._preInit.forwarderConstructors.forEach(function(t){if(t.suffix){var i="".concat(t.name,"-").concat(t.suffix);n[i]=t}else n[t.name]=t}):n=t._Store.SDKConfig.kits,n};this.configureUIEnabledKit=function(n,i){var e=null,r=n,u,f;for(u in i)if(f=void 0,r.suffix&&(f="".concat(r.name,"-").concat(r.suffix)),(u===f||u===r.name)&&(r.isDebug===t._Store.SDKConfig.isDevelopmentMode||r.isSandbox===t._Store.SDKConfig.isDevelopmentMode)){e=this.returnConfiguredKit(i[u],r);t._Store.configuredForwarders.push(e);break}};this.processSideloadedKits=function(n){var i,u,f,e;try{if(Array.isArray(n.sideloadedKits)){i={kits:{}};n.sideloadedKits.forEach(function(n){try{n.kitInstance.register(i)}catch(t){console.error("Error registering sideloaded kit "+n.kitInstance.name)}});for(u in i.kits)f=i.kits[u],r.configureSideloadedKit(f);y(i.kits)||(e=Object.keys(i.kits),t._Store.sideloadedKitsCount=e.length)}}catch(o){t.Logger.error("Sideloaded Kits not configured propertly. Kits may not be initialized. "+o)}};this.configureSideloadedKit=function(n){t._Store.configuredForwarders.push(this.returnConfiguredKit(n))};this.returnConfiguredKit=function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=new n.constructor;return i.id=t.moduleId,i.isSandbox=t.isDebug||t.isSandbox,i.hasSandbox=t.hasDebugString==="true",i.isVisible=t.isVisible||!0,i.settings=t.settings||{},i.eventNameFilters=t.eventNameFilters||[],i.eventTypeFilters=t.eventTypeFilters||[],i.attributeFilters=t.attributeFilters||[],i.screenNameFilters=t.screenNameFilters||[],i.screenAttributeFilters=t.screenAttributeFilters||[],i.userIdentityFilters=t.userIdentityFilters||[],i.userAttributeFilters=t.userAttributeFilters||[],i.filteringEventAttributeValue=t.filteringEventAttributeValue||{},i.filteringUserAttributeValue=t.filteringUserAttributeValue||{},i.eventSubscriptionId=t.eventSubscriptionId||null,i.filteringConsentRuleValues=t.filteringConsentRuleValues||{},i.excludeAnonymousUser=t.excludeAnonymousUser||!1,i};this.configurePixel=function(n){(n.isDebug===t._Store.SDKConfig.isDevelopmentMode||n.isProduction!==t._Store.SDKConfig.isDevelopmentMode)&&t._Store.pixelConfigurations.push(n)};this.processPixelConfigs=function(n){try{y(n.pixelConfigs)||n.pixelConfigs.forEach(function(n){r.configurePixel(n)})}catch(i){t.Logger.error("Cookie Sync configs not configured propertly. Cookie Sync may not be initialized. "+i)}}}function we(n,t){var r=[],i;t.flags={};for(i in n.CustomFlags)r=[],n.CustomFlags.hasOwnProperty(i)&&(Array.isArray(n.CustomFlags[i])?n.CustomFlags[i].forEach(function(n){(typeof n=="number"||typeof n=="string"||typeof n=="boolean")&&r.push(n.toString())}):(typeof n.CustomFlags[i]=="number"||typeof n.CustomFlags[i]=="string"||typeof n.CustomFlags[i]=="boolean")&&r.push(n.CustomFlags[i].toString()),r.length&&(t.flags[i]=r))}function be(n){return{id:et(n.Sku),nm:et(n.Name),pr:pt(n.Price),qt:pt(n.Quantity),br:et(n.Brand),va:et(n.Variant),ca:et(n.Category),ps:pt(n.Position),cc:et(n.CouponCode),tpa:pt(n.TotalAmount),attrs:n.Attributes}}function ai(n){return n?n.map(function(n){return be(n)}):[]}function sr(i){var r=this;this.appendUserInfo=function(t,r){var e,u,o,s,h,c,f;if(r){if(!t){r.MPID=null;r.ConsentState=null;r.UserAttributes=null;r.UserIdentities=null;return}if(!r.MPID||r.MPID!==t.getMPID()){r.MPID=t.getMPID();r.ConsentState=t.getConsentState();r.UserAttributes=t.getAllUserAttributes();e=t.getUserIdentities().userIdentities;u={};for(o in e)s=n.IdentityType.getIdentityType(o),s!==!1&&(u[s]=e[o]);if(h=[],i._Helpers.isObject(u)&&Object.keys(u).length)for(c in u)f={},f.Identity=u[c],f.Type=i._Helpers.parseNumber(c),h.push(f);r.UserIdentities=h}}};this.convertToConsentStateV2DTO=function(n){var f,e,r,i,t,u;if(!n)return null;if(f={},e=n.getGDPRConsentState(),e){r={};f.gdpr=r;for(i in e)e.hasOwnProperty(i)&&(t=e[i],f.gdpr[i]={},typeof t.Consented=="boolean"&&(r[i].c=t.Consented),typeof t.Timestamp=="number"&&(r[i].ts=t.Timestamp),typeof t.ConsentDocument=="string"&&(r[i].d=t.ConsentDocument),typeof t.Location=="string"&&(r[i].l=t.Location),typeof t.HardwareId=="string"&&(r[i].h=t.HardwareId))}return u=n.getCCPAConsentState(),u&&(f.ccpa={data_sale_opt_out:{c:u.Consented,ts:u.Timestamp,d:u.ConsentDocument,l:u.Location,h:u.HardwareId}}),f};this.createEventObject=function(u,f){var o={},e={},h=u.messageType===n.MessageType.OptOut?!i._Store.isEnabled:null,s;return i._Store.sessionId||u.messageType===n.MessageType.OptOut||i._Store.webviewBridgeEnabled?(e=u.hasOwnProperty("toEventAPIObject")?u.toEventAPIObject():{EventName:u.name||u.messageType,EventCategory:u.eventType,EventAttributes:i._Helpers.sanitizeAttributes(u.data,u.name),SourceMessageId:u.sourceMessageId||i._Helpers.generateUniqueId(),EventDataType:u.messageType,CustomFlags:u.customFlags||{},UserAttributeChanges:u.userAttributeChanges,UserIdentityChanges:u.userIdentityChanges},u.messageType!==n.MessageType.SessionEnd&&(i._Store.dateLastEventSent=new Date),o={Store:i._Store.serverSettings,SDKVersion:t.sdkVersion,SessionId:i._Store.sessionId,SessionStartDate:i._Store.sessionStartDate?i._Store.sessionStartDate.getTime():0,Debug:i._Store.SDKConfig.isDevelopmentMode,Location:i._Store.currentPosition,OptOut:h,ExpandedEventCount:0,AppVersion:i.getAppVersion(),AppName:i.getAppName(),Package:i._Store.SDKConfig.package,ClientGeneratedId:i._Store.clientId,DeviceId:i._Store.deviceId,IntegrationAttributes:i._Store.integrationAttributes,CurrencyCode:i._Store.currencyCode,DataPlan:i._Store.SDKConfig.dataPlan?i._Store.SDKConfig.dataPlan:{}},e.EventDataType===dt.AppStateTransition&&(e.IsFirstRun=i._Store.isFirstRun,e.LaunchReferral=window.location.href||null),e.CurrencyCode=i._Store.currencyCode,s=f||i.Identity.getCurrentUser(),r.appendUserInfo(s,e),u.messageType===n.MessageType.SessionEnd&&(e.SessionLength=i._Store.dateLastEventSent.getTime()-i._Store.sessionStartDate.getTime(),e.currentSessionMPIDs=i._Store.currentSessionMPIDs,e.EventAttributes=i._Store.sessionAttributes,i._Store.currentSessionMPIDs=[],i._Store.sessionStartDate=null),o.Timestamp=i._Store.dateLastEventSent.getTime(),i._Helpers.extend({},e,o)):null};this.convertEventToV2DTO=function(n){var t={n:n.EventName,et:n.EventCategory,ua:n.UserAttributes,ui:n.UserIdentities,ia:n.IntegrationAttributes,str:n.Store,attrs:n.EventAttributes,sdk:n.SDKVersion,sid:n.SessionId,sl:n.SessionLength,ssd:n.SessionStartDate,dt:n.EventDataType,dbg:n.Debug,ct:n.Timestamp,lc:n.Location,o:n.OptOut,eec:n.ExpandedEventCount,av:n.AppVersion,cgid:n.ClientGeneratedId,das:n.DeviceId,mpid:n.MPID,smpids:n.currentSessionMPIDs},u;return n.DataPlan&&n.DataPlan.PlanId&&(t.dp_id=n.DataPlan.PlanId,n.DataPlan.PlanVersion&&(t.dp_v=n.DataPlan.PlanVersion)),u=r.convertToConsentStateV2DTO(n.ConsentState),u&&(t.con=u),n.EventDataType===dt.AppStateTransition&&(t.fr=n.IsFirstRun,t.iu=!1,t.at=or.AppInit,t.lr=n.LaunchReferral,t.attrs=null),n.CustomFlags&&we(n,t),n.EventDataType===dt.Commerce?(t.cu=n.CurrencyCode,n.ShoppingCart&&(t.sc={pl:ai(n.ShoppingCart.ProductList)}),n.ProductAction?t.pd={an:n.ProductAction.ProductActionType,cs:i._Helpers.parseNumber(n.ProductAction.CheckoutStep),co:n.ProductAction.CheckoutOptions,pl:ai(n.ProductAction.ProductList),ti:n.ProductAction.TransactionId,ta:n.ProductAction.Affiliation,tcc:n.ProductAction.CouponCode,tr:i._Helpers.parseNumber(n.ProductAction.TotalAmount),ts:i._Helpers.parseNumber(n.ProductAction.ShippingAmount),tt:i._Helpers.parseNumber(n.ProductAction.TaxAmount)}:n.PromotionAction?t.pm={an:n.PromotionAction.PromotionActionType,pl:n.PromotionAction.PromotionList.map(function(n){return{id:n.Id,nm:n.Name,cr:n.Creative,ps:n.Position?n.Position:0}})}:n.ProductImpressions&&(t.pi=n.ProductImpressions.map(function(n){return{pil:n.ProductImpressionList,pl:ai(n.ProductList)}}))):n.EventDataType===dt.Profile&&(t.pet=n.ProfileMessageType),t}}function ke(n){function t(){var i=n._Forwarders.getForwarderStatsQueue(),t=n._Persistence.forwardingStatsBatches.uploadsTable,u=Date.now(),r;i.length&&(t[u]={uploading:!1,data:i},n._Forwarders.setForwarderStatsQueue([]));for(r in t)(function(i){if(t.hasOwnProperty(i)&&t[i].uploading===!1){var u=function(){r.readyState===4&&(r.status===200||r.status===202?(n.Logger.verbose("Successfully sent  "+r.statusText+" from server"),delete t[i]):r.status.toString()[0]==="4"?r.status!==429&&delete t[i]:t[i].uploading=!1)},r=n._Helpers.createXHR(u),f=t[i].data;t[i].uploading=!0;n._APIClient.sendBatchForwardingStatsToServer(f,r)}})(r)}this.startForwardingStatsTimer=function(){mParticle._forwardingStatsTimer=setInterval(function(){t()},n._Store.SDKConfig.forwarderStatsTimeout)}}function de(i){var r=this;this.checkIdentitySwap=function(n,t,r){if(n&&t&&n!==t){var u=i._Persistence.getPersistence();u&&(u.cu=t,u.gs.csm=r,i._Persistence.savePersistence(u))}};this.IdentityRequest={createKnownIdentities:function(n,t){var r={},u;if(n&&n.userIdentities&&i._Helpers.isObject(n.userIdentities))for(u in n.userIdentities)r[u]=n.userIdentities[u];return r.device_application_stamp=t,r},preProcessIdentityRequest:function(n,t,r){var u,f;return(i.Logger.verbose(s.InformationMessages.StartingLogEvent+": "+r),u=i._Helpers.Validators.validateIdentities(n,r),!u.valid)?(i.Logger.error("ERROR: "+u.error),{valid:!1,error:u.error}):t&&!i._Helpers.Validators.isFunction(t)?(f="The optional callback must be a function. You tried entering a(n) "+a(t),i.Logger.error(f),{valid:!1,error:f}):{valid:!0}},createIdentityRequest:function(n,t,r,u,f,e,o){return{client_sdk:{platform:t,sdk_vendor:r,sdk_version:u},context:e,environment:i._Store.SDKConfig.isDevelopmentMode?"development":"production",request_id:i._Helpers.generateUniqueId(),request_timestamp_ms:(new Date).getTime(),previous_mpid:o||null,known_identities:this.createKnownIdentities(n,f)}},createModifyIdentityRequest:function(n,t,r,u,f,e){return{client_sdk:{platform:r,sdk_vendor:u,sdk_version:f},context:e,environment:i._Store.SDKConfig.isDevelopmentMode?"development":"production",request_id:i._Helpers.generateUniqueId(),request_timestamp_ms:(new Date).getTime(),identity_changes:this.createIdentityChanges(n,t)}},createIdentityChanges:function(n,t){var u=[],r;if(t&&i._Helpers.isObject(t)&&n&&i._Helpers.isObject(n))for(r in t)u.push({old_value:n[r]||null,new_value:t[r],identity_type:r});return u},combineUserIdentities:function(t,r){var e={},o=i._Helpers.extend(t,r),u,f;for(u in o)f=n.IdentityType.getIdentityType(u),f!==!1&&f>=0&&(e[n.IdentityType.getIdentityType(u)]=o[u]);return e},createAliasNetworkRequest:function(n){return{request_id:i._Helpers.generateUniqueId(),request_type:"alias",environment:i._Store.SDKConfig.isDevelopmentMode?"development":"production",api_key:i._Store.devToken,data:{destination_mpid:n.destinationMpid,source_mpid:n.sourceMpid,start_unixtime_ms:n.startTime,end_unixtime_ms:n.endTime,scope:n.scope,device_application_stamp:i._Store.deviceId}}},convertAliasToNative:function(n){return{DestinationMpid:n.destinationMpid,SourceMpid:n.sourceMpid,StartUnixtimeMs:n.startTime,EndUnixtimeMs:n.endTime}},convertToNative:function(t){var r=[],i;if(t&&t.userIdentities){for(i in t.userIdentities)t.userIdentities.hasOwnProperty(i)&&r.push({Type:n.IdentityType.getIdentityType(i),Identity:t.userIdentities[i]});return{UserIdentities:r}}}};this.IdentityAPI={HTTPCodes:c,identify:function(n,u){var f,o=i.Identity.getCurrentUser(),e=i._Identity.IdentityRequest.preProcessIdentityRequest(n,u,"identify"),h;o&&(f=o.getMPID());e.valid?(h=i._Identity.IdentityRequest.createIdentityRequest(n,t.platform,t.sdkVendor,t.sdkVersion,i._Store.deviceId,i._Store.context,f),i._Helpers.canLog()?i._Store.webviewBridgeEnabled?(i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.Identify,JSON.stringify(i._Identity.IdentityRequest.convertToNative(n))),i._Helpers.invokeCallback(u,c.nativeIdentityRequest,"Identify request sent to native sdk")):i._IdentityAPIClient.sendIdentityRequest(h,"identify",u,n,r.parseIdentityResponse,f):(i._Helpers.invokeCallback(u,c.loggingDisabledOrMissingAPIKey,s.InformationMessages.AbandonLogEvent),i.Logger.verbose(s.InformationMessages.AbandonLogEvent))):(i._Helpers.invokeCallback(u,c.validationIssue,e.error),i.Logger.verbose(e))},logout:function(u,f){var e,l=i.Identity.getCurrentUser(),o=i._Identity.IdentityRequest.preProcessIdentityRequest(u,f,"logout"),h,a;l&&(e=l.getMPID());o.valid?(a=i._Identity.IdentityRequest.createIdentityRequest(u,t.platform,t.sdkVendor,t.sdkVersion,i._Store.deviceId,i._Store.context,e),i._Helpers.canLog()?i._Store.webviewBridgeEnabled?(i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.Logout,JSON.stringify(i._Identity.IdentityRequest.convertToNative(u))),i._Helpers.invokeCallback(f,c.nativeIdentityRequest,"Logout request sent to native sdk")):(i._IdentityAPIClient.sendIdentityRequest(a,"logout",f,u,r.parseIdentityResponse,e),h=i._ServerModel.createEventObject({messageType:n.MessageType.Profile}),h.ProfileMessageType=n.ProfileMessageType.Logout,i._Store.activeForwarders.length&&i._Store.activeForwarders.forEach(function(n){n.logOut&&n.logOut(h)})):(i._Helpers.invokeCallback(f,c.loggingDisabledOrMissingAPIKey,s.InformationMessages.AbandonLogEvent),i.Logger.verbose(s.InformationMessages.AbandonLogEvent))):(i._Helpers.invokeCallback(f,c.validationIssue,o.error),i.Logger.verbose(o))},login:function(n,u){var f,o=i.Identity.getCurrentUser(),e=i._Identity.IdentityRequest.preProcessIdentityRequest(n,u,"login"),h;o&&(f=o.getMPID());e.valid?(h=i._Identity.IdentityRequest.createIdentityRequest(n,t.platform,t.sdkVendor,t.sdkVersion,i._Store.deviceId,i._Store.context,f),i._Helpers.canLog()?i._Store.webviewBridgeEnabled?(i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.Login,JSON.stringify(i._Identity.IdentityRequest.convertToNative(n))),i._Helpers.invokeCallback(u,c.nativeIdentityRequest,"Login request sent to native sdk")):i._IdentityAPIClient.sendIdentityRequest(h,"login",u,n,r.parseIdentityResponse,f):(i._Helpers.invokeCallback(u,c.loggingDisabledOrMissingAPIKey,s.InformationMessages.AbandonLogEvent),i.Logger.verbose(s.InformationMessages.AbandonLogEvent))):(i._Helpers.invokeCallback(u,c.validationIssue,e.error),i.Logger.verbose(e))},modify:function(n,u){var o,f=i.Identity.getCurrentUser(),e=i._Identity.IdentityRequest.preProcessIdentityRequest(n,u,"modify"),h,l;f&&(o=f.getMPID());h=n&&n.userIdentities?n.userIdentities:{};e.valid?(l=i._Identity.IdentityRequest.createModifyIdentityRequest(f?f.getUserIdentities().userIdentities:{},h,t.platform,t.sdkVendor,t.sdkVersion,i._Store.context),i._Helpers.canLog()?i._Store.webviewBridgeEnabled?(i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.Modify,JSON.stringify(i._Identity.IdentityRequest.convertToNative(n))),i._Helpers.invokeCallback(u,c.nativeIdentityRequest,"Modify request sent to native sdk")):i._IdentityAPIClient.sendIdentityRequest(l,"modify",u,n,r.parseIdentityResponse,o):(i._Helpers.invokeCallback(u,c.loggingDisabledOrMissingAPIKey,s.InformationMessages.AbandonLogEvent),i.Logger.verbose(s.InformationMessages.AbandonLogEvent))):(i._Helpers.invokeCallback(u,c.validationIssue,e.error),i.Logger.verbose(e))},getCurrentUser:function(){var n;return i._Store?(n=i._Store.mpid,n?(n=i._Store.mpid.slice(),r.mParticleUser(n,i._Store.isLoggedIn)):i._Store.webviewBridgeEnabled?r.mParticleUser():null):null},getUser:function(n){var u=i._Persistence.getPersistence();return u?u[n]&&!t.SDKv2NonMPIDCookieKeys.hasOwnProperty(n)?r.mParticleUser(n):null:null},getUsers:function(){var f=i._Persistence.getPersistence(),n=[],u;if(f)for(u in f)t.SDKv2NonMPIDCookieKeys.hasOwnProperty(u)||n.push(r.mParticleUser(u));return n.sort(function(n,t){var i=n.getLastSeenTime()||0,r=t.getLastSeenTime()||0;return i>r?-1:1}),n},aliasUsers:function(n,r){var u,f;if(n.destinationMpid&&n.sourceMpid||(u=s.ValidationMessages.AliasMissingMpid),n.destinationMpid===n.sourceMpid&&(u=s.ValidationMessages.AliasNonUniqueMpid),n.startTime&&n.endTime||(u=s.ValidationMessages.AliasMissingTime),n.startTime>n.endTime&&(u=s.ValidationMessages.AliasStartBeforeEndTime),u){i.Logger.warning(u);i._Helpers.invokeAliasCallback(r,c.validationIssue,u);return}i._Helpers.canLog()?i._Store.webviewBridgeEnabled?(i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.Alias,JSON.stringify(i._Identity.IdentityRequest.convertAliasToNative(n))),i._Helpers.invokeAliasCallback(r,c.nativeIdentityRequest,"Alias request sent to native sdk")):(i.Logger.verbose(s.InformationMessages.StartingAliasRequest+": "+n.sourceMpid+" -> "+n.destinationMpid),f=i._Identity.IdentityRequest.createAliasNetworkRequest(n),i._IdentityAPIClient.sendAliasRequest(f,r)):(i._Helpers.invokeAliasCallback(r,c.loggingDisabledOrMissingAPIKey,s.InformationMessages.AbandonAliasUsers),i.Logger.verbose(s.InformationMessages.AbandonAliasUsers))},createAliasRequest:function(n,t){var r,u,f;try{return!t||!n?(i.Logger.error("'destinationUser' and 'sourceUser' must both be present"),null):(r=n.getFirstSeenTime(),r||i.Identity.getUsers().forEach(function(n){n.getFirstSeenTime()&&(!r||n.getFirstSeenTime()<r)&&(r=n.getFirstSeenTime())}),u=(new Date).getTime()-i._Store.SDKConfig.aliasMaxWindow*864e5,f=n.getLastSeenTime()||(new Date).getTime(),r<u&&(r=u,f<r&&i.Logger.warning("Source User has not been seen in the last "+i._Store.SDKConfig.maxAliasWindow+" days, Alias Request will likely fail")),{destinationMpid:t.getMPID(),sourceMpid:n.getMPID(),startTime:r,endTime:f})}catch(e){return i.Logger.error("There was a problem with creating an alias request: "+e),null}}};this.mParticleUser=function(r,u){var f=this;return{getUserIdentities:function(){var f={},t=i._Persistence.getUserIdentities(r);for(var u in t)t.hasOwnProperty(u)&&(f[n.IdentityType.getIdentityName(i._Helpers.parseNumber(u))]=t[u]);return{userIdentities:f}},getMPID:function(){return r},setUserTag:function(n){if(!i._Helpers.Validators.isValidKeyValue(n)){i.Logger.error(s.ErrorMessages.BadKey);return}this.setUserAttribute(n,null)},removeUserTag:function(n){if(!i._Helpers.Validators.isValidKeyValue(n)){i.Logger.error(s.ErrorMessages.BadKey);return}this.removeUserAttribute(n)},setUserAttribute:function(n,u){var o,e,l,c,h;if(i._SessionManager.resetSessionTimer(),i._Helpers.canLog()){if(!i._Helpers.Validators.isValidAttributeValue(u)){i.Logger.error(s.ErrorMessages.BadAttribute);return}if(!i._Helpers.Validators.isValidKeyValue(n)){i.Logger.error(s.ErrorMessages.BadKey);return}i._Store.webviewBridgeEnabled?i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.SetUserAttribute,JSON.stringify({key:n,value:u})):(o=i._Persistence.getPersistence(),e=this.getAllUserAttributes(),h=i._Helpers.findKeyInObject(e,n),h?(c=!1,l=e[h],delete e[h]):c=!0,e[n]=u,o&&o[r]&&(o[r].ua=e,i._Persistence.savePersistence(o,r)),f.sendUserAttributeChangeEvent(n,u,l,c,!1,this),i._Forwarders.initForwarders(f.IdentityAPI.getCurrentUser().getUserIdentities(),i._APIClient.prepareForwardingStats),i._Forwarders.handleForwarderUserAttributes("setUserAttribute",n,u))}},setUserAttributes:function(n){if(i._SessionManager.resetSessionTimer(),i._Helpers.isObject(n)){if(i._Helpers.canLog())for(var t in n)n.hasOwnProperty(t)&&this.setUserAttribute(t,n[t])}else i.Logger.error("Must pass an object into setUserAttributes. You passed a "+a(n))},removeUserAttribute:function(n){var e,u,o,h;if(i._SessionManager.resetSessionTimer(),!i._Helpers.Validators.isValidKeyValue(n)){i.Logger.error(s.ErrorMessages.BadKey);return}i._Store.webviewBridgeEnabled?i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.RemoveUserAttribute,JSON.stringify({key:n,value:null})):(e=i._Persistence.getPersistence(),u=this.getAllUserAttributes(),o=i._Helpers.findKeyInObject(u,n),o&&(n=o),h=u[n]?u[n].toString():null,delete u[n],e&&e[r]&&(e[r].ua=u,i._Persistence.savePersistence(e,r)),f.sendUserAttributeChangeEvent(n,null,h,!1,!0,this),i._Forwarders.initForwarders(f.IdentityAPI.getCurrentUser().getUserIdentities(),i._APIClient.prepareForwardingStats),i._Forwarders.handleForwarderUserAttributes("removeUserAttribute",n,null))},setUserAttributeList:function(n,u){var h,e,o,p,l,v,y,c;if(i._SessionManager.resetSessionTimer(),!i._Helpers.Validators.isValidKeyValue(n)){i.Logger.error(s.ErrorMessages.BadKey);return}if(!Array.isArray(u)){i.Logger.error("The value you passed in to setUserAttributeList must be an array. You passed in a "+(typeof value=="undefined"?"undefined":a(value)));return}if(v=u.slice(),i._Store.webviewBridgeEnabled)i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.SetUserAttributeList,JSON.stringify({key:n,value:v}));else{if(h=i._Persistence.getPersistence(),e=this.getAllUserAttributes(),y=i._Helpers.findKeyInObject(e,n),y?(p=!1,o=e[y],delete e[y]):p=!0,e[n]=v,h&&h[r]&&(h[r].ua=e,i._Persistence.savePersistence(h,r)),o&&Array.isArray(o)){if(u.length!==o.length)l=!0;else for(c=0;c<u.length;c++)if(o[c]!==u[c]){l=!0;break}}else l=!0;l&&f.sendUserAttributeChangeEvent(n,u,o,p,!1,this);i._Forwarders.initForwarders(f.IdentityAPI.getCurrentUser().getUserIdentities(),i._APIClient.prepareForwardingStats);i._Forwarders.handleForwarderUserAttributes("setUserAttribute",n,v)}},removeAllUserAttributes:function(){var n,r;if(i._SessionManager.resetSessionTimer(),i._Store.webviewBridgeEnabled)i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.RemoveAllUserAttributes);else if(n=this.getAllUserAttributes(),i._Forwarders.initForwarders(f.IdentityAPI.getCurrentUser().getUserIdentities(),i._APIClient.prepareForwardingStats),n)for(r in n)n.hasOwnProperty(r)&&i._Forwarders.handleForwarderUserAttributes("removeUserAttribute",r,null),this.removeUserAttribute(r)},getUserAttributesLists:function(){var n,i={},t;n=this.getAllUserAttributes();for(t in n)n.hasOwnProperty(t)&&Array.isArray(n[t])&&(i[t]=n[t].slice());return i},getAllUserAttributes:function(){var u={},n=i._Persistence.getAllUserAttributes(r),t;if(n)for(t in n)n.hasOwnProperty(t)&&(u[t]=Array.isArray(n[t])?n[t].slice():n[t]);return u},getCart:function(){return i.Logger.warning("Deprecated function Identity.getCurrentUser().getCart() will be removed in future releases"),f.mParticleUserCart(r)},getConsentState:function(){return i._Persistence.getConsentState(r)},setConsentState:function(n){i._Persistence.saveUserConsentStateToCookies(r,n);i._Forwarders.initForwarders(this.getUserIdentities().userIdentities,i._APIClient.prepareForwardingStats);i._CookieSyncManager.attemptCookieSync(null,this.getMPID())},isLoggedIn:function(){return u},getLastSeenTime:function(){return i._Persistence.getLastSeenTime(r)},getFirstSeenTime:function(){return i._Persistence.getFirstSeenTime(r)}}};this.mParticleUserCart=function(r){return{add:function(u,f){var s,e,o,h;i.Logger.warning("Deprecated function Identity.getCurrentUser().getCart().add() will be removed in future releases");o=Array.isArray(u)?u.slice():[u];o.forEach(function(n){n.Attributes=i._Helpers.sanitizeAttributes(n.Attributes)});i._Store.webviewBridgeEnabled?i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.AddToCart,JSON.stringify(o)):(i._SessionManager.resetSessionTimer(),e=i._Persistence.getUserProductsFromLS(r),e=e.concat(o),f===!0&&i._Events.logProductActionEvent(n.ProductActionType.AddToCart,o),h={},h[r]={cp:e},e.length>i._Store.SDKConfig.maxProducts&&(i.Logger.verbose("The cart contains "+e.length+" items. Only "+i._Store.SDKConfig.maxProducts+" can currently be saved in cookies."),e=e.slice(-i._Store.SDKConfig.maxProducts)),s=i._Persistence.getAllUserProductsFromLS(),s[r].cp=e,i._Persistence.setCartProducts(s))},remove:function(u,f){var s,e,o,h,c;i.Logger.warning("Deprecated function Identity.getCurrentUser().getCart().remove() will be removed in future releases");o=-1;h=null;i._Store.webviewBridgeEnabled?i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.RemoveFromCart,JSON.stringify(u)):(i._SessionManager.resetSessionTimer(),e=i._Persistence.getUserProductsFromLS(r),e&&(e.forEach(function(n,t){n.Sku===u.Sku&&(o=t,h=n)}),o>-1&&(e.splice(o,1),f===!0&&i._Events.logProductActionEvent(n.ProductActionType.RemoveFromCart,h))),c={},c[r]={cp:e},s=i._Persistence.getAllUserProductsFromLS(),s[r].cp=e,i._Persistence.setCartProducts(s))},clear:function(){i.Logger.warning("Deprecated function Identity.getCurrentUser().getCart().clear() will be removed in future releases");var n;i._Store.webviewBridgeEnabled?i._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.ClearCart):(i._SessionManager.resetSessionTimer(),n=i._Persistence.getAllUserProductsFromLS(),n&&n[r]&&n[r].cp&&(n[r].cp=[],n[r].cp=[],i._Persistence.setCartProducts(n)))},getCartProducts:function(){return i.Logger.warning("Deprecated function Identity.getCurrentUser().getCart().getCartProducts() will be removed in future releases"),i._Persistence.getCartProducts(r)}}};this.parseIdentityResponse=function(t,u,f,e,o){var h=i.Identity.getUser(u),l,w,s,v,a={},b=h?h.getUserIdentities().userIdentities:{},tt=i._Helpers.extend({},b),nt,y,p;i._Store.identityCallInFlight=!1;try{if(i.Logger.verbose('Parsing "'+o+'" identity response from server'),t.responseText&&(s=JSON.parse(t.responseText),s.hasOwnProperty("is_logged_in")&&(i._Store.isLoggedIn=s.is_logged_in)),(!h||h.getMPID()&&s.mpid&&s.mpid!==h.getMPID())&&(i._Store.mpid=s.mpid,h&&i._Persistence.setLastSeenTime(u),i._Persistence.getFirstSeenTime(s.mpid)||(w=!0),i._Persistence.setFirstSeenTime(s.mpid)),t.status===200){if(o==="modify")a=i._Identity.IdentityRequest.combineUserIdentities(b,e.userIdentities),i._Persistence.saveUserIdentitiesToPersistence(u,a);else{var k=r.IdentityAPI.getUser(s.mpid),d=k?k.getUserIdentities().userIdentities:{},it=i._Helpers.extend({},d);i.Logger.verbose("Successfully parsed Identity Response");o==="identify"&&h&&s.mpid===h.getMPID()&&i._Persistence.setFirstSeenTime(s.mpid);v=i._Store.currentSessionMPIDs.indexOf(s.mpid);i._Store.sessionId&&s.mpid&&u!==s.mpid&&v<0&&i._Store.currentSessionMPIDs.push(s.mpid);v>-1&&(i._Store.currentSessionMPIDs=i._Store.currentSessionMPIDs.slice(0,v).concat(i._Store.currentSessionMPIDs.slice(v+1,i._Store.currentSessionMPIDs.length)),i._Store.currentSessionMPIDs.push(s.mpid));i._CookieSyncManager.attemptCookieSync(u,s.mpid,w);r.checkIdentitySwap(u,s.mpid,i._Store.currentSessionMPIDs);e&&e.userIdentities&&Object.keys(e.userIdentities).length&&(a=r.IdentityRequest.combineUserIdentities(d,e.userIdentities));i._Persistence.saveUserIdentitiesToPersistence(s.mpid,a);i._Persistence.update();i._Persistence.findPrevCookiesBasedOnUI(e);i._Store.context=s.context||i._Store.context}if(l=i.Identity.getCurrentUser(),e&&e.onUserAlias&&i._Helpers.Validators.isFunction(e.onUserAlias))try{i.Logger.warning("Deprecated function onUserAlias will be removed in future releases");e.onUserAlias(h,l)}catch(g){i.Logger.error("There was an error with your onUserAlias function - "+g)}nt=i._Persistence.getPersistence();l&&(i._Persistence.storeDataInMemory(nt,l.getMPID()),h&&l.getMPID()===h.getMPID()&&h.isLoggedIn()===l.isLoggedIn()||i._Forwarders.initForwarders(l.getUserIdentities().userIdentities,i._APIClient.prepareForwardingStats),i._Forwarders.setForwarderUserIdentities(l.getUserIdentities().userIdentities),i._Forwarders.setForwarderOnIdentityComplete(l,o),i._Forwarders.setForwarderOnUserIdentified(l,o));y={};for(p in a)y[n.IdentityType.getIdentityName(i._Helpers.parseNumber(p))]=a[p];r.sendUserIdentityChangeEvent(y,o,s.mpid,o==="modify"?tt:it)}f?t.status===0?i._Helpers.invokeCallback(f,c.noHttpCoverage,s||null,l):i._Helpers.invokeCallback(f,t.status,s||null,l):s&&s.errors&&s.errors.length&&i.Logger.error("Received HTTP response code of "+t.status+" - "+s.errors[0].message);i._APIClient.processQueuedEvents()}catch(g){f&&i._Helpers.invokeCallback(f,t.status,s||null);i.Logger.error("Error parsing JSON response from Identity server: "+g)}};this.sendUserIdentityChangeEvent=function(n,t,u,f){var o,s,e,h;if(u||t==="modify"){o=this.IdentityAPI.getUser(u);for(e in n)f[e]!==n[e]&&(h=!f[e],s=r.createUserIdentityChange(e,n[e],f[e],h,o),i._APIClient.sendEventToServer(s))}};this.createUserIdentityChange=function(t,r,u,f,e){return i._ServerModel.createEventObject({messageType:n.MessageType.UserIdentityChange,userIdentityChanges:{New:{IdentityType:t,Identity:r,CreatedThisBatch:f},Old:{IdentityType:t,Identity:u,CreatedThisBatch:!1}},userInMemory:e})};this.sendUserAttributeChangeEvent=function(n,t,u,f,e,o){var s=r.createUserAttributeChange(n,t,u,f,e,o);s&&i._APIClient.sendEventToServer(s)};this.createUserAttributeChange=function(t,r,u,f,e,o){typeof u=="undefined"&&(u=null);var s;return r!==u&&(s=i._ServerModel.createEventObject({messageType:n.MessageType.UserAttributeChange,userAttributeChanges:{UserAttributeName:t,New:r,Old:u,Deleted:e,IsNewAttribute:f}},o)),s}}function ge(n){var t=this;this.isEnabledForUserConsent=function(n,t){var i,r,u,e,o,s;if(!n||!n.values||!n.values.length)return!0;if(!t)return!1;if(i={},r=t.getConsentState(),r){var f=r.getGDPRConsentState();if(f)for(e in f)f.hasOwnProperty(e)&&(u=h.hashConsentPurposeConditionalForwarding("1",e),i[u]=f[e].Consented);o=r.getCCPAConsentState();o&&(u=h.hashConsentPurposeConditionalForwarding("2",l),i[u]=o.Consented)}return s=n.values.some(function(n){var t=n.consentPurpose,r=n.hasConsented;return i.hasOwnProperty(t)?i[t]===r:!1}),n.includeOnMatch===s};this.createPrivacyConsent=function(t,i,r,u,f){return typeof t!="boolean"?(n.Logger.error("Consented boolean is required when constructing a Consent object."),null):i&&isNaN(i)?(n.Logger.error("Timestamp must be a valid number when constructing a Consent object."),null):r&&typeof r!="string"?(n.Logger.error("Document must be a valid string when constructing a Consent object."),null):u&&typeof u!="string"?(n.Logger.error("Location must be a valid string when constructing a Consent object."),null):f&&typeof f!="string"?(n.Logger.error("Hardware ID must be a valid string when constructing a Consent object."),null):{Consented:t,Timestamp:i||Date.now(),ConsentDocument:r,Location:u,HardwareId:f}};this.ConsentSerialization={toMinifiedJsonObject:function(n){var e,t={},f,u,r,i;if(n){if(f=n.getGDPRConsentState(),f){t.gdpr={};for(u in f)f.hasOwnProperty(u)&&(r=f[u],t.gdpr[u]={},typeof r.Consented=="boolean"&&(t.gdpr[u].c=r.Consented),typeof r.Timestamp=="number"&&(t.gdpr[u].ts=r.Timestamp),typeof r.ConsentDocument=="string"&&(t.gdpr[u].d=r.ConsentDocument),typeof r.Location=="string"&&(t.gdpr[u].l=r.Location),typeof r.HardwareId=="string"&&(t.gdpr[u].h=r.HardwareId))}i=n.getCCPAConsentState();i&&(t.ccpa=(e={},e[l]={},e),typeof i.Consented=="boolean"&&(t.ccpa[l].c=i.Consented),typeof i.Timestamp=="number"&&(t.ccpa[l].ts=i.Timestamp),typeof i.ConsentDocument=="string"&&(t.ccpa[l].d=i.ConsentDocument),typeof i.Location=="string"&&(t.ccpa[l].l=i.Location),typeof i.HardwareId=="string"&&(t.ccpa[l].h=i.HardwareId))}return t},fromMinifiedJsonObject:function(n){var r=t.createConsentState(),i,u,f;if(n.gdpr)for(i in n.gdpr)n.gdpr.hasOwnProperty(i)&&(u=t.createPrivacyConsent(n.gdpr[i].c,n.gdpr[i].ts,n.gdpr[i].d,n.gdpr[i].l,n.gdpr[i].h),r.addGDPRConsentState(i,u));return n.ccpa&&n.ccpa.hasOwnProperty(l)&&(f=t.createPrivacyConsent(n.ccpa[l].c,n.ccpa[l].ts,n.ccpa[l].d,n.ccpa[l].l,n.ccpa[l].h),r.setCCPAConsentState(f)),r}};this.createConsentState=function(i){function e(n){if(typeof n!="string")return null;var t=n.trim();return t.length?t.toLowerCase():null}function s(i,u){var o=e(i),f;return o?k(u)?(f=t.createPrivacyConsent(u.Consented,u.Timestamp,u.ConsentDocument,u.Location,u.HardwareId),f&&(r[o]=f),this):(n.Logger.error("Invoked with a bad or empty consent object."),this):(n.Logger.error("Purpose must be a string."),this)}function h(n){if(n){if(k(n)){r={};for(var t in n)n.hasOwnProperty(t)&&this.addGDPRConsentState(t,n[t])}}else r={};return this}function c(n){var t=e(n);return t?(delete r[t],this):this}function a(){return Object.assign({},r)}function v(i){if(!k(i))return n.Logger.error("Invoked with a bad or empty CCPA consent object."),this;var r=t.createPrivacyConsent(i.Consented,i.Timestamp,i.ConsentDocument,i.Location,i.HardwareId);return r&&(f[l]=r),this}function y(){return f[l]}function o(){return delete f[l],this}function p(){return n.Logger.warning("removeCCPAState is deprecated and will be removed in a future release; use removeCCPAConsentState instead"),o()}var r={},f={},u;return i?(u=t.createConsentState(),u.setGDPRConsentState(i.getGDPRConsentState()),u.setCCPAConsentState(i.getCCPAConsentState()),u):{setGDPRConsentState:h,addGDPRConsentState:s,setCCPAConsentState:v,getCCPAConsentState:y,getGDPRConsentState:a,removeGDPRConsentState:c,removeCCPAState:p,removeCCPAConsentState:o}}}function no(){this.getSDKConfiguration=function(n,t,i,r){var u,o,f,e;try{o=function(){f.readyState===4&&(f.status===200?(t=r._Helpers.extend({},t,JSON.parse(f.responseText)),i(n,t,r),r.Logger.verbose("Successfully received configuration from server")):(i(n,t,r),r.Logger.verbose("Issue with receiving configuration from server, received HTTP Code of "+f.status)))};f=r._Helpers.createXHR(o);u="https://"+r._Store.SDKConfig.configUrl+n+"/config?env=";u=t.isDevelopmentMode?u+"1":u+"0";e=t.dataPlan;e&&(e.planId&&(u=u+"&plan_id="+e.planId||""),e.planVersion&&(u=u+"&plan_version="+e.planVersion||""));f&&(f.open("get",u),f.send(null))}catch(s){i(n,t,r);r.Logger.error("Error getting forwarder configuration from mParticle servers.")}}}function to(n){this.sendAliasRequest=function(t,i){var r,f=function(){var t,u;if(r.readyState===4){if(n.Logger.verbose("Received "+r.statusText+" from server"),r.status!==200&&r.status!==202&&r.responseText&&(t=JSON.parse(r.responseText),t.hasOwnProperty("message"))){u=t.message;n._Helpers.invokeAliasCallback(i,r.status,u);return}n._Helpers.invokeAliasCallback(i,r.status)}};if(n.Logger.verbose(gt.InformationMessages.SendAliasHttp),r=n._Helpers.createXHR(f),r)try{r.open("post",n._Helpers.createServiceUrl(n._Store.SDKConfig.aliasUrl,n._Store.devToken)+"/Alias");r.send(JSON.stringify(t))}catch(u){n._Helpers.invokeAliasCallback(i,ui.noHttpCoverage,u);n.Logger.error("Error sending alias request to mParticle servers. "+u)}};this.sendIdentityRequest=function(t,i,r,u,f,e){var o,s,c=function(){o.readyState===4&&(n.Logger.verbose("Received "+o.statusText+" from server"),f(o,s,r,u,i))};if(n.Logger.verbose(gt.InformationMessages.SendIdentityBegin),!t){n.Logger.error(gt.ErrorMessages.APIRequestEmpty);return}if(n.Logger.verbose(gt.InformationMessages.SendIdentityHttp),o=n._Helpers.createXHR(c),o)try{n._Store.identityCallInFlight?n._Helpers.invokeCallback(r,ui.activeIdentityRequest,"There is currently an Identity request processing. Please wait for this to return before requesting again"):(s=e||null,i==="modify"?o.open("post",n._Helpers.createServiceUrl(n._Store.SDKConfig.identityUrl)+e+"/"+i):o.open("post",n._Helpers.createServiceUrl(n._Store.SDKConfig.identityUrl)+i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("x-mp-key",n._Store.devToken),n._Store.identityCallInFlight=!0,o.send(JSON.stringify(t)))}catch(h){n._Store.identityCallInFlight=!1;n._Helpers.invokeCallback(r,ui.noHttpCoverage,h);n.Logger.error("Error sending identity request to servers with status code "+o.status+" - "+h)}}}function lr(i){var r=this;this._instanceName=i;this._NativeSdkHelpers=new ee(this);this._SessionManager=new se(this);this._Persistence=new ve(this);this._Helpers=new fe(this);this._Events=new ye(this);this._CookieSyncManager=new oe(this);this._ServerModel=new sr(this);this._Ecommerce=new he(this);this._ForwardingStatsUploader=new ke(this);this._Consent=new ge(this);this._IdentityAPIClient=new to(this);this._preInit={readyQueue:[],integrationDelays:{},forwarderConstructors:[]};this.IdentityType=n.IdentityType;this.EventType=n.EventType;this.CommerceEventType=n.CommerceEventType;this.PromotionType=n.PromotionActionType;this.ProductActionType=n.ProductActionType;this._Identity=new de(this);this.Identity=this._Identity.IdentityAPI;this.generateHash=this._Helpers.generateHash;this.getDeviceId=this._Persistence.getDeviceId;typeof window!="undefined"&&window.mParticle&&window.mParticle.config&&window.mParticle.config.hasOwnProperty("rq")&&(this._preInit.readyQueue=window.mParticle.config.rq);this.init=function(n,t){if(t||console.warn("You did not pass a config object to init(). mParticle will not initialize properly"),ro(this,n,t),t)!t.hasOwnProperty("requestConfig")||t.requestConfig?(new no).getSDKConfiguration(n,t,ar,this):ar(n,t,this);else{console.error("No config available on the window, please pass a config object to mParticle.init()");return}};this.setLogLevel=function(n){r.Logger.setLogLevel(n)};this.reset=function(n){try{n._Persistence.resetPersistence();n._Store&&delete n._Store}catch(t){console.error("Cannot reset mParticle",t)}};this._resetForTests=function(n,t,i){i._Store&&delete i._Store;i._Store=new fr(n,i);i._Store.isLocalStorageAvailable=i._Persistence.determineLocalStorageAvailability(window.localStorage);i._Events.stopTracking();t||i._Persistence.resetPersistence();i._Persistence.forwardingStatsBatches.uploadsTable={};i._Persistence.forwardingStatsBatches.forwardingStatsEventQueue=[];i._preInit={readyQueue:[],pixelConfigurations:[],integrationDelays:{},forwarderConstructors:[],isDevelopmentMode:!1}};this.ready=function(n){r.isInitialized()&&typeof n=="function"?n():r._preInit.readyQueue.push(n)};this.getEnvironment=function(){return r._Store.SDKConfig.isDevelopmentMode?n.Environment.Development:n.Environment.Production};this.getVersion=function(){return t.sdkVersion};this.setAppVersion=function(n){var t=v(function(){r.setAppVersion(n)},r);t||(r._Store.SDKConfig.appVersion=n,r._Persistence.update())};this.setDeviceId=function(n){var t=v(function(){r.setDeviceId(n)},r);t||this._Persistence.setDeviceId(n)};this.isInitialized=function(){return r._Store?r._Store.isInitialized:!1};this.getAppName=function(){return r._Store.SDKConfig.appName};this.setAppName=function(n){var t=v(function(){r.setAppName(n)},r);t||(r._Store.SDKConfig.appName=n)};this.getAppVersion=function(){return r._Store.SDKConfig.appVersion};this.stopTrackingLocation=function(){r._SessionManager.resetSessionTimer();r._Events.stopTracking()};this.startTrackingLocation=function(n){r._Helpers.Validators.isFunction(n)||r.Logger.warning("Warning: Location tracking is triggered, but not including a callback into the `startTrackingLocation` may result in events logged too quickly and not being associated with a location.");r._SessionManager.resetSessionTimer();r._Events.startTracking(n)};this.setPosition=function(n,t){var i=v(function(){r.setPosition(n,t)},r);i||(r._SessionManager.resetSessionTimer(),typeof n=="number"&&typeof t=="number"?r._Store.currentPosition={lat:n,lng:t}:r.Logger.error("Position latitude and/or longitude must both be of type number"))};this.startNewSession=function(){r._SessionManager.startNewSession()};this.endSession=function(){r._SessionManager.endSession(!0)};this.logBaseEvent=function(t,i){var u=v(function(){r.logBaseEvent(t,i)},r);if(!u){if(r._SessionManager.resetSessionTimer(),typeof t.name!="string"){r.Logger.error(it.ErrorMessages.EventNameInvalidType);return}if(t.eventType||(t.eventType=n.EventType.Unknown),!r._Helpers.canLog()){r.Logger.error(it.ErrorMessages.LoggingDisabled);return}r._Events.logEvent(t,i)}};this.logEvent=function(t,i,u,f,e){var o=v(function(){r.logEvent(t,i,u,f,e)},r);if(!o){if(r._SessionManager.resetSessionTimer(),typeof t!="string"){r.Logger.error(it.ErrorMessages.EventNameInvalidType);return}if(i||(i=n.EventType.Unknown),!r._Helpers.isEventType(i)){r.Logger.error("Invalid event type: "+i+", must be one of: \n"+JSON.stringify(n.EventType));return}if(!r._Helpers.canLog()){r.Logger.error(it.ErrorMessages.LoggingDisabled);return}r._Events.logEvent({messageType:n.MessageType.PageEvent,name:t,data:u,eventType:i,customFlags:f},e)}};this.logError=function(t,i){var o=v(function(){r.logError(t,i)},r),u,f,e;if(!o&&(r._SessionManager.resetSessionTimer(),t)){if(typeof t=="string"&&(t={message:t}),u={m:t.message?t.message:t,s:"Error",t:t.stack||null},i){f=r._Helpers.sanitizeAttributes(i,u.m);for(e in f)u[e]=f[e]}r._Events.logEvent({messageType:n.MessageType.CrashReport,name:t.name?t.name:"Error",data:u,eventType:n.EventType.Other})}};this.logLink=function(n,t,i,u){r._Events.addEventHandler("click",n,t,u,i)};this.logForm=function(n,t,i,u){r._Events.addEventHandler("submit",n,t,u,i)};this.logPageView=function(t,i,u,f){var e=v(function(){r.logPageView(t,i,u,f)},r);if(!e){if(r._SessionManager.resetSessionTimer(),r._Helpers.canLog()){if(r._Helpers.Validators.isStringOrNumber(t)||(t="PageView"),i){if(!r._Helpers.isObject(i)){r.Logger.error("The attributes argument must be an object. A "+a(i)+" was entered. Please correct and retry.");return}}else i={hostname:window.location.hostname,title:window.document.title};if(u&&!r._Helpers.isObject(u)){r.Logger.error("The customFlags argument must be an object. A "+a(u)+" was entered. Please correct and retry.");return}}r._Events.logEvent({messageType:n.MessageType.PageView,name:t,data:i,eventType:n.EventType.Unknown,customFlags:u},f)}};this.upload=function(){r._Helpers.canLog()&&(r._Store.webviewBridgeEnabled?r._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.Upload):r._APIClient.uploader.prepareAndUpload(!1,!1))};this.Consent={createCCPAConsent:r._Consent.createPrivacyConsent,createGDPRConsent:r._Consent.createPrivacyConsent,createConsentState:r._Consent.createConsentState};this.eCommerce={Cart:{add:function(n,t){r.Logger.warning("Deprecated function eCommerce.Cart.add() will be removed in future releases");var i,u=r.Identity.getCurrentUser();u&&(i=u.getMPID());r._Identity.mParticleUserCart(i).add(n,t)},remove:function(n,t){r.Logger.warning("Deprecated function eCommerce.Cart.remove() will be removed in future releases");var i,u=r.Identity.getCurrentUser();u&&(i=u.getMPID());r._Identity.mParticleUserCart(i).remove(n,t)},clear:function(){r.Logger.warning("Deprecated function eCommerce.Cart.clear() will be removed in future releases");var n,t=r.Identity.getCurrentUser();t&&(n=t.getMPID());r._Identity.mParticleUserCart(n).clear()}},setCurrencyCode:function(n){var t=v(function(){r.eCommerce.setCurrencyCode(n)},r);if(!t){if(typeof n!="string"){r.Logger.error("Code must be a string");return}r._SessionManager.resetSessionTimer();r._Store.currencyCode=n}},createProduct:function(n,t,i,u,f,e,o,s,h,c){return r._Ecommerce.createProduct(n,t,i,u,f,e,o,s,h,c)},createPromotion:function(n,t,i,u){return r._Ecommerce.createPromotion(n,t,i,u)},createImpression:function(n,t){return r._Ecommerce.createImpression(n,t)},createTransactionAttributes:function(n,t,i,u,f,e){return r._Ecommerce.createTransactionAttributes(n,t,i,u,f,e)},logCheckout:function(n,t,i,u){if(r.Logger.warning("mParticle.logCheckout is deprecated, please use mParticle.logProductAction instead"),!r._Store.isInitialized){r.ready(function(){r.eCommerce.logCheckout(n,t,i,u)});return}r._SessionManager.resetSessionTimer();r._Events.logCheckoutEvent(n,t,i,u)},logProductAction:function(n,t,i,u,f,e){var o=v(function(){r.eCommerce.logProductAction(n,t,i,u,f,e)},r);o||(r._SessionManager.resetSessionTimer(),r._Events.logProductActionEvent(n,t,i,u,f,e))},logPurchase:function(n,t,i,u,f){if(r.Logger.warning("mParticle.logPurchase is deprecated, please use mParticle.logProductAction instead"),!r._Store.isInitialized){r.ready(function(){r.eCommerce.logPurchase(n,t,i,u,f)});return}if(!n||!t){r.Logger.error(it.ErrorMessages.BadLogPurchase);return}r._SessionManager.resetSessionTimer();r._Events.logPurchaseEvent(n,t,u,f)},logPromotion:function(n,t,i,u,f){var e=v(function(){r.eCommerce.logPromotion(n,t,i,u,f)},r);e||(r._SessionManager.resetSessionTimer(),r._Events.logPromotionEvent(n,t,i,u,f))},logImpression:function(n,t,i,u){var f=v(function(){r.eCommerce.logImpression(n,t,i,u)},r);f||(r._SessionManager.resetSessionTimer(),r._Events.logImpressionEvent(n,t,i,u))},logRefund:function(n,t,i,u,f){if(r.Logger.warning("mParticle.logRefund is deprecated, please use mParticle.logProductAction instead"),!r._Store.isInitialized){r.ready(function(){r.eCommerce.logRefund(n,t,i,u,f)});return}r._SessionManager.resetSessionTimer();r._Events.logRefundEvent(n,t,u,f)},expandCommerceEvent:function(n){return r._Ecommerce.expandCommerceEvent(n)}};this.setSessionAttribute=function(n,i){var f=v(function(){r.setSessionAttribute(n,i)},r),u;if(!f&&r._Helpers.canLog()){if(!r._Helpers.Validators.isValidAttributeValue(i)){r.Logger.error(it.ErrorMessages.BadAttribute);return}if(!r._Helpers.Validators.isValidKeyValue(n)){r.Logger.error(it.ErrorMessages.BadKey);return}r._Store.webviewBridgeEnabled?r._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.SetSessionAttribute,JSON.stringify({key:n,value:i})):(u=r._Helpers.findKeyInObject(r._Store.sessionAttributes,n),u&&(n=u),r._Store.sessionAttributes[n]=i,r._Persistence.update(),r._Forwarders.applyToForwarders("setSessionAttribute",[n,i]))}};this.setOptOut=function(n){var t=v(function(){r.setOptOut(n)},r);t||(r._SessionManager.resetSessionTimer(),r._Store.isEnabled=!n,r._Events.logOptOut(),r._Persistence.update(),r._Store.activeForwarders.length&&r._Store.activeForwarders.forEach(function(t){if(t.setOptOut){var i=t.setOptOut(n);i&&r.Logger.verbose(i)}}))};this.setIntegrationAttribute=function(n,t){var u=v(function(){r.setIntegrationAttribute(n,t)},r),i;if(!u){if(typeof n!="number"){r.Logger.error("integrationId must be a number");return}if(t===null)r._Store.integrationAttributes[n]={};else if(r._Helpers.isObject(t))if(Object.keys(t).length===0)r._Store.integrationAttributes[n]={};else for(i in t)if(typeof i=="string")if(typeof t[i]=="string")r._Helpers.isObject(r._Store.integrationAttributes[n])?r._Store.integrationAttributes[n][i]=t[i]:(r._Store.integrationAttributes[n]={},r._Store.integrationAttributes[n][i]=t[i]);else{r.Logger.error("Values for integration attributes must be strings. You entered a "+a(t[i]));continue}else{r.Logger.error("Keys must be strings, you entered a "+a(i));continue}else{r.Logger.error("Attrs must be an object with keys and values. You entered a "+a(t));return}r._Persistence.update()}};this.getIntegrationAttributes=function(n){return r._Store.integrationAttributes[n]?r._Store.integrationAttributes[n]:{}};this.addForwarder=function(n){r._preInit.forwarderConstructors.push(n)};this.configurePixel=function(n){r._Forwarders.configurePixel(n)};this._getActiveForwarders=function(){return r._Store.activeForwarders};this._getIntegrationDelays=function(){return r._preInit.integrationDelays};this._setIntegrationDelay=function(n,t){var i,u;(r._preInit.integrationDelays[n]=t,t!==!0)&&(i=Object.keys(r._preInit.integrationDelays),i.length!==0)&&(u=i.some(function(n){return r._preInit.integrationDelays[n]===!0}),u||r._APIClient.processQueuedEvents())};this._setWrapperSDKInfo=function(n,t){var i=v(function(){r._setWrapperSDKInfo(n,t)},r);i||r._Store.wrapperSDKInfo!==undefined&&r._Store.wrapperSDKInfo.isInfoSet||(r._Store.wrapperSDKInfo={name:n,version:t,isInfoSet:!0})}}function ar(n,i,r){var s=io(i,r),u,o,f,e;if(r._APIClient=new ue(r,s),r._Forwarders=new pe(r,s),i.flags&&i.flags.hasOwnProperty(t.FeatureFlags.EventBatchingIntervalMillis)&&(r._Store.SDKConfig.flags[t.FeatureFlags.EventBatchingIntervalMillis]=i.flags[t.FeatureFlags.EventBatchingIntervalMillis]),r._Store.storageName=r._Helpers.createMainStorageName(i.workspaceToken),r._Store.prodStorageName=r._Helpers.createProductStorageName(i.workspaceToken),i.hasOwnProperty("workspaceToken")?r._Store.SDKConfig.workspaceToken=i.workspaceToken:r.Logger.warning("You should have a workspaceToken on your config object for security purposes."),i.hasOwnProperty("requiredWebviewBridgeName")?r._Store.SDKConfig.requiredWebviewBridgeName=i.requiredWebviewBridgeName:i.hasOwnProperty("workspaceToken")&&(r._Store.SDKConfig.requiredWebviewBridgeName=i.workspaceToken),r._Store.webviewBridgeEnabled=r._NativeSdkHelpers.isWebviewEnabled(r._Store.SDKConfig.requiredWebviewBridgeName,r._Store.SDKConfig.minWebviewBridgeVersion),r._Store.configurationLoaded=!0,r._Store.webviewBridgeEnabled||r._Persistence.initializeStorage(),r._Store.webviewBridgeEnabled)r._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.SetSessionAttribute,JSON.stringify({key:"$src_env",value:"webview"})),n&&r._NativeSdkHelpers.sendToNative(t.NativeSdkPaths.SetSessionAttribute,JSON.stringify({key:"$src_key",value:n}));else{if(r._Helpers.isObject(r._Store.SDKConfig.identifyRequest)&&r._Helpers.isObject(r._Store.SDKConfig.identifyRequest.userIdentities)&&Object.keys(r._Store.SDKConfig.identifyRequest.userIdentities).length===0||!r._Store.SDKConfig.identifyRequest){if(o={},u=r.Identity.getCurrentUser(),u){f=u.getUserIdentities().userIdentities||{};for(e in f)f.hasOwnProperty(e)&&(o[e]=f[e])}r._Store.SDKConfig.identifyRequest={userIdentities:o}}u=r.Identity.getCurrentUser();r._Helpers.getFeatureFlag(t.FeatureFlags.ReportBatching)&&r._ForwardingStatsUploader.startForwardingStatsTimer();r._Forwarders.processForwarders(i,r._APIClient.prepareForwardingStats);r._Forwarders.processPixelConfigs(i);r._SessionManager.initialize();r._Events.logAST();!r._Store.identifyCalled&&r._Store.SDKConfig.identityCallback&&u&&u.getMPID()&&r._Store.SDKConfig.identityCallback({httpCode:cr.activeSession,getUser:function(){return r._Identity.mParticleUser(u.getMPID())},getPreviousUser:function(){var t=r.Identity.getUsers(),n=t.shift();return n&&u&&n.getMPID()===u.getMPID()&&(n=t.shift()),n||null},body:{mpid:u.getMPID(),is_logged_in:r._Store.isLoggedIn,matched_identities:u.getUserIdentities().userIdentities,context:null,is_ephemeral:!1}})}r._Store.isInitialized=!0;r._preInit.readyQueue&&r._preInit.readyQueue.length&&(r._preInit.readyQueue.forEach(function(n){r._Helpers.Validators.isFunction(n)?n():Array.isArray(n)&&uo(n,r)}),r._preInit.readyQueue=[]);r._Store.isFirstRun&&(r._Store.isFirstRun=!1)}function io(n,t){var f,i,u,r;return n.dataPlanOptions&&(t.Logger.verbose("Customer provided data plan found"),r=n.dataPlanOptions,i={document:{dtpn:{vers:r.dataPlanVersion,blok:{ev:r.blockEvents,ea:r.blockEventAttributes,ua:r.blockUserAttributes,id:r.blockUserIdentities}}}}),i||(n.dataPlan&&n.dataPlan.document?n.dataPlan.document.error_message?u=n.dataPlan.document.error_message:(t.Logger.verbose("Data plan found from mParticle.js"),i=n.dataPlan):n.dataPlanResult&&(n.dataPlanResult.error_message?u=n.dataPlanResult.error_message:(t.Logger.verbose("Data plan found from /config"),i={document:n.dataPlanResult}))),u&&t.Logger.error(u),i&&(f=new hr(i,t)),f}function ro(n,t,i){n.Logger=new le(i);n._Store=new fr(i,n);window.mParticle.Store=n._Store;n._Store.devToken=t||null;n.Logger.verbose(it.InformationMessages.StartingInitialization);try{n._Store.isLocalStorageAvailable=n._Persistence.determineLocalStorageAvailability(window.localStorage)}catch(r){n.Logger.warning("localStorage is not available, using cookies if available");n._Store.isLocalStorageAvailable=!1}}function uo(n,t){var i=n,e=i.splice(0,1)[0],f,r,u,o;if(mParticle[i[0]])mParticle[e].apply(this,i);else{f=e.split(".");try{for(r=mParticle,u=0;u<f.length;u++)o=f[u],r=r[o];r.apply(this,i)}catch(s){t.Logger.verbose("Unable to compute proper mParticle function "+s)}}}function v(n,t){return t.isInitialized()?!1:(t.ready(function(){n()}),!0)}function fo(){var i=this;this.Store={};this._instances={};this.IdentityType=n.IdentityType;this.EventType=n.EventType;this.CommerceEventType=n.CommerceEventType;this.PromotionType=n.PromotionActionType;this.ProductActionType=n.ProductActionType;this.MPSideloadedKit=wr;typeof window!="undefined"&&(this.isIOS=window.mParticle&&window.mParticle.isIOS?window.mParticle.isIOS:!1,this.config=window.mParticle&&window.mParticle.config?window.mParticle.config:{});this.init=function(n,r,u){!r&&window.mParticle&&window.mParticle.config&&(console.warn("You did not pass a config object to mParticle.init(). Attempting to use the window.mParticle.config if it exists. Please note that in a future release, this may not work and mParticle will not initialize properly"),r=window.mParticle?window.mParticle.config:{});u=(!u||u.length===0?t.DefaultInstance:u).toLowerCase();var f=i._instances[u];f===undefined&&(f=new lr(n),i._instances[u]=f);f.init(n,r,u)};this.getInstance=function(n){var r;return n?(r=i._instances[n.toLowerCase()],!r)?(console.log("You tried to initialize an instance named "+n+". This instance does not exist. Check your instance name or initialize a new instance with this name before calling it."),null):r:(n=t.DefaultInstance,r=i._instances[n],r||(r=new lr(n),i._instances[t.DefaultInstance]=r),r)};this.getDeviceId=function(){return i.getInstance().getDeviceId()};this.setDeviceId=function(n){return i.getInstance().setDeviceId(n)};this.isInitialized=function(){return i.getInstance().isInitialized()};this.startNewSession=function(){i.getInstance().startNewSession()};this.endSession=function(){i.getInstance().endSession()};this.setLogLevel=function(n){i.getInstance().setLogLevel(n)};this.ready=function(n){i.getInstance().ready(n)};this.setAppVersion=function(n){i.getInstance().setAppVersion(n)};this.getAppName=function(){return i.getInstance().getAppName()};this.setAppName=function(n){i.getInstance().setAppName(n)};this.getAppVersion=function(){return i.getInstance().getAppVersion()};this.getEnvironment=function(){return i.getInstance().getEnvironment()};this.stopTrackingLocation=function(){i.getInstance().stopTrackingLocation()};this.startTrackingLocation=function(n){i.getInstance().startTrackingLocation(n)};this.setPosition=function(n,t){i.getInstance().setPosition(n,t)};this.startNewSession=function(){i.getInstance().startNewSession()};this.endSession=function(){i.getInstance().endSession()};this.logBaseEvent=function(n,t){i.getInstance().logBaseEvent(n,t)};this.logEvent=function(n,t,r,u,f){i.getInstance().logEvent(n,t,r,u,f)};this.logError=function(n,t){i.getInstance().logError(n,t)};this.logLink=function(n,t,r,u){i.getInstance().logLink(n,t,r,u)};this.logForm=function(n,t,r,u){i.getInstance().logForm(n,t,r,u)};this.logPageView=function(n,t,r,u){i.getInstance().logPageView(n,t,r,u)};this.upload=function(){i.getInstance().upload()};this.eCommerce={Cart:{add:function(n,t){i.getInstance().eCommerce.Cart.add(n,t)},remove:function(n,t){i.getInstance().eCommerce.Cart.remove(n,t)},clear:function(){i.getInstance().eCommerce.Cart.clear()}},setCurrencyCode:function(n){i.getInstance().eCommerce.setCurrencyCode(n)},createProduct:function(n,t,r,u,f,e,o,s,h,c){return i.getInstance().eCommerce.createProduct(n,t,r,u,f,e,o,s,h,c)},createPromotion:function(n,t,r,u){return i.getInstance().eCommerce.createPromotion(n,t,r,u)},createImpression:function(n,t){return i.getInstance().eCommerce.createImpression(n,t)},createTransactionAttributes:function(n,t,r,u,f,e){return i.getInstance().eCommerce.createTransactionAttributes(n,t,r,u,f,e)},logCheckout:function(n,t,r,u){i.getInstance().eCommerce.logCheckout(n,t,r,u)},logProductAction:function(n,t,r,u,f,e){i.getInstance().eCommerce.logProductAction(n,t,r,u,f,e)},logPurchase:function(n,t,r,u,f){i.getInstance().eCommerce.logPurchase(n,t,r,u,f)},logPromotion:function(n,t,r,u,f){i.getInstance().eCommerce.logPromotion(n,t,r,u,f)},logImpression:function(n,t,r,u){i.getInstance().eCommerce.logImpression(n,t,r,u)},logRefund:function(n,t,r,u,f){i.getInstance().eCommerce.logRefund(n,t,r,u,f)},expandCommerceEvent:function(n){return i.getInstance().eCommerce.expandCommerceEvent(n)}};this.setSessionAttribute=function(n,t){i.getInstance().setSessionAttribute(n,t)};this.setOptOut=function(n){i.getInstance().setOptOut(n)};this.setIntegrationAttribute=function(n,t){i.getInstance().setIntegrationAttribute(n,t)};this.getIntegrationAttributes=function(n){return i.getInstance().getIntegrationAttributes(n)};this.Identity={HTTPCodes:i.getInstance().Identity.HTTPCodes,aliasUsers:function(n,t){i.getInstance().Identity.aliasUsers(n,t)},createAliasRequest:function(n,t){return i.getInstance().Identity.createAliasRequest(n,t)},getCurrentUser:function(){return i.getInstance().Identity.getCurrentUser()},getUser:function(n){return i.getInstance().Identity.getUser(n)},getUsers:function(){return i.getInstance().Identity.getUsers()},identify:function(n,t){i.getInstance().Identity.identify(n,t)},login:function(n,t){i.getInstance().Identity.login(n,t)},logout:function(n,t){i.getInstance().Identity.logout(n,t)},modify:function(n,t){i.getInstance().Identity.modify(n,t)}};this.sessionManager={getSession:function(){return i.getInstance()._SessionManager.getSession()}};this.Consent={createConsentState:function(){return i.getInstance().Consent.createConsentState()},createGDPRConsent:function(n,t,r,u,f){return i.getInstance().Consent.createGDPRConsent(n,t,r,u,f)},createCCPAConsent:function(n,t,r,u,f){return i.getInstance().Consent.createGDPRConsent(n,t,r,u,f)}};this.reset=function(){i.getInstance().reset(i.getInstance())};this._resetForTests=function(n,t){typeof t=="boolean"?i.getInstance()._resetForTests(n,t,i.getInstance()):i.getInstance()._resetForTests(n,!1,i.getInstance())};this.configurePixel=function(n){i.getInstance().configurePixel(n)};this._setIntegrationDelay=function(n,t){i.getInstance()._setIntegrationDelay(n,t)};this._getIntegrationDelays=function(){return i.getInstance()._getIntegrationDelays()};this.getVersion=function(){return i.getInstance().getVersion()};this.generateHash=function(n){return i.getInstance().generateHash(n)};this.addForwarder=function(n){i.getInstance().addForwarder(n)};this._getActiveForwarders=function(){return i.getInstance()._getActiveForwarders()};this._setWrapperSDKInfo=function(n,t){i.getInstance()._setWrapperSDKInfo(n,t)}}var b={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(n){try{if(window.btoa&&window.atob)return window.btoa(unescape(encodeURIComponent(n)))}catch(t){console.error("Error encoding cookie values into Base64:"+t)}return this._encode(n)},_encode:function(n){var f="",e,t,i,s,h,o,r,u=0;for(n=yi.encode(n);u<n.length;)e=n.charCodeAt(u++),t=n.charCodeAt(u++),i=n.charCodeAt(u++),s=e>>2,h=(e&3)<<4|t>>4,o=(t&15)<<2|i>>6,r=i&63,isNaN(t)?o=r=64:isNaN(i)&&(r=64),f=f+b._keyStr.charAt(s)+b._keyStr.charAt(h)+b._keyStr.charAt(o)+b._keyStr.charAt(r);return f},decode:function(n){try{if(window.btoa&&window.atob)return decodeURIComponent(escape(window.atob(n)))}catch(t){}return b._decode(n)},_decode:function(n){var t="",e,o,s,h,u,r,f,i=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<n.length;)h=b._keyStr.indexOf(n.charAt(i++)),u=b._keyStr.indexOf(n.charAt(i++)),r=b._keyStr.indexOf(n.charAt(i++)),f=b._keyStr.indexOf(n.charAt(i++)),e=h<<2|u>>4,o=(u&15)<<4|r>>2,s=(r&3)<<6|f,t=t+String.fromCharCode(e),r!==64&&(t=t+String.fromCharCode(o)),f!==64&&(t=t+String.fromCharCode(s));return yi.decode(t)}},yi={encode:function(n){for(var t,i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(t&63|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(t&63|128));return i},decode:function(n){for(var r="",t=0,i=0,u=0,f=0;t<n.length;)i=n.charCodeAt(t),i<128?(r+=String.fromCharCode(i),t++):i>191&&i<224?(u=n.charCodeAt(t+1),r+=String.fromCharCode((i&31)<<6|u&63),t+=2):(u=n.charCodeAt(t+1),f=n.charCodeAt(t+2),r+=String.fromCharCode((i&15)<<12|(u&63)<<6|f&63),t+=3);return r}},ct={forEach:function(n,t){var u,i,r,f,e;if(this==null)throw new TypeError(" this is null or not defined");if(r=Object(this),f=r.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(u=t),i=0;i<f;)i in r&&(e=r[i],n.call(u,e,i,r)),i++},map:function(n,t){var e,u,i,r,f,o,s;if(this===null)throw new TypeError(" this is null or not defined");if(r=Object(this),f=r.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(e=t),u=new Array(f),i=0;i<f;)i in r&&(o=r[i],s=n.call(e,o,i,r),u[i]=s),i++;return u},filter:function(n){var i,f,r,e,t,u;if(this===void 0||this===null)throw new TypeError;if(i=Object(this),f=i.length>>>0,typeof n!="function")throw new TypeError;for(r=[],e=arguments.length>=2?arguments[1]:void 0,t=0;t<f;t++)t in i&&(u=i[t],n.call(e,u,t,i)&&r.push(u));return r},isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"},Base64:b},lt,ni={SessionStart:1,SessionEnd:2,PageView:3,PageEvent:4,CrashReport:5,OptOut:6,AppStateTransition:10,Profile:14,Commerce:16,Media:20,UserAttributeChange:17,UserIdentityChange:18},dr=(lt={},ei(lt,ni.Commerce,1),ei(lt,ni.UserAttributeChange,1),ei(lt,ni.UserIdentityChange,1),lt),nt={Unknown:0,Navigation:1,Location:2,Search:3,Transaction:4,UserContent:5,UserPreference:6,Social:7,Other:8,Media:9,getName:function(n){switch(n){case nt.Unknown:return"Unknown";case nt.Navigation:return"Navigation";case nt.Location:return"Location";case nt.Search:return"Search";case nt.Transaction:return"Transaction";case nt.UserContent:return"User Content";case nt.UserPreference:return"User Preference";case nt.Social:return"Social";case p.ProductAddToCart:return"Product Added to Cart";case p.ProductAddToWishlist:return"Product Added to Wishlist";case p.ProductCheckout:return"Product Checkout";case p.ProductCheckoutOption:return"Product Checkout Options";case p.ProductClick:return"Product Click";case p.ProductImpression:return"Product Impression";case p.ProductPurchase:return"Product Purchased";case p.ProductRefund:return"Product Refunded";case p.ProductRemoveFromCart:return"Product Removed From Cart";case p.ProductRemoveFromWishlist:return"Product Removed from Wishlist";case p.ProductViewDetail:return"Product View Details";case p.PromotionClick:return"Promotion Click";case p.PromotionView:return"Promotion View";default:return"Other"}}},p={ProductAddToCart:10,ProductRemoveFromCart:11,ProductCheckout:12,ProductCheckoutOption:13,ProductClick:14,ProductViewDetail:15,ProductPurchase:16,ProductRefund:17,PromotionView:18,PromotionClick:19,ProductAddToWishlist:20,ProductRemoveFromWishlist:21,ProductImpression:22},r={Other:0,CustomerId:1,Facebook:2,Twitter:3,Google:4,Microsoft:5,Yahoo:6,Email:7,FacebookCustomAudienceId:9,Other2:10,Other3:11,Other4:12,Other5:13,Other6:14,Other7:15,Other8:16,Other9:17,Other10:18,MobileNumber:19,PhoneNumber2:20,PhoneNumber3:21},e,rt,tt,w,o,pi,i,yt,ur,st,bt,ot,dt,or,s,c,l,u,hr,ui,gt,it,cr,f,vr,fi,yr,pr,wr,vi;r.isValid=function(n){if(typeof n=="number")for(var t in r)if(r.hasOwnProperty(t)&&r[t]===n)return!0;return!1};r.getName=function(n){switch(n){case window.mParticle.IdentityType.CustomerId:return"Customer ID";case window.mParticle.IdentityType.Facebook:return"Facebook ID";case window.mParticle.IdentityType.Twitter:return"Twitter ID";case window.mParticle.IdentityType.Google:return"Google ID";case window.mParticle.IdentityType.Microsoft:return"Microsoft ID";case window.mParticle.IdentityType.Yahoo:return"Yahoo ID";case window.mParticle.IdentityType.Email:return"Email";case window.mParticle.IdentityType.FacebookCustomAudienceId:return"Facebook App User ID";default:return"Other ID"}};r.getIdentityType=function(n){switch(n){case"other":return r.Other;case"customerid":return r.CustomerId;case"facebook":return r.Facebook;case"twitter":return r.Twitter;case"google":return r.Google;case"microsoft":return r.Microsoft;case"yahoo":return r.Yahoo;case"email":return r.Email;case"facebookcustomaudienceid":return r.FacebookCustomAudienceId;case"other2":return r.Other2;case"other3":return r.Other3;case"other4":return r.Other4;case"other5":return r.Other5;case"other6":return r.Other6;case"other7":return r.Other7;case"other8":return r.Other8;case"other9":return r.Other9;case"other10":return r.Other10;case"mobile_number":return r.MobileNumber;case"phone_number_2":return r.PhoneNumber2;case"phone_number_3":return r.PhoneNumber3;default:return!1}};r.getIdentityName=function(n){switch(n){case r.Other:return"other";case r.CustomerId:return"customerid";case r.Facebook:return"facebook";case r.Twitter:return"twitter";case r.Google:return"google";case r.Microsoft:return"microsoft";case r.Yahoo:return"yahoo";case r.Email:return"email";case r.FacebookCustomAudienceId:return"facebookcustomaudienceid";case r.Other2:return"other2";case r.Other3:return"other3";case r.Other4:return"other4";case r.Other5:return"other5";case r.Other6:return"other6";case r.Other7:return"other7";case r.Other8:return"other8";case r.Other9:return"other9";case r.Other10:return"other10";case r.MobileNumber:return"mobile_number";case r.PhoneNumber2:return"phone_number_2";case r.PhoneNumber3:return"phone_number_3"}};e={Unknown:0,AddToCart:1,RemoveFromCart:2,Checkout:3,CheckoutOption:4,Click:5,ViewDetail:6,Purchase:7,Refund:8,AddToWishlist:9,RemoveFromWishlist:10};e.getName=function(n){switch(n){case e.AddToCart:return"Add to Cart";case e.RemoveFromCart:return"Remove from Cart";case e.Checkout:return"Checkout";case e.CheckoutOption:return"Checkout Option";case e.Click:return"Click";case e.ViewDetail:return"View Detail";case e.Purchase:return"Purchase";case e.Refund:return"Refund";case e.AddToWishlist:return"Add to Wishlist";case e.RemoveFromWishlist:return"Remove from Wishlist";default:return"Unknown"}};e.getExpansionName=function(n){switch(n){case e.AddToCart:return"add_to_cart";case e.RemoveFromCart:return"remove_from_cart";case e.Checkout:return"checkout";case e.CheckoutOption:return"checkout_option";case e.Click:return"click";case e.ViewDetail:return"view_detail";case e.Purchase:return"purchase";case e.Refund:return"refund";case e.AddToWishlist:return"add_to_wishlist";case e.RemoveFromWishlist:return"remove_from_wishlist";default:return"unknown"}};rt={Unknown:0,PromotionView:1,PromotionClick:2};rt.getName=function(n){switch(n){case rt.PromotionView:return"view";case rt.PromotionClick:return"click";default:return"unknown"}};rt.getExpansionName=function(n){switch(n){case rt.PromotionView:return"view";case rt.PromotionClick:return"click";default:return"unknown"}};var n={MessageType:ni,EventType:nt,CommerceEventType:p,IdentityType:r,ProfileMessageType:{Logout:3},ApplicationTransitionType:{AppInit:1},ProductActionType:e,PromotionActionType:rt,TriggerUploadType:dr,Environment:{Production:"production",Development:"development"}},t={sdkVersion:"2.23.2",sdkVendor:"mparticle",platform:"web",Messages:{ErrorMessages:{NoToken:"A token must be specified.",EventNameInvalidType:"Event name must be a valid string value.",EventDataInvalidType:"Event data must be a valid object hash.",LoggingDisabled:"Event logging is currently disabled.",CookieParseError:"Could not parse cookie",EventEmpty:"Event object is null or undefined, cancelling send",APIRequestEmpty:"APIRequest is null or undefined, cancelling send",NoEventType:"Event type must be specified.",TransactionIdRequired:"Transaction ID is required",TransactionRequired:"A transaction attributes object is required",PromotionIdRequired:"Promotion ID is required",BadAttribute:"Attribute value cannot be object or array",BadKey:"Key value cannot be object or array",BadLogPurchase:"Transaction attributes and a product are both required to log a purchase, https://docs.mparticle.com/?javascript#measuring-transactions"},InformationMessages:{CookieSearch:"Searching for cookie",CookieFound:"Cookie found, parsing values",CookieNotFound:"Cookies not found",CookieSet:"Setting cookie",CookieSync:"Performing cookie sync",SendBegin:"Starting to send event",SendIdentityBegin:"Starting to send event to identity server",SendWindowsPhone:"Sending event to Windows Phone container",SendIOS:"Calling iOS path: ",SendAndroid:"Calling Android JS interface method: ",SendHttp:"Sending event to mParticle HTTP service",SendAliasHttp:"Sending alias request to mParticle HTTP service",SendIdentityHttp:"Sending event to mParticle HTTP service",StartingNewSession:"Starting new Session",StartingLogEvent:"Starting to log event",StartingLogOptOut:"Starting to log user opt in/out",StartingEndSession:"Starting to end session",StartingInitialization:"Starting to initialize",StartingLogCommerceEvent:"Starting to log commerce event",StartingAliasRequest:"Starting to Alias MPIDs",LoadingConfig:"Loading configuration options",AbandonLogEvent:"Cannot log event, logging disabled or developer token not set",AbandonAliasUsers:"Cannot Alias Users, logging disabled or developer token not set",AbandonStartSession:"Cannot start session, logging disabled or developer token not set",AbandonEndSession:"Cannot end session, logging disabled or developer token not set",NoSessionToEnd:"Cannot end session, no active session found"},ValidationMessages:{ModifyIdentityRequestUserIdentitiesPresent:"identityRequests to modify require userIdentities to be present. Request not sent to server. Please fix and try again",IdentityRequesetInvalidKey:"There is an invalid key on your identityRequest object. It can only contain a `userIdentities` object and a `onUserAlias` function. Request not sent to server. Please fix and try again.",OnUserAliasType:"The onUserAlias value must be a function.",UserIdentities:"The userIdentities key must be an object with keys of identityTypes and values of strings. Request not sent to server. Please fix and try again.",UserIdentitiesInvalidKey:"There is an invalid identity key on your `userIdentities` object within the identityRequest. Request not sent to server. Please fix and try again.",UserIdentitiesInvalidValues:"All user identity values must be strings or null. Request not sent to server. Please fix and try again.",AliasMissingMpid:"Alias Request must contain both a destinationMpid and a sourceMpid",AliasNonUniqueMpid:"Alias Request's destinationMpid and sourceMpid must be unique",AliasMissingTime:"Alias Request must have both a startTime and an endTime",AliasStartBeforeEndTime:"Alias Request's endTime must be later than its startTime"}},NativeSdkPaths:{LogEvent:"logEvent",SetUserTag:"setUserTag",RemoveUserTag:"removeUserTag",SetUserAttribute:"setUserAttribute",RemoveUserAttribute:"removeUserAttribute",SetSessionAttribute:"setSessionAttribute",AddToCart:"addToCart",RemoveFromCart:"removeFromCart",ClearCart:"clearCart",LogOut:"logOut",SetUserAttributeList:"setUserAttributeList",RemoveAllUserAttributes:"removeAllUserAttributes",GetUserAttributesLists:"getUserAttributesLists",GetAllUserAttributes:"getAllUserAttributes",Identify:"identify",Logout:"logout",Login:"login",Modify:"modify",Alias:"aliasUsers",Upload:"upload"},StorageNames:{localStorageName:"mprtcl-api",localStorageNameV3:"mprtcl-v3",cookieName:"mprtcl-api",cookieNameV2:"mprtcl-v2",cookieNameV3:"mprtcl-v3",localStorageNameV4:"mprtcl-v4",localStorageProductsV4:"mprtcl-prodv4",cookieNameV4:"mprtcl-v4",currentStorageName:"mprtcl-v4",currentStorageProductsName:"mprtcl-prodv4"},DefaultConfig:{cookieDomain:null,cookieExpiration:365,logLevel:null,timeout:300,sessionTimeout:30,maxProducts:20,forwarderStatsTimeout:5e3,integrationDelayTimeout:5e3,maxCookieSize:3e3,aliasMaxWindow:90,uploadInterval:0},DefaultUrls:{v1SecureServiceUrl:"jssdks.mparticle.com/v1/JS/",v2SecureServiceUrl:"jssdks.mparticle.com/v2/JS/",v3SecureServiceUrl:"jssdks.mparticle.com/v3/JS/",configUrl:"jssdkcdns.mparticle.com/JS/v2/",identityUrl:"identity.mparticle.com/v1/",aliasUrl:"jssdks.mparticle.com/v1/identity/"},Base64CookieKeys:{csm:1,sa:1,ss:1,ua:1,ui:1,csd:1,ia:1,con:1},SDKv2NonMPIDCookieKeys:{gs:1,cu:1,l:1,globalSettings:1,currentUserMPID:1},HTTPCodes:{noHttpCoverage:-1,activeIdentityRequest:-2,activeSession:-3,validationIssue:-4,nativeIdentityRequest:-5,loggingDisabledOrMissingAPIKey:-6,tooManyRequests:429},FeatureFlags:{ReportBatching:"reportBatching",EventBatchingIntervalMillis:"eventBatchingIntervalMillis",OfflineStorage:"offlineStorage"},DefaultInstance:"default_instance",CCPAPurpose:"data_sale_opt_out"},oi=function(n,t){return oi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},oi(n,t)};tt=function(){return tt=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},tt.apply(this,arguments)};typeof SuppressedError=="function"?SuppressedError:function(n,t,i){var r=new Error(i);return r.name="SuppressedError",r.error=n,r.suppressed=t,r},function(n){n[n.Unknown=0]="Unknown";n[n.AddToCart=1]="AddToCart";n[n.RemoveFromCart=2]="RemoveFromCart";n[n.Checkout=3]="Checkout";n[n.CheckoutOption=4]="CheckoutOption";n[n.Click=5]="Click";n[n.ViewDetail=6]="ViewDetail";n[n.Purchase=7]="Purchase";n[n.Refund=8]="Refund";n[n.AddToWishlist=9]="AddToWishlist";n[n.RemoveFromWishlist=10]="RemoveFromWishlist"}(w||(w={})),function(n){n.other="other";n.customerId="customerid";n.facebook="facebook";n.twitter="twitter";n.google="google";n.microsoft="microsoft";n.yahoo="yahoo";n.email="email";n.alias="alias";n.facebookCustomAudienceId="facebookcustomaudienceid";n.otherId2="other2";n.otherId3="other3";n.otherId4="other4";n.otherId5="other5";n.otherId6="other6";n.otherId7="other7";n.otherId8="other8";n.otherId9="other9";n.otherId10="other10";n.mobileNumber="mobile_number";n.phoneNumber2="phone_number_2";n.phoneNumber3="phone_number_3"}(o||(o={}));pi=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};i={},function(n){Object.defineProperty(n,"__esModule",{value:!0}),function(n){n.unknown="Unknown";n.iOS="IOS";n.android="Android";n.windowsPhone="WindowsPhone";n.mobileWeb="MobileWeb";n.unityIOS="UnityIOS";n.unityAndroid="UnityAndroid";n.desktop="Desktop";n.tvOS="TVOS";n.roku="Roku";n.outOfBand="OutOfBand";n.alexa="Alexa";n.smartTV="SmartTV";n.fireTV="FireTV";n.xbox="Xbox"}(n.ApplicationInformationOsEnum||(n.ApplicationInformationOsEnum={})),function(n){n.applicationStateTransition="application_state_transition"}(n.ApplicationStateTransitionEventEventTypeEnum||(n.ApplicationStateTransitionEventEventTypeEnum={})),function(n){n.applicationInitialized="application_initialized";n.applicationExit="application_exit";n.applicationBackground="application_background";n.applicationForeground="application_foreground"}(n.ApplicationStateTransitionEventDataApplicationTransitionTypeEnum||(n.ApplicationStateTransitionEventDataApplicationTransitionTypeEnum={})),function(n){n.unknown="unknown";n.development="development";n.production="production"}(n.BatchEnvironmentEnum||(n.BatchEnvironmentEnum={})),function(n){n.breadcrumb="breadcrumb"}(n.BreadcrumbEventEventTypeEnum||(n.BreadcrumbEventEventTypeEnum={})),function(n){n.commerceEvent="commerce_event"}(n.CommerceEventEventTypeEnum||(n.CommerceEventEventTypeEnum={})),function(n){n.addToCart="add_to_cart";n.removeFromCart="remove_from_cart";n.checkout="checkout";n.checkoutOption="checkout_option";n.click="click";n.viewDetail="view_detail";n.purchase="purchase";n.refund="refund";n.promotionView="promotion_view";n.promotionClick="promotion_click";n.addToWishlist="add_to_wishlist";n.removeFromWishlist="remove_from_wishlist";n.impression="impression"}(n.CommerceEventDataCustomEventTypeEnum||(n.CommerceEventDataCustomEventTypeEnum={})),function(n){n.crashReport="crash_report"}(n.CrashReportEventEventTypeEnum||(n.CrashReportEventEventTypeEnum={})),function(n){n.customEvent="custom_event"}(n.CustomEventEventTypeEnum||(n.CustomEventEventTypeEnum={})),function(n){n.navigation="navigation";n.location="location";n.search="search";n.transaction="transaction";n.userContent="user_content";n.userPreference="user_preference";n.social="social";n.media="media";n.other="other";n.unknown="unknown"}(n.CustomEventDataCustomEventTypeEnum||(n.CustomEventDataCustomEventTypeEnum={})),function(n){n.portrait="portrait";n.portraitUpsideDown="portrait_upside_down";n.landscape="landscape";n.landscapeLeft="LandscapeLeft";n.landscapeRight="LandscapeRight";n.faceUp="FaceUp";n.faceDown="FaceDown";n.square="Square"}(n.DeviceCurrentStateDeviceOrientationEnum||(n.DeviceCurrentStateDeviceOrientationEnum={})),function(n){n.portrait="portrait";n.portraitUpsideDown="portrait_upside_down";n.landscape="landscape";n.landscapeLeft="LandscapeLeft";n.landscapeRight="LandscapeRight";n.faceUp="FaceUp";n.faceDown="FaceDown";n.square="Square"}(n.DeviceCurrentStateStatusBarOrientationEnum||(n.DeviceCurrentStateStatusBarOrientationEnum={})),function(n){n.iOS="iOS";n.android="Android";n.web="web";n.desktop="desktop";n.tvOS="tvOS";n.roku="roku";n.outOfBand="out_of_band";n.smartTV="smart_tv";n.xbox="xbox"}(n.DeviceInformationPlatformEnum||(n.DeviceInformationPlatformEnum={})),function(n){n.unknown="unknown";n.sessionStart="session_start";n.sessionEnd="session_end";n.screenView="screen_view";n.customEvent="custom_event";n.crashReport="crash_report";n.optOut="opt_out";n.firstRun="first_run";n.preAttribution="pre_attribution";n.pushRegistration="push_registration";n.applicationStateTransition="application_state_transition";n.pushMessage="push_message";n.networkPerformance="network_performance";n.breadcrumb="breadcrumb";n.profile="profile";n.pushReaction="push_reaction";n.commerceEvent="commerce_event";n.userAttributeChange="user_attribute_change";n.userIdentityChange="user_identity_change";n.uninstall="uninstall";n.validationResult="validation_result"}(n.EventTypeEnum||(n.EventTypeEnum={})),function(n){n.other="other";n.customerId="customer_id";n.facebook="facebook";n.twitter="twitter";n.google="google";n.microsoft="microsoft";n.yahoo="yahoo";n.email="email";n.alias="alias";n.facebookCustomAudienceId="facebook_custom_audience_id";n.otherId2="other_id_2";n.otherId3="other_id_3";n.otherId4="other_id_4";n.otherId5="other_id_5";n.otherId6="other_id_6";n.otherId7="other_id_7";n.otherId8="other_id_8";n.otherId9="other_id_9";n.otherId10="other_id_10";n.mobileNumber="mobile_number";n.phoneNumber2="phone_number_2";n.phoneNumber3="phone_number_3"}(n.IdentityTypeEnum||(n.IdentityTypeEnum={})),function(n){n.networkPerformance="network_performance"}(n.NetworkPerformanceEventEventTypeEnum||(n.NetworkPerformanceEventEventTypeEnum={})),function(n){n.optOut="opt_out"}(n.OptOutEventEnum||(n.OptOutEventEnum={})),function(n){n.unknown="unknown";n.addToCart="add_to_cart";n.removeFromCart="remove_from_cart";n.checkout="checkout";n.checkoutOption="checkout_option";n.click="click";n.viewDetail="view_detail";n.purchase="purchase";n.refund="refund";n.addToWishlist="add_to_wishlist";n.removeFromWishlist="remove_from_wish_list"}(n.ProductActionActionEnum||(n.ProductActionActionEnum={})),function(n){n.profile="profile"}(n.ProfileEventEventTypeEnum||(n.ProfileEventEventTypeEnum={})),function(n){n.signup="signup";n.login="login";n.logout="logout";n.update="update";n["delete"]="delete"}(n.ProfileEventDataProfileEventTypeEnum||(n.ProfileEventDataProfileEventTypeEnum={})),function(n){n.view="view";n.click="click"}(n.PromotionActionActionEnum||(n.PromotionActionActionEnum={})),function(n){n.pushMessage="push_message"}(n.PushMessageEventEventTypeEnum||(n.PushMessageEventEventTypeEnum={})),function(n){n.sent="sent";n.received="received";n.action="action"}(n.PushMessageEventDataPushMessageTypeEnum||(n.PushMessageEventDataPushMessageTypeEnum={})),function(n){n.notRunning="not_running";n.background="background";n.foreground="foreground"}(n.PushMessageEventDataApplicationStateEnum||(n.PushMessageEventDataApplicationStateEnum={})),function(n){n.received="Received";n.directOpen="DirectOpen";n.read="Read";n.influencedOpen="InfluencedOpen";n.displayed="Displayed"}(n.PushMessageEventDataPushMessageBehaviorEnum||(n.PushMessageEventDataPushMessageBehaviorEnum={})),function(n){n.pushRegistration="push_registration"}(n.PushRegistrationEventEventTypeEnum||(n.PushRegistrationEventEventTypeEnum={})),function(n){n.sessionEnd="session_end"}(n.SessionEndEventEventTypeEnum||(n.SessionEndEventEventTypeEnum={})),function(n){n.sessionStart="session_start"}(n.SessionStartEventEventTypeEnum||(n.SessionStartEventEventTypeEnum={})),function(n){n["native"]="native";n.javascript="javascript";n.pixel="pixel";n.desktop="desktop";n.partner="partner";n.serverToServer="server_to_server"}(n.SourceInformationChannelEnum||(n.SourceInformationChannelEnum={})),function(n){n.userAttributeChange="user_attribute_change"}(n.UserAttributeChangeEventEventTypeEnum||(n.UserAttributeChangeEventEventTypeEnum={})),function(n){n.userIdentityChange="user_identity_change"}(n.UserIdentityChangeEventEventTypeEnum||(n.UserIdentityChangeEventEventTypeEnum={}))}(i);yt={exports:{}};yt.exports,function(n){(function(t,i,r){n.exports=r();n.exports["default"]=r()})("slugify",pi,function(){function t(t,r){if(typeof t!="string")throw new Error("slugify: string argument expected");r=typeof r=="string"?{replacement:r}:r||{};var e=i[r.locale]||{},f=r.replacement===undefined?"-":r.replacement,o=r.trim===undefined?!0:r.trim,u=t.normalize().split("").reduce(function(t,i){var u=e[i];return u===undefined&&(u=n[i]),u===undefined&&(u=i),u===f&&(u=" "),t+u.replace(r.remove||/[^\w\s$*_+~.()'"!\-:@]+/g,"")},"");return r.strict&&(u=u.replace(/[^A-Za-z0-9\s]/g,"")),o&&(u=u.trim()),u=u.replace(/\s+/g,f),r.lower&&(u=u.toLowerCase()),u}var n=JSON.parse('{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","":"cent","":"pound","":"currency","":"yen","":"(c)","":"a","":"(r)","":"o","":"A","":"A","":"A","":"A","":"A","":"A","":"AE","":"C","":"E","":"E","":"E","":"E","":"I","":"I","":"I","":"I","":"D","":"N","":"O","":"O","":"O","":"O","":"O","":"O","":"U","":"U","":"U","":"U","":"Y","":"TH","":"ss","":"a","":"a","":"a","":"a","":"a","":"a","":"ae","":"c","":"e","":"e","":"e","":"e","":"i","":"i","":"i","":"i","":"d","":"n","":"o","":"o","":"o","":"o","":"o","":"o","":"u","":"u","":"u","":"u","":"y","":"th","":"y","":"A","":"a","":"A","":"a","":"A","":"a","":"C","":"c","":"C","":"c","":"D","":"d","":"DJ","":"dj","":"E","":"e","":"E","":"e","":"e","":"e","":"E","":"e","":"G","":"g","":"G","":"g","":"I","":"i","":"i","":"i","":"I","":"i","":"I","":"i","":"k","":"k","":"L","":"l","":"L","":"l","":"L","":"l","":"N","":"n","":"N","":"n","":"N","":"n","":"O","":"o","":"O","":"o","":"OE","":"oe","":"R","":"r","":"R","":"r","":"S","":"s","":"S","":"s","":"S","":"s","":"T","":"t","":"T","":"t","":"U","":"u","":"u","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"z","":"Z","":"z","":"Z","":"z","":"E","":"f","":"O","":"o","":"U","":"u","":"LJ","":"lj","":"NJ","":"nj","":"S","":"s","":"T","":"t","":"e","":"o","":"A","":"E","":"H","":"I","":"O","":"Y","":"W","":"i","":"A","":"B","":"G","":"D","":"E","":"Z","":"H","":"8","":"I","":"K","":"L","":"M","":"N","":"3","":"O","":"P","":"R","":"S","":"T","":"Y","":"F","":"X","":"PS","":"W","":"I","":"Y","":"a","":"e","":"h","":"i","":"y","":"a","":"b","":"g","":"d","":"e","":"z","":"h","":"8","":"i","":"k","":"l","":"m","":"n","":"3","":"o","":"p","":"r","":"s","":"s","":"t","":"y","":"f","":"x","":"ps","":"w","":"i","":"y","":"o","":"y","":"w","":"Yo","":"DJ","":"Ye","":"I","":"Yi","":"J","":"LJ","":"NJ","":"C","":"DZ","":"A","":"B","":"V","":"G","":"D","":"E","":"Zh","":"Z","":"I","":"J","":"K","":"L","":"M","":"N","":"O","":"P","":"R","":"S","":"T","":"U","":"F","":"H","":"C","":"Ch","":"Sh","":"Sh","":"U","":"Y","":"","":"E","":"Yu","":"Ya","":"a","":"b","":"v","":"g","":"d","":"e","":"zh","":"z","":"i","":"j","":"k","":"l","":"m","":"n","":"o","":"p","":"r","":"s","":"t","":"u","":"f","":"h","":"c","":"ch","":"sh","":"sh","":"u","":"y","":"","":"e","":"yu","":"ya","":"yo","":"dj","":"ye","":"i","":"yi","":"j","":"lj","":"nj","":"c","":"u","":"dz","":"G","":"g","":"GH","":"gh","":"KH","":"kh","":"NG","":"ng","":"UE","":"ue","":"U","":"u","":"H","":"h","":"AE","":"ae","":"OE","":"oe","":"A","":"B","":"G","":"D","":"E","":"Z","":"E\'","":"Y\'","":"T\'","":"JH","":"I","":"L","":"X","":"C\'","":"K","":"H","":"D\'","":"GH","":"TW","":"M","":"Y","":"N","":"SH","":"CH","":"P","":"J","":"R\'","":"S","":"V","":"T","":"R","":"C","":"P\'","":"Q\'","":"O\'\'","":"F","":"EV","":"a","":"aa","":"a","":"u","":"i","":"e","":"a","":"b","":"h","":"t","":"th","":"j","":"h","":"kh","":"d","":"th","":"r","":"z","":"s","":"sh","":"s","":"dh","":"t","":"z","":"a","":"gh","":"f","":"q","":"k","":"l","":"m","":"n","":"h","":"w","":"a","":"y","":"an","":"on","":"en","":"a","":"u","":"e","":"","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"p","":"ch","":"zh","":"k","":"g","":"y","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"baht","":"a","":"b","":"g","":"d","":"e","":"v","":"z","":"t","":"i","":"k","":"l","":"m","":"n","":"o","":"p","":"zh","":"r","":"s","":"t","":"u","":"f","":"k","":"gh","":"q","":"sh","":"ch","":"ts","":"dz","":"ts","":"ch","":"kh","":"j","":"h","":"S","":"s","":"W","":"w","":"W","":"w","":"W","":"w","":"SS","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"A","":"a","":"E","":"e","":"E","":"e","":"E","":"e","":"E","":"e","":"E","":"e","":"E","":"e","":"E","":"e","":"E","":"e","":"I","":"i","":"I","":"i","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"O","":"o","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"Y","":"y","":"Y","":"y","":"Y","":"y","":"Y","":"y","":"-","":"\'","":"\'","":"\\"","":"\\"","":"\\"","":"+","":"*","":"...","":"ecu","":"cruzeiro","":"french franc","":"lira","":"mill","":"naira","":"peseta","":"rupee","":"won","":"new shequel","":"dong","":"euro","":"kip","":"tugrik","":"drachma","":"penny","":"peso","":"guarani","":"austral","":"hryvnia","":"cedi","":"kazakhstani tenge","":"indian rupee","":"turkish lira","":"russian ruble","":"bitcoin","":"sm","":"tm","":"d","":"delta","":"sum","":"infinity","":"love","":"yuan","":"yen","":"rial","":"laa","":"laa","":"lai","":"la"}'),i=JSON.parse('{"bg":{"":"Y","":"Ts","":"Sht","":"A","":"Y","":"y","":"ts","":"sht","":"a","":"y"},"de":{"":"AE","":"ae","":"OE","":"oe","":"UE","":"ue","":"ss","%":"prozent","&":"und","|":"oder","":"summe","":"unendlich","":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","":"centavos","":"libras","":"moneda","":"francos","":"suma","":"infinito","":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","":"centime","":"livre","":"devise","":"franc","":"somme","":"infini","":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","":"centavo","":"soma","":"libra","":"infinito","":"amor"},"uk":{"":"Y","":"y","":"Y","":"y","":"Ts","":"ts","":"Kh","":"kh","":"Shch","":"shch","":"H","":"h"},"vi":{"":"D","":"d"},"da":{"":"OE","":"oe","":"AA","":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"strre end"},"nb":{"&":"og","":"AA","":"AE","":"OE","":"aa","":"ae","":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","":"AA","":"AE","":"OE","":"aa","":"ae","":"oe"}}');return t.extend=function(t){Object.assign(n,t)},t})}(yt,yt.exports);var nu=yt.exports,tu=gr(nu),iu=function(n){return su(lu(n))},ru=function(n){return hu(cu(n))},uu=function(n,t){var i=0,r;if(Array.prototype.indexOf)return n.indexOf(t,0)>=0;for(r=n.length;i<r;i++)if(i in n&&n[i]===t)return!0;return!1},fu=function(n,t){if(t&&n)for(var i in n)if(n.hasOwnProperty(i)&&i.toLowerCase()===t.toLowerCase())return i;return null};var eu=function(){var t,n;return(window.crypto&&window.crypto.getRandomValues&&(t=window.crypto.getRandomValues(new Uint8Array(1))),t)?(n^t[0]%16>>n/4).toString(16):(n^Math.random()*16>>n/4).toString(16)},wi=function wi(n){return n===void 0&&(n=""),n?eu():"".concat(1e7,"-").concat(1e3,"-").concat(4e3,"-").concat(8e3,"-").concat(1e11).replace(/[018]/g,wi)},ou=function(n){if(!n)return 100;var t=ut(n);return Math.abs(t%100)+1},k=function(n){var t=Object.prototype.toString.call(n);return t==="[object Object]"||t==="[object Error]"},pt=function(n){if(isNaN(n)||!isFinite(n))return 0;var t=parseFloat(n);return isNaN(t)?0:t},et=function(n){return ki(n)?n:null},su=function(n){return n.replace(/,/g,"|")},hu=function(n){return n.replace(/\|/g,",")},cu=function(n){return n.replace(/\'/g,'"')},lu=function(n){return n.replace(/\"/g,"'")},au=function(n){return n==="false"||n==="0"?!1:Boolean(n)},vu=function(n){return decodeURIComponent(n.replace(/\+/g," "))},yu=function(n){return n.indexOf('"')===0&&(n=n.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),n},bi=function(n){return typeof n=="string"},si=function(n){return typeof n=="number"},pu=function(n){return typeof n=="function"},wu=function(n){return bi(n)&&n===tu(n)},ki=function(n){return bi(n)||si(n)},y=function(n){return n==null||!(Object.keys(n)||n).length};var nr=function(){function n(n,t,i){this._storageKey=n;this.storageObject=t;this.logger=(i===null||i===void 0?void 0:i.logger)||{verbose:function(){},warning:function(){},error:function(){}};this.contents=this.retrieve()}return n.prototype.store=function(n){this.contents=n;var t=y(n)?"":JSON.stringify(n);try{this.storageObject.setItem(this._storageKey,t);this.logger.verbose("Saving item to Storage: ".concat(t))}catch(i){this.logger.error("Cannot Save items to Storage: ".concat(t));this.logger.error(i)}},n.prototype.retrieve=function(){var n=this.storageObject.getItem(this._storageKey);return this.contents=n?JSON.parse(n):null,this.logger.verbose("Retrieving item from Storage: ".concat(n)),this.contents},n.prototype.purge=function(){this.logger.verbose("Purging Storage");this.contents=null;this.storageObject.removeItem(this._storageKey)},n}(),gf=function(n){function t(t,i){return n.call(this,t,window.localStorage,i)||this}return ti(t,n),t}(nr),ne=function(n){function t(t,i){return n.call(this,t,window.sessionStorage,i)||this}return ti(t,n),t}(nr),te=function(){function i(n,t){var u,r;this.offlineStorageEnabled=!1;this.mpInstance=n;this.uploadIntervalMillis=t;this.batchingEnabled=t>=i.MINIMUM_INTERVAL_MILLIS;this.uploadIntervalMillis<i.MINIMUM_INTERVAL_MILLIS&&(this.uploadIntervalMillis=i.MINIMUM_INTERVAL_MILLIS);this.eventsQueuedForProcessing=[];this.batchesQueuedForProcessing=[];this.offlineStorageEnabled=this.isOfflineStorageAvailable();this.offlineStorageEnabled&&(this.eventVault=new ne("".concat(n._Store.storageName,"-events"),{logger:n.Logger}),this.batchVault=new gf("".concat(n._Store.storageName,"-batches"),{logger:n.Logger}),(u=this.eventsQueuedForProcessing).push.apply(u,this.eventVault.retrieve()));var f=(r=this.mpInstance._Store,r.SDKConfig),e=r.devToken,o=this.mpInstance._Helpers.createServiceUrl(f.v3SecureServiceUrl,e);this.uploadUrl="".concat(o,"/events");this.uploader=window.fetch?new ie(this.uploadUrl):new re(this.uploadUrl);this.triggerUploadInterval(!0,!1);this.addEventListeners()}return i.prototype.isOfflineStorageAvailable=function(){var n,i=(n=this.mpInstance,n._Helpers.getFeatureFlag),r=n._Store.deviceId,u=i(t.FeatureFlags.OfflineStorage),f=parseInt(u,10),e=ou(r);return f>=e},i.prototype.addEventListeners=function(){var n=this;document.addEventListener("visibilitychange",function(){n.prepareAndUpload(!1,n.isBeaconAvailable())});window.addEventListener("beforeunload",function(){n.prepareAndUpload(!1,n.isBeaconAvailable())});window.addEventListener("pagehide",function(){n.prepareAndUpload(!1,n.isBeaconAvailable())})},i.prototype.isBeaconAvailable=function(){return navigator.sendBeacon?!0:!1},i.prototype.triggerUploadInterval=function(n,t){var i=this;n===void 0&&(n=!1);t===void 0&&(t=!1);setTimeout(function(){i.prepareAndUpload(n,t)},this.uploadIntervalMillis)},i.prototype.queueEvent=function(t){y(t)||(this.eventsQueuedForProcessing.push(t),this.offlineStorageEnabled&&this.eventVault&&this.eventVault.store(this.eventsQueuedForProcessing),this.mpInstance.Logger.verbose("Queuing event: ".concat(JSON.stringify(t))),this.mpInstance.Logger.verbose("Queued event count: ".concat(this.eventsQueuedForProcessing.length)),(!this.batchingEnabled||n.TriggerUploadType[t.EventDataType])&&this.prepareAndUpload(!1,!1))},i.createNewBatches=function(n,t,i){var l,e,o,a,v,s,y,h,w,r,u,c,b;if(!t||!n||!n.length)return null;for(l=[],e=new Map,o=0,a=n;o<a.length;o++)r=a[o],r.MPID||(v=t.getMPID(),r.MPID=v),u=e.get(r.MPID),u||(u=[]),u.push(r),e.set(r.MPID,u);for(s=0,y=Array.from(e.entries());s<y.length;s++){var k=y[s],v=k[0],g=k[1],p=new Map;for(h=0,w=g;h<w.length;h++)r=w[h],u=p.get(r.SessionId),u||(u=[]),u.push(r),p.set(r.SessionId,u);for(c=0,b=Array.from(p.entries());c<b.length;c++){var nt=b[c],f=di(v,nt[1],i),d=i._Store.SDKConfig.onCreateBatch;d&&(f=d(f),f?f.modified=!0:i.Logger.warning("Skiping batch upload because no batch was returned from onCreateBatch callback"));f&&l.push(f)}}return l},i.prototype.prepareAndUpload=function(n,t){return at(this,void 0,void 0,function(){var o,u,r,f,e,s,h,c;return vt(this,function(l){switch(l.label){case 0:return o=this.mpInstance.Identity.getCurrentUser(),u=this.eventsQueuedForProcessing,this.eventsQueuedForProcessing=[],this.offlineStorageEnabled&&this.eventVault&&this.eventVault.store([]),r=[],y(u)||(r=i.createNewBatches(u,o,this.mpInstance)),this.offlineStorageEnabled&&this.batchVault&&((s=this.batchesQueuedForProcessing).unshift.apply(s,this.batchVault.retrieve()),this.batchVault.purge()),y(r)||(h=this.batchesQueuedForProcessing).push.apply(h,r),f=this.batchesQueuedForProcessing,this.batchesQueuedForProcessing=[],t&&this.offlineStorageEnabled&&this.batchVault&&this.batchVault.store(f),[4,this.uploadBatches(this.mpInstance.Logger,f,t)];case 1:return e=l.sent(),y(e)||(c=this.batchesQueuedForProcessing).unshift.apply(c,e),!t&&this.offlineStorageEnabled&&this.batchVault&&(this.batchVault.store(this.batchesQueuedForProcessing),this.batchesQueuedForProcessing=[]),n&&this.triggerUploadInterval(n,!1),[2]}})})},i.prototype.uploadBatches=function(n,t,r){return at(this,void 0,void 0,function(){var u,e,o,s,f,h;return vt(this,function(c){switch(c.label){case 0:if(u=t.filter(function(n){return!y(n.events)}),y(u))return[2,null];n.verbose("Uploading batches: ".concat(JSON.stringify(u)));n.verbose("Batch count: ".concat(u.length));e=0;c.label=1;case 1:return(e<u.length)?(o={method:"POST",headers:{Accept:i.CONTENT_TYPE,"Content-Type":"text/plain;charset=UTF-8"},body:JSON.stringify(u[e])},!(r&&this.isBeaconAvailable()))?[3,2]:(s=new Blob([o.body],{type:"text/plain;charset=UTF-8"}),navigator.sendBeacon(this.uploadUrl,s),[3,5]):[3,6];case 2:return c.trys.push([2,4,,5]),[4,this.uploader.upload(o)];case 3:if(f=c.sent(),f.status>=200&&f.status<300)n.verbose("Upload success for request ID: ".concat(u[e].source_request_id));else{if(f.status>=500||f.status===429)return n.error("HTTP error status ".concat(f.status," received")),[2,u.slice(e,u.length)];if(f.status>=401)return n.error("HTTP error status ".concat(f.status," while uploading - please verify your API key.")),[2,null];console.error("HTTP error status ".concat(f.status," while uploading events."),f);throw new Error("Uncaught HTTP Error ".concat(f.status,".  Batch upload will be re-attempted."));}return[3,5];case 4:return h=c.sent(),n.error("Error sending event to mParticle servers. ".concat(h)),[2,u.slice(e,u.length)];case 5:return e++,[3,1];case 6:return[2,null]}})})},i.CONTENT_TYPE="text/plain;charset=UTF-8",i.MINIMUM_INTERVAL_MILLIS=500,i}(),tr=function(){function n(n){this.url=n}return n}(),ie=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return ti(t,n),t.prototype.upload=function(n){return at(this,void 0,void 0,function(){var t;return vt(this,function(i){switch(i.label){case 0:return[4,fetch(this.url,n)];case 1:return t=i.sent(),[2,t]}})})},t}(tr),re=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return ti(t,n),t.prototype.upload=function(n){return at(this,void 0,void 0,function(){var t;return vt(this,function(i){switch(i.label){case 0:return[4,this.makeRequest(this.url,n.body)];case 1:return t=i.sent(),[2,t]}})})},t.prototype.makeRequest=function(n,t){return at(this,void 0,void 0,function(){var i;return vt(this,function(){return i=new XMLHttpRequest,[2,new Promise(function(r,u){i.onreadystatechange=function(){i.readyState===4&&(i.status>=200&&i.status<300?r(i):u(i))};i.open("post",n);i.send(t)})]})})},t}(tr);var ir={isNumber:si,isFunction:pu,isStringOrNumber:ki,isValidAttributeValue:function(n){return n!==undefined&&!k(n)&&!Array.isArray(n)},isValidKeyValue:function(n){return Boolean(n&&!k(n)&&!Array.isArray(n)&&!this.isFunction(n))},validateIdentities:function(i,r){var e={userIdentities:1,onUserAlias:1,copyUserAttributes:1},u,f;if(i){if(r==="modify"&&(k(i.userIdentities)&&!Object.keys(i.userIdentities).length||!k(i.userIdentities)))return{valid:!1,error:t.Messages.ValidationMessages.ModifyIdentityRequestUserIdentitiesPresent};for(u in i)if(i.hasOwnProperty(u)){if(!e[u])return{valid:!1,error:t.Messages.ValidationMessages.IdentityRequesetInvalidKey};if(u==="onUserAlias"&&!ir.isFunction(i[u]))return{valid:!1,error:t.Messages.ValidationMessages.OnUserAliasType}}if(Object.keys(i).length===0)return{valid:!0};if(i.userIdentities===undefined)return{valid:!1,error:t.Messages.ValidationMessages.UserIdentities};if(i.userIdentities!==null&&!k(i.userIdentities))return{valid:!1,error:t.Messages.ValidationMessages.UserIdentities};if(k(i.userIdentities)&&Object.keys(i.userIdentities).length)for(f in i.userIdentities)if(i.userIdentities.hasOwnProperty(f)){if(n.IdentityType.getIdentityType(f)===!1)return{valid:!1,error:t.Messages.ValidationMessages.UserIdentitiesInvalidKey};if(!(typeof i.userIdentities[f]=="string"||i.userIdentities[f]===null))return{valid:!1,error:t.Messages.ValidationMessages.UserIdentitiesInvalidValues}}}return{valid:!0}}},h=function(){function n(){}return n.hashEventType=function(n){return ut(n)},n.hashEventName=function(n,t){return ut(t+n)},n.hashEventAttributeKey=function(n,t,i){return ut(n+t+i)},n.hashUserAttribute=function(n){return ut(n)},n.hashUserIdentity=function(n){return n},n.hashConsentPurpose=function(n,t){return ut(n+t)},n.hashAttributeConditionalForwarding=function(n){return ut(n).toString()},n.hashConsentPurposeConditionalForwarding=function(n,t){return this.hashConsentPurpose(n,t).toString()},n}(),ii=t.StorageNames;var wt=t.Messages,rr="mParticleAndroid",li="mParticle";ur=t.Messages;st=t.Messages;bt=t.Messages;var g=ct.Base64,ht=t.Messages,ri=t.Base64CookieKeys,kt=t.SDKv2NonMPIDCookieKeys,ft=t.StorageNames;return ot=t.Messages,dt=n.MessageType,or=n.ApplicationTransitionType,s=t.Messages,c=t.HTTPCodes,l=t.CCPAPurpose,u={ScreenView:"screen_view",CustomEvent:"custom_event",Commerce:"commerce",UserAttributes:"user_attributes",UserIdentities:"user_identities",ProductAction:"product_action",PromotionAction:"promotion_action",ProductImpression:"product_impression"},hr=function(){function t(n,t){var d=this,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,i,r;if(this.dataPlanMatchLookups={},this.blockEvents=!1,this.blockEventAttributes=!1,this.blockUserAttributes=!1,this.blockUserIdentities=!1,this.kitBlockingEnabled=!1,n&&!n.document){this.kitBlockingEnabled=!1;return}if(this.kitBlockingEnabled=!0,this.mpInstance=t,this.blockEvents=(e=(f=(u=n===null||n===void 0?void 0:n.document)===null||u===void 0?void 0:u.dtpn)===null||f===void 0?void 0:f.blok)===null||e===void 0?void 0:e.ev,this.blockEventAttributes=(h=(s=(o=n===null||n===void 0?void 0:n.document)===null||o===void 0?void 0:o.dtpn)===null||s===void 0?void 0:s.blok)===null||h===void 0?void 0:h.ea,this.blockUserAttributes=(a=(l=(c=n===null||n===void 0?void 0:n.document)===null||c===void 0?void 0:c.dtpn)===null||l===void 0?void 0:l.blok)===null||a===void 0?void 0:a.ua,this.blockUserIdentities=(p=(y=(v=n===null||n===void 0?void 0:n.document)===null||v===void 0?void 0:v.dtpn)===null||y===void 0?void 0:y.blok)===null||p===void 0?void 0:p.id,i=(k=(b=(w=n===null||n===void 0?void 0:n.document)===null||w===void 0?void 0:w.dtpn)===null||b===void 0?void 0:b.vers)===null||k===void 0?void 0:k.version_document,r=i===null||i===void 0?void 0:i.data_points,i)try{(r===null||r===void 0?void 0:r.length)>0&&r.forEach(function(n){return d.addToMatchLookups(n)})}catch(g){this.mpInstance.Logger.error("There was an issue with the data plan: "+g)}}return t.prototype.addToMatchLookups=function(n){var r,f,e,t,i;if(!n.match||!n.validator){this.mpInstance.Logger.warning("Data Plan Point is not valid' + ".concat(n));return}t=this.generateMatchKey(n.match);i=this.getPlannedProperties(n.match.type,n.validator);this.dataPlanMatchLookups[t]=i;(((r=n===null||n===void 0?void 0:n.match)===null||r===void 0?void 0:r.type)===u.ProductImpression||((f=n===null||n===void 0?void 0:n.match)===null||f===void 0?void 0:f.type)===u.ProductAction||((e=n===null||n===void 0?void 0:n.match)===null||e===void 0?void 0:e.type)===u.PromotionAction)&&(t=this.generateProductAttributeMatchKey(n.match),i=this.getProductProperties(n.match.type,n.validator),this.dataPlanMatchLookups[t]=i)},t.prototype.generateMatchKey=function(n){var t=n.criteria||"",i,r,f,e,o;switch(n.type){case u.CustomEvent:return i=t,[u.CustomEvent,i.custom_event_type,i.event_name].join(":");case u.ScreenView:return r=t,[u.ScreenView,"",r.screen_name].join(":");case u.ProductAction:return f=t,[n.type,f.action].join(":");case u.PromotionAction:return e=t,[n.type,e.action].join(":");case u.ProductImpression:return o=t,[n.type,o.action].join(":");case u.UserIdentities:case u.UserAttributes:return[n.type].join(":");default:return null}},t.prototype.generateProductAttributeMatchKey=function(n){var t=n.criteria||"",i,r;switch(n.type){case u.ProductAction:return i=t,[n.type,i.action,"ProductAttributes"].join(":");case u.PromotionAction:return r=t,[n.type,r.action,"ProductAttributes"].join(":");case u.ProductImpression:return[n.type,"ProductAttributes"].join(":");default:return null}},t.prototype.getPlannedProperties=function(n,t){var s,h,c,l,a,v,y,p,r,w,f,b,i,d,o,k,e;switch(n){case u.CustomEvent:case u.ScreenView:case u.ProductAction:case u.PromotionAction:case u.ProductImpression:if(r=(l=(c=(h=(s=t===null||t===void 0?void 0:t.definition)===null||s===void 0?void 0:s.properties)===null||h===void 0?void 0:h.data)===null||c===void 0?void 0:c.properties)===null||l===void 0?void 0:l.custom_attributes,r){if(r.additionalProperties===!0||r.additionalProperties===undefined)return!0;for(i={},f=0,b=Object.keys(r.properties);f<b.length;f++)e=b[f],i[e]=!0;return i}return((y=(v=(a=t===null||t===void 0?void 0:t.definition)===null||a===void 0?void 0:a.properties)===null||v===void 0?void 0:v.data)===null||y===void 0?void 0:y.additionalProperties)===!1?{}:!0;case u.UserAttributes:case u.UserIdentities:if(w=(p=t===null||t===void 0?void 0:t.definition)===null||p===void 0?void 0:p.additionalProperties,w===!0||w===undefined)return!0;for(i={},d=t.definition.properties,o=0,k=Object.keys(d);o<k.length;o++)e=k[o],i[e]=!0;return i;default:return null}},t.prototype.getProductProperties=function(n,t){var s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,i,f,et,r,o,ot,e;switch(n){case u.ProductImpression:if(i=(b=(w=(p=(y=(v=(a=(l=(c=(h=(s=t===null||t===void 0?void 0:t.definition)===null||s===void 0?void 0:s.properties)===null||h===void 0?void 0:h.data)===null||c===void 0?void 0:c.properties)===null||l===void 0?void 0:l.product_impressions)===null||a===void 0?void 0:a.items)===null||v===void 0?void 0:v.properties)===null||y===void 0?void 0:y.products)===null||p===void 0?void 0:p.items)===null||w===void 0?void 0:w.properties)===null||b===void 0?void 0:b.custom_attributes,(i===null||i===void 0?void 0:i.additionalProperties)===!1){for(r={},f=0,et=Object.keys(i===null||i===void 0?void 0:i.properties);f<et.length;f++)e=et[f],r[e]=!0;return r}return!0;case u.ProductAction:case u.PromotionAction:if(i=(ft=(ut=(rt=(it=(tt=(nt=(g=(d=(k=t===null||t===void 0?void 0:t.definition)===null||k===void 0?void 0:k.properties)===null||d===void 0?void 0:d.data)===null||g===void 0?void 0:g.properties)===null||nt===void 0?void 0:nt.product_action)===null||tt===void 0?void 0:tt.properties)===null||it===void 0?void 0:it.products)===null||rt===void 0?void 0:rt.items)===null||ut===void 0?void 0:ut.properties)===null||ft===void 0?void 0:ft.custom_attributes,i&&i.additionalProperties===!1){for(r={},o=0,ot=Object.keys(i===null||i===void 0?void 0:i.properties);o<ot.length;o++)e=ot[o],r[e]=!0;return r}return!0;default:return null}},t.prototype.getMatchKey=function(n){var e,r,t,f;switch(n.event_type){case i.EventTypeEnum.screenView:return(e=n,e.data)?["screen_view","",e.data.screen_name].join(":"):null;case i.EventTypeEnum.commerceEvent:if(r=n,t=[],r&&r.data){var o=r.data,s=o.product_action,c=o.product_impressions,h=o.promotion_action;s?(t.push(u.ProductAction),t.push(s.action)):h?(t.push(u.PromotionAction),t.push(h.action)):c&&t.push(u.ProductImpression)}return t.join(":");case i.EventTypeEnum.customEvent:return(f=n,f.data)?["custom_event",f.data.custom_event_type,f.data.event_name].join(":"):null;default:return null}},t.prototype.getProductAttributeMatchKey=function(n){switch(n.event_type){case i.EventTypeEnum.commerceEvent:var o=n,t=[],r=o.data,f=r.product_action,s=r.product_impressions,e=r.promotion_action;return f?(t.push(u.ProductAction),t.push(f.action),t.push("ProductAttributes")):e?(t.push(u.PromotionAction),t.push(e.action),t.push("ProductAttributes")):s&&(t.push(u.ProductImpression),t.push("ProductAttributes")),t.join(":");default:return null}},t.prototype.createBlockedEvent=function(t){try{return t&&(t=this.transformEventAndEventAttributes(t)),t&&t.EventDataType===n.MessageType.Commerce&&(t=this.transformProductAttributes(t)),t&&(t=this.transformUserAttributes(t),t=this.transformUserIdentities(t)),t}catch(i){return t}},t.prototype.transformEventAndEventAttributes=function(n){var t=tt({},n),e=hi(t),o=this.getMatchKey(e),i=this.dataPlanMatchLookups[o],r,u,f;if(this.blockEvents&&!i)return null;if(this.blockEventAttributes){if(i===!0)return t;if(i){for(r=0,u=Object.keys(t.EventAttributes);r<u.length;r++)f=u[r],i[f]||delete t.EventAttributes[f];return t}return t}return t},t.prototype.transformProductAttributes=function(t){function f(n,t){t.forEach(function(t){for(var u,i=0,r=Object.keys(t.Attributes);i<r.length;i++)u=r[i],n[u]||delete t.Attributes[u]})}var u,i=tt({},t),e=hi(i),o=this.getProductAttributeMatchKey(e),r=this.dataPlanMatchLookups[o];if(this.blockEvents&&!r)return null;if(this.blockEventAttributes){if(r===!0)return i;if(r){switch(t.EventCategory){case n.CommerceEventType.ProductImpression:i.ProductImpressions.forEach(function(n){f(r,n===null||n===void 0?void 0:n.ProductList)});break;case n.CommerceEventType.ProductPurchase:f(r,(u=i.ProductAction)===null||u===void 0?void 0:u.ProductList);break;default:this.mpInstance.Logger.warning("Product Not Supported ")}return i}return i}return i},t.prototype.transformUserAttributes=function(n){var i=tt({},n),r,t,u,f;if(this.blockUserAttributes&&(r=this.dataPlanMatchLookups.user_attributes,this.mpInstance._Helpers.isObject(r)))for(t=0,u=Object.keys(i.UserAttributes);t<u.length;t++)f=u[t],r[f]||delete i.UserAttributes[f];return i},t.prototype.isAttributeKeyBlocked=function(n){if(!this.blockUserAttributes)return!1;if(this.blockUserAttributes){var t=this.dataPlanMatchLookups.user_attributes;if(t===!0)return!1;if(!t[n])return!0}return!1},t.prototype.isIdentityBlocked=function(n){if(!this.blockUserIdentities)return!1;if(this.blockUserIdentities){var t=this.dataPlanMatchLookups.user_identities;if(t===!0)return!1;if(!t[n])return!0}else return!1;return!1},t.prototype.transformUserIdentities=function(t){var f=this,r,i=tt({},t),u;return this.blockUserIdentities&&(u=this.dataPlanMatchLookups.user_identities,this.mpInstance._Helpers.isObject(u)&&((r=i===null||i===void 0?void 0:i.UserIdentities)===null||r===void 0?void 0:r.length)&&i.UserIdentities.forEach(function(t,r){var e=n.IdentityType.getIdentityName(f.mpInstance._Helpers.parseNumber(t.Type));u[e]||i.UserIdentities.splice(r,1)})),i},t}(),ui=t.HTTPCodes,gt=t.Messages,it=t.Messages,cr=t.HTTPCodes,f=function(){return null},vr=function(){function n(){}return n.prototype.getMPInstance=function(){return{_Helpers:{sanitizeAttributes:window.mParticle.getInstance()._Helpers.sanitizeAttributes,generateHash:function(){return"mockHash"},generateUniqueId:function(){return"mockId"},extend:window.mParticle.getInstance()._Helpers.extend,createServiceUrl:f,parseNumber:f,isObject:f,returnConvertedBoolean:f,Validators:null},_resetForTests:f,_APIClient:null,MPSideloadedKit:null,_Consent:null,_Forwarders:null,_NativeSdkHelpers:null,_Persistence:null,_preInit:null,Consent:null,_ServerModel:null,_SessionManager:null,_Store:{sessionId:"mockSessionId",sideloadedKits:[],devToken:"test_dev_token",isFirstRun:!0,isEnabled:!0,sessionAttributes:{},currentSessionMPIDs:[],consentState:null,clientId:null,deviceId:null,serverSettings:{},dateLastEventSent:null,sessionStartDate:null,currentPosition:null,isTracking:!1,watchPositionId:null,cartProducts:[],eventQueue:[],currencyCode:null,globalTimer:null,context:null,configurationLoaded:!1,identityCallInFlight:!1,nonCurrentUserMPIDs:{},identifyCalled:!1,isLoggedIn:!1,cookieSyncDates:{},integrationAttributes:{},requireDelay:!0,isLocalStorageAvailable:null,integrationDelayTimeoutStart:null,storageName:null,prodStorageName:null,activeForwarders:[],kits:{},configuredForwarders:[],pixelConfigurations:[],wrapperSDKInfo:{name:"none",version:null,isInfoSet:!1},SDKConfig:{isDevelopmentMode:!1,onCreateBatch:f}},config:null,eCommerce:null,Identity:{getCurrentUser:f,IdentityAPI:{},identify:f,login:f,logout:f,modify:f},Logger:{verbose:f,error:f,warning:f},ProductActionType:null,ServerModel:null,addForwarder:f,generateHash:f,getAppVersion:f,getAppName:f,getInstance:f,getDeviceId:f,init:f,logBaseEvent:f,logEvent:f,logLevel:"none",setPosition:f,upload:f}},n.prototype.createSDKEventFunction=function(n){return new sr(this.getMPInstance()).createEventObject(n)},n.prototype.returnBatch=function(n){var t=this,i=this.getMPInstance(),r=Array.isArray(n)?n.map(function(n){return t.createSDKEventFunction(n)}):[this.createSDKEventFunction(n)];return di("0",r,i)},n}(),function(n){n[n.Unknown=0]="Unknown";n[n.Navigation=1]="Navigation";n[n.Location=2]="Location";n[n.Search=3]="Search";n[n.Transaction=4]="Transaction";n[n.UserContent=5]="UserContent";n[n.UserPreference=6]="UserPreference";n[n.Social=7]="Social";n[n.Other=8]="Other";n[n.Media=9]="Media"}(fi||(fi={})),function(n){n[n.SessionStart=1]="SessionStart";n[n.SessionEnd=2]="SessionEnd";n[n.PageView=3]="PageView";n[n.PageEvent=4]="PageEvent";n[n.CrashReport=5]="CrashReport";n[n.OptOut=6]="OptOut";n[n.AppStateTransition=10]="AppStateTransition";n[n.Profile=14]="Profile";n[n.Commerce=16]="Commerce";n[n.UserAttributeChange=17]="UserAttributeChange";n[n.UserIdentityChange=18]="UserIdentityChange";n[n.Media=20]="Media"}(yr||(yr={})),function(n){n[n.Other=0]="Other";n[n.CustomerId=1]="CustomerId";n[n.Facebook=2]="Facebook";n[n.Twitter=3]="Twitter";n[n.Google=4]="Google";n[n.Microsoft=5]="Microsoft";n[n.Yahoo=6]="Yahoo";n[n.Email=7]="Email";n[n.FacebookCustomAudienceId=9]="FacebookCustomAudienceId";n[n.Other2=10]="Other2";n[n.Other3=11]="Other3";n[n.Other4=12]="Other4";n[n.Other5=13]="Other5";n[n.Other6=14]="Other6";n[n.Other7=15]="Other7";n[n.Other8=16]="Other8";n[n.Other9=17]="Other9";n[n.Other10=18]="Other10";n[n.MobileNumber=19]="MobileNumber";n[n.PhoneNumber2=20]="PhoneNumber2";n[n.PhoneNumber3=21]="PhoneNumber3"}(pr||(pr={})),wr=function(){function n(n){this.filterDictionary={eventTypeFilters:[],eventNameFilters:[],screenNameFilters:[],screenAttributeFilters:[],userIdentityFilters:[],userAttributeFilters:[],attributeFilters:[],consentRegulationFilters:[],consentRegulationPurposeFilters:[],messageTypeFilters:[],messageTypeStateFilters:[],filteringEventAttributeValue:{},filteringUserAttributeValue:{},filteringConsentRuleValues:{}};this.kitInstance=n}return n.prototype.addEventTypeFilter=function(n){var t=h.hashEventType(n);this.filterDictionary.eventTypeFilters.push(t)},n.prototype.addEventNameFilter=function(n,t){var i=h.hashEventName(t,n);this.filterDictionary.eventNameFilters.push(i)},n.prototype.addEventAttributeFilter=function(n,t,i){var r=h.hashEventAttributeKey(n,t,i);this.filterDictionary.attributeFilters.push(r)},n.prototype.addScreenNameFilter=function(n){var t=h.hashEventName(n,fi.Unknown);this.filterDictionary.screenNameFilters.push(t)},n.prototype.addScreenAttributeFilter=function(n,t){var i=h.hashEventAttributeKey(fi.Unknown,n,t);this.filterDictionary.screenAttributeFilters.push(i)},n.prototype.addUserIdentityFilter=function(n){var t=h.hashUserIdentity(n);this.filterDictionary.userIdentityFilters.push(t)},n.prototype.addUserAttributeFilter=function(n){var t=h.hashUserAttribute(n);this.filterDictionary.userAttributeFilters.push(t)},n}(),Array.prototype.forEach||(Array.prototype.forEach=ct.forEach),Array.prototype.map||(Array.prototype.map=ct.map),Array.prototype.filter||(Array.prototype.filter=ct.filter),Array.isArray||(Array.prototype.isArray=ct.isArray),vi=new fo,typeof window!="undefined"&&(window.mParticle=vi,window.mParticle._BatchValidator=new vr),vi}() ;;
; var OptimizelyKit=function(n){"use strict";function g(){}function y(n){this.common=n||{}}function s(n){this.common=n||{}}function i(n){this.common=n||{}}function h(){var n,t={},i={},r,f;if(window.optimizely){n=window.optimizely.get("data");for(r in n.events)t[n.events[r].apiName]=1;for(f in n.pages)i[n.pages[f].apiName]=1;u.events=t;u.pages=i}}function c(){var n,t={},i;if(window.optimizelyDatafile){n=f.arrayToObject(window.optimizelyDatafile.events,"id");for(i in n)t[n[i].key]=1;o.events=t}}function l(n){this.common=n||{}}function ct(){return ht}function k(n){return n!=null&&typeof n=="object"&&Array.isArray(n)===!1}function lt(n){if(!n){console.log("You must pass a config object to register the kit "+t);return}if(!k(n)){console.log("'config' must be an object. You passed in a "+typeof n);return}k(n.kits)?n.kits[t]={constructor:a}:(n.kits={},n.kits[t]={constructor:a});console.log("Successfully registered "+t+" to your mParticle configuration")}var nt=g,u={pages:{},events:{}},o={events:{}},tt={arrayToObject:function(n,t){return n.reduce(function(n,i){return n[i[t]]=i,n},{})},loadScript:function(n,t){var i=document.createElement("script");i.type="text/javascript";i.onload=t;i.src=n;document.head.appendChild(i)},getUserId:function(n){var r=window.mParticle.Identity.getCurrentUser().getUserIdentities(),i=r.userIdentities,t;switch(n){case"customerId":t=i.customerid;break;case"email":t=i.email;break;case"mpid":t=window.mParticle.Identity.getCurrentUser().getMPID();break;case"other":t=i.other;break;case"other2":t=i.other2;break;case"other3":t=i.other3;break;case"other4":t=i.other4;break;case"deviceApplicationStamp":t=window.mParticle.getDeviceId();break;default:t=null}return t||(t=window.mParticle.getDeviceId()),t}},f=tt,p,w,v,d;y.prototype.logCommerceEvent=function(n){var t=this,i=mParticle.eCommerce.expandCommerceEvent(n);i.forEach(function(i){var r,h,c;if(!t.common.useFullStack&&u.events[i.EventName]&&(r={type:"event",eventName:n.EventName,tags:{}},r.tags=i.EventAttributes||{},n.EventCategory===mParticle.CommerceEventType.ProductPurchase||n.EventCategory===mParticle.CommerceEventType.ProductRefund?i.EventName.indexOf("Total")>-1?(r.eventName=n.CustomFlags&&n.CustomFlags["Optimizely.EventName"]?n.CustomFlags["Optimizely.EventName"]:i.EventName,i.EventAttributes&&i.EventAttributes["Total Amount"]&&(r.tags.revenue=i.EventAttributes["Total Amount"]*100)):(r.eventName=i.EventName,r.tags.revenue&&delete r.tags.revenue,r.tags.Revenue&&delete r.tags.Revenue):(r.eventName=i.EventName,n.CustomFlags&&n.CustomFlags["Optimizely.EventName"]&&(r.eventName=n.CustomFlags["Optimizely.EventName"])),u.events[r.eventName])){h={};for(c in r)h[c]=r[c];window.optimizely.push(h)}if(t.common.useFullStack&&window.optimizelyClientInstance&&(o.events[i.EventName]||o.events[n.CustomFlags["OptimizelyFullStack.EventName"]])){var e=i.EventName,l,a=t.common.userAttributes,s={};s=i.EventAttributes||{};window.mParticle&&window.mParticle.Identity&&(l=f.getUserId(t.common.userIdField));n.EventCategory===mParticle.CommerceEventType.ProductPurchase||n.EventCategory===mParticle.CommerceEventType.ProductRefund?i.EventName.indexOf("Total")>-1?(e=n.CustomFlags&&n.CustomFlags["OptimizelyFullStack.EventName"]?n.CustomFlags["OptimizelyFullStack.EventName"]:i.EventName,i.EventAttributes&&i.EventAttributes["Total Amount"]&&(s.revenue=i.EventAttributes["Total Amount"]*100)):(n.CustomFlags&&n.CustomFlags["OptimizelyFullStack.EventName"]&&(e=n.CustomFlags["OptimizelyFullStack.EventName"]),s.revenue&&delete s.revenue):(e=i.EventName,n.CustomFlags&&n.CustomFlags["OptimizelyFullStack.EventName"]&&(e=n.CustomFlags["OptimizelyFullStack.EventName"]));window.optimizelyClientInstance.track(e,l,a,s)}})};p=y;s.prototype.logEvent=function(n){var t;if(!this.common.useFullStack&&u.events[n.EventName]&&(t={type:"event",eventName:n.EventName},n.EventAttributes&&(t.tags=n.EventAttributes),n.CustomFlags&&n.CustomFlags["Optimizely.Value"]&&(t.tags.value=n.CustomFlags["Optimizely.Value"]),window.optimizely.push(t)),this.common.useFullStack&&window.optimizelyClientInstance&&o.events[n.EventName]){var e=n.EventName,r,s=this.common.userAttributes,i={};window.mParticle&&window.mParticle.Identity&&(r=f.getUserId(this.common.userIdField));n.EventAttributes&&(i=n.EventAttributes);n.CustomFlags&&n.CustomFlags["OptimizelyFullStack.Value"]&&(i.value=n.CustomFlags["OptimizelyFullStack.Value"]);window.optimizelyClientInstance.track(e,r,s,i)}};s.prototype.logPageView=function(n){var i=this,t;!i.common.useFullStack&&u.pages[n.EventName]&&(t={type:"page",pageName:n.EventName},n.EventAttributes&&(t.tags=n.EventAttributes),window.optimizely.push(t))};w=s;i.prototype.onIdentifyComplete=function(){};i.prototype.onLoginComplete=function(){};i.prototype.onLogoutComplete=function(){};i.prototype.onModifyComplete=function(){};i.prototype.onUserIdentified=function(){};i.prototype.onSetUserIdentity=function(){};var it=i,rt="https://unpkg.com/@optimizely/optimizely-sdk@3.5.0/dist/optimizely.browser.umd.min.js",ut="https://cdn.optimizely.com/datafiles/",ft=".json/tag.js",et={name:"Optimizely",moduleId:54,initForwarder:function(n,t,i,r,u,e,o,s,l,a,v){var y,p,w;s.useFullStack=n.useFullStack==="True";t?(s.useFullStack||h(),s.useFullStack&&(s.userIdField=n.userIdField,s.userAttributes=i,c())):(window.optimizely||s.useFullStack?h():(y=document.createElement("script"),y.type="text/javascript",y.async=!0,y.src="https://cdn.optimizely.com/js/"+n.projectId+".js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(y),y.onload=function(){if(h(),window.optimizely&&e.length>0){for(var n=0;n<e.length;n++)u(e[n]);e=[]}}),!window.optimizelyClientInstance&&s.useFullStack?(s.userIdField=n.userIdField,s.userAttributes=i,p=function(){},v&&v["OptimizelyFullStack.ErrorHandler"]&&(p=v["OptimizelyFullStack.ErrorHandler"]),w=function(){window.optimizelyClientInstance=window.optimizelySdk.createInstance({datafile:window.optimizelyDatafile,errorHandler:{handleError:p}});window.optimizelyClientInstance.onReady().then(function(){c()})},f.loadScript(rt,function(){f.loadScript(ut+n.projectId+ft,w)})):(s.userIdField=n.userIdField,s.userAttributes=i,c()))}};var e=et,ot={onSessionStart:function(){},onSessionEnd:function(){}},b=ot;l.prototype.onRemoveUserAttribute=function(n){if(!this.common.useFullStack&&window.optimizely){var t={};t[n]=null;window.optimizely.push({type:"user",attributes:t})}this.common.useFullStack&&window.optimizelyClientInstance&&this.common.userAttributes[n]&&delete this.common.userAttributes[n]};l.prototype.onSetUserAttribute=function(n,t){var i,r;!this.common.useFullStack&&window.optimizely&&(i={},i[n]=t,window.optimizely.push({type:"user",attributes:i}));this.common.useFullStack&&window.optimizelyClientInstance&&(r=this,r.common.userAttributes[n]=t)};var st=l,t=e.name,ht=e.moduleId,r={SessionStart:1,SessionEnd:2,PageView:3,PageEvent:4,CrashReport:5,OptOut:6,Commerce:16,Media:20},a=function(){function c(r,h,c,l,a,v,y,b,k,d){u=r;f=typeof window!="undefined"&&window.mParticle.isTestEnvironment?function(){}:h;try{e.initForwarder(r,c,a,v,s,o,i,n.common,y,b,k,d);n.eventHandler=new w(n.common);n.identityHandler=new it(n.common);n.userAttributeHandler=new st(n.common);n.commerceHandler=new p(n.common);i=!0}catch(g){console.log("Failed to initialize "+t+" - "+g)}}function s(u){var e=!1;if(i)try{return u.EventDataType===r.SessionStart?e=l(u):u.EventDataType===r.SessionEnd?e=a(u):u.EventDataType===r.CrashReport?e=v(u):u.EventDataType===r.PageView?e=y(u):u.EventDataType===r.Commerce?e=k(u):u.EventDataType===r.PageEvent?e=h(u):u.EventDataType===r.Media&&(e=h(u)),e===!0&&f?(f(n,u),"Successfully sent to "+t):"Error logging event or event type not supported on forwarder "+t}catch(s){return"Failed to send to "+t+" "+s}else return o.push(u),"Can't send to forwarder "+t+", not initialized. Event added to queue."}function l(n){try{b.onSessionStart(n);return!0}catch(i){return{error:"Error starting session on forwarder "+t+"; "+i}}}function a(n){try{b.onSessionEnd(n);return!0}catch(i){return{error:"Error ending session on forwarder "+t+"; "+i}}}function v(i){try{return n.eventHandler.logError(i),!0}catch(r){return{error:"Error logging error on forwarder "+t+"; "+r}}}function y(i){try{return n.eventHandler.logPageView(i),!0}catch(r){return{error:"Error logging page view on forwarder "+t+"; "+r}}}function h(i){try{return n.eventHandler.logEvent(i),!0}catch(r){return{error:"Error logging event on forwarder "+t+"; "+r}}}function k(i){try{return n.commerceHandler.logCommerceEvent(i),!0}catch(r){return{error:"Error logging purchase event on forwarder "+t+"; "+r}}}function d(r,f){if(i)try{n.userAttributeHandler.onSetUserAttribute(r,f,u);return"Successfully set user attribute on forwarder "+t}catch(e){return"Error setting user attribute on forwarder "+t+"; "+e}else return"Can't set user attribute on forwarder "+t+", not initialized"}function g(r){if(i)try{n.userAttributeHandler.onRemoveUserAttribute(r,u);return"Successfully removed user attribute on forwarder "+t}catch(f){return"Error removing user attribute on forwarder "+t+"; "+f}else return"Can't remove user attribute on forwarder "+t+", not initialized"}function tt(r,f){if(i)try{n.identityHandler.onSetUserIdentity(u,r,f);return"Successfully set user Identity on forwarder "+t}catch(e){return"Error removing user attribute on forwarder "+t+"; "+e}else return"Can't call setUserIdentity on forwarder "+t+", not initialized"}function rt(r){if(i)try{n.identityHandler.onUserIdentified(r);return"Successfully called onUserIdentified on forwarder "+t}catch(u){return{error:"Error calling onUserIdentified on forwarder "+t+"; "+u}}else return"Can't set new user identities on forwader  "+t+", not initialized"}function ut(r,u){if(i)try{n.identityHandler.onIdentifyComplete(r,u);return"Successfully called onIdentifyComplete on forwarder "+t}catch(f){return{error:"Error calling onIdentifyComplete on forwarder "+t+"; "+f}}else return"Can't call onIdentifyCompleted on forwader  "+t+", not initialized"}function ft(r,u){if(i)try{n.identityHandler.onLoginComplete(r,u);return"Successfully called onLoginComplete on forwarder "+t}catch(f){return{error:"Error calling onLoginComplete on forwarder "+t+"; "+f}}else return"Can't call onLoginComplete on forwader  "+t+", not initialized"}function et(r,u){if(i)try{n.identityHandler.onLogoutComplete(r,u);return"Successfully called onLogoutComplete on forwarder "+t}catch(f){return{error:"Error calling onLogoutComplete on forwarder "+t+"; "+f}}else return"Can't call onLogoutComplete on forwader  "+t+", not initialized"}function ot(r,u){if(i)try{n.identityHandler.onModifyComplete(r,u);return"Successfully called onModifyComplete on forwarder "+t}catch(f){return{error:"Error calling onModifyComplete on forwarder "+t+"; "+f}}else return"Can't call onModifyComplete on forwader  "+t+", not initialized"}function ht(r){if(i)try{return n.initialization.setOptOut(r),"Successfully called setOptOut on forwarder "+t}catch(u){return{error:"Error calling setOptOut on forwarder "+t+"; "+u}}else return"Can't call setOptOut on forwader  "+t+", not initialized"}var n=this,i=!1,u,f,o=[];n.name=e.name;n.moduleId=e.moduleId;n.common=new nt;this.init=c;this.process=s;this.setUserAttribute=d;this.removeUserAttribute=g;this.onUserIdentified=rt;this.setUserIdentity=tt;this.onIdentifyComplete=ut;this.onLoginComplete=ft;this.onLogoutComplete=et;this.onModifyComplete=ot;this.setOptOut=ht};return typeof window!="undefined"&&window&&window.mParticle&&window.mParticle.addForwarder&&window.mParticle.addForwarder({name:t,constructor:a,getId:ct}),v={register:lt},d=v.register,n.default=v,n.register=d,n}({}) ;;
; var mpBrazeKitV4=function(n){function vh(n){var i=n.default,t;return typeof i=="function"?(t=function(){return i.apply(this,arguments)},t.prototype=i.prototype):t={},Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}function wr(n){const t=[];for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&void 0!==n[i]&&t.push(n[i]);return t}function st(n,i,r,u){const f=wr(n);return-1!==f.indexOf(i)||(t.j.error(`${r} Valid values from ${u} are "${f.join('"/"')}".`),!1)}function b(n){return Array.isArray?Array.isArray(n):"[object Array]"===Object.prototype.toString.call(n)}function ht(n){return"[object Date]"===Object.prototype.toString.call(n)}function er(n){return"[object Object]"===Object.prototype.toString.call(n)}function bh(n){null==n&&(n=[]);const t=[],i=arguments.length;for(let r=0,u=n.length;r<u;r++){const u=n[r];if(-1===t.indexOf(u)){let f=1;for(f=1;f<i&&-1!==arguments[f].indexOf(u);f++);f===i&&t.push(u)}}return t}function ct(n){const t=[];for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.push(i);return t}function ai(n,t){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;const u=n.toString();if(u!==t.toString())return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!=+n?+t!=+t:0==+n?1/+n==1/t:+n==+t;case"[object Date]":case"[object Boolean]":return+n==+t}const e="[object Array]"===u;if(!e){if("object"!=typeof n||"object"!=typeof t)return!1;const i=n.constructor,r=t.constructor;if(i!==r&&!("function"==typeof i&&i instanceof i&&"function"==typeof r&&r instanceof r)&&"constructor"in n&&"constructor"in t)return!1}const r=[],f=[];let i=r.length;for(;i--;)if(r[i]===n)return f[i]===t;if(r.push(n),f.push(t),e){if(i=n.length,i!==t.length)return!1;for(;i--;)if(!ai(n[i],t[i]))return!1}else{let r,u=ct(n);if(i=u.length,ct(t).length!==i)return!1;for(;i--;)if(r=u[i],!Object.prototype.hasOwnProperty.call(t,r)||!ai(n[r],t[r]))return!1}return r.pop(),f.pop(),!0}function or(n,t){let i=n/1e3;return t&&(i=Math.floor(i)),i}function kh(n){return 1e3*n}function lt(n){const t=parseInt(n);return null==n||isNaN(t)?null:new Date(1e3*t)}function br(n){return null!=n&&ht(n)?n.toISOString().replace(/\.[0-9]{3}Z$/,""):n}function vi(n){return null==n||""===n?null:new Date(n)}function dh(n){return null==n||""===n?(new Date).valueOf():n}function he(n){return((new Date).valueOf()-n.valueOf())/1e3}function ce(n){return(n.valueOf()-(new Date).valueOf())/1e3}function dr(n){let t=n.length;for(let i=n.length-1;i>=0;i--){const r=n.charCodeAt(i);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2);r>=56320&&r<=57343&&i--}return t}function fc(n){try{n=n.replace(/-/g,"+").replace(/_/g,"/");let t=window.atob(n),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);let r=new Uint16Array(i.buffer);return String.fromCharCode(...r)}catch(n){return t.j.error("Unable to decode Base64: "+n),null}}function du(n){try{let r=n.match(cr)[0].length;const i=n.substring(r);if(r>n.length-1||!i)return void t.j.error(`Did not find base64 encoded brazeAction in url to process : ${n}`);const u=fc(i);return u?JSON.parse(u):void t.j.error(`Failed to decode base64 encoded brazeAction: ${i}`)}catch(i){return void t.j.error(`Failed to process brazeAction URL ${n} : ${i.message}`)}}function be(n,t){let i=!1;for(const r of t)if(i=i||n(r),i)return!0;return!1}function gu(n){try{const t=n[o.properties.type];return t===o.types.le?be(gu,n[o.properties.ce]):!vc(t)}catch(n){return!0}}function ke(n){if(!de(n))return!1;const t=n[o.properties.type];return t===o.types.le?be(ke,n[o.properties.ce]):t===o.types.requestPushPermission}function et(n,i,r){const u=null!=n&&"string"==typeof n&&(""===n||n.match(ec));return u||t.j.error(`Cannot ${i} because ${r} "${n}" is invalid.`),u}function nf(n){return null!=n&&n.match(oc)&&-1===sc.indexOf(n)&&t.j.warn("Custom attribute keys cannot contain '$' or '.'"),et(n,"set custom user attribute","the given key")}function tf(n){const t=typeof n;return null==n||"number"===t||"boolean"===t||ht(n)||"string"===t}function rf(n,i,r){const u=-1!==r;if(u&&r>50)return t.j.error("Nested attributes cannot be more than 50 levels deep."),!1;const f=u?r+1:-1;if(b(n)&&b(i)){for(let t=0;t<n.length&&t<i.length;t++)if(ht(n[t])&&(i[t]=br(n[t])),!rf(n[t],i[t],f))return!1}else{if(!er(n))return tf(n);for(const t of ct(n))if(u&&!nf(t)||(ht(n[t])&&(i[t]=br(n[t])),!rf(n[t],i[t],f)))return!1}return!0}function cc(n,i,r,u,f){let e;return e=er(n)||b(n)?rf(n,i,f?1:-1):tf(n),e||t.j.error(`Cannot ${r} because ${u} "${n}" is invalid.`),e}function ot(n,i,r,u){const f="string"==typeof n||null===n&&u;return f||t.j.error(`Cannot ${i} because ${r} "${n}" is invalid.`),f}function gr(n,i,r,u,f){if(null==n&&(n={}),"object"!=typeof n||b(n))return t.j.error(`${i} requires that ${r} be an object. Ignoring ${f}.`),[!1,null];let o,s;i===nr?(o=76800,s="75KB"):(o=51200,s="50KB");const h=JSON.stringify(n);if(dr(h)>o)return t.j.error(`Could not ${u} because ${r} was greater than the max size of ${s}.`),[!1,null];let e;try{e=JSON.parse(h)}catch(n){return t.j.error(`Could not ${u} because ${r} did not contain valid JSON.`),[!1,null]}for(let t in n){if(i===nr&&!nf(t))return[!1,null];if(!et(t,u,`the ${f} property name`))return[!1,null];const r=n[t];if(i!==nr&&null==r){delete n[t];delete e[t];continue}if(ht(r)&&(e[t]=br(r)),!cc(r,e[t],u,`the ${f} property "${t}"`,i===nr))return[!1,null]}return[!0,e]}function lc(n,i){let r=!1,u=!1;const f=()=>{t.j.error("Custom attribute arrays must be either string arrays or object arrays.")};for(const t of i)if("string"==typeof t){if(u)return f(),[!1,!1];if(!et(t,`set custom user attribute "${n}"`,"the element in the given array"))return[!1,!1];r=!0}else{if(!er(t))return f(),[!1,!1];if(r)return f(),[!1,!1];if(!gr(t,nr,"attribute value",`set custom user attribute "${n}"`,"custom user attribute"))return[!1,!1];u=!0}return[r,u]}function ac(n){return"string"==typeof n&&null!=n.toLowerCase().match(hc)}function de(n){if(!(o.properties.type in n))return!1;switch(n[o.properties.type]){case o.types.le:if(o.properties.ce in n)return!0;break;case o.types.logCustomEvent:case o.types.setEmailNotificationSubscriptionType:case o.types.setPushNotificationSubscriptionType:case o.types.setCustomUserAttribute:case o.types.addToSubscriptionGroup:case o.types.removeFromSubscriptionGroup:case o.types.addToCustomAttributeArray:case o.types.removeFromCustomAttributeArray:case o.types.de:case o.types.pe:if(o.properties.me in n)return!0;break;case o.types.requestPushPermission:return!0;default:return!1}return!1}function vc(n){let t=!1;return Object.keys(o.types).forEach(i=>{o.types[i]!==n.toString()||(t=!0)}),t}function ge(n,i,r){let u=`The '${n}' ${i} is deprecated.`;r&&(u+=` Please use '${r}' instead.`);t.j.warn(u)}function tl(n,t,i,r){if(null==n)return!1;t=t||!1;i=i||!1;const u=n.getBoundingClientRect();return null!=u&&(u.top>=0&&u.top<=(window.innerHeight||document.documentElement.clientHeight)||!t)&&(u.left>=0||!r)&&(u.bottom>=0&&u.bottom<=(window.innerHeight||document.documentElement.clientHeight)||!i)&&(u.right<=(window.innerWidth||document.documentElement.clientWidth)||!r)}function to(){if(null==pi.Ou){pi.Ou=!1;try{const n=Object.defineProperty({},"passive",{get:()=>{pi.Ou=!0}});window.addEventListener("testPassive",null,n);window.removeEventListener("testPassive",null,n)}catch(n){}}return pi.Ou}function ar(n,t,i=()=>{}){n.addEventListener(t,i,!!to()&&{passive:!0})}function il(n){return pi.eo(n,!0,!1,!1)}function rl(n){return pi.eo(n,!1,!0,!1)}function io(n){if(n.onclick){const t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0);n.onclick.apply(n,[t])}}function vr(n,t,i){let r=null,u=null;ar(n,"touchstart",n=>{r=n.touches[0].clientX,u=n.touches[0].clientY});ar(n,"touchmove",f=>{if(null!=r&&null!=u){const e=r-f.touches[0].clientX,o=u-f.touches[0].clientY;Math.abs(e)>Math.abs(o)&&Math.abs(e)>=25?((e>0&&t===ni.W||e<0&&t===ni.X)&&i(f),r=null,u=null):Math.abs(o)>=25&&((o>0&&t===ni.Je&&n.scrollTop===n.scrollHeight-n.offsetHeight||o<0&&t===ni.Ke&&0===n.scrollTop)&&i(f),r=null,u=null)}})}function ro(n,t,i){const u="http://www.w3.org/2000/svg",r=document.createElementNS(u,"svg");r.setAttribute("viewBox",n);r.setAttribute("xmlns",u);const f=document.createElementNS(u,"path");return f.setAttribute("d",t),null!=i&&f.setAttribute("fill",i),r.appendChild(f),r}function fo(n){if(!n)return null;if(n.is_control)return yi.fromJson(n);let i=n.type;null!=i&&(i=i.toUpperCase());const o=n.message,p=n.text_align_message,at=n.slide_from,s=n.extras,h=n.trigger_id,w=n.click_action,b=n.uri,k=n.open_target,c=n.message_close,l=n.duration,d=n.icon,g=n.image_url,ot=n.image_style,nt=n.icon_color,tt=n.icon_bg_color,it=n.bg_color,rt=n.text_color,ut=n.close_btn_color,st=n.header,ht=n.text_align_header,ct=n.header_text_color,ft=n.frame_color,et=[];let a=n.btns;null==a&&(a=[]);for(let n=0;n<a.length;n++)et.push(wi.fromJson(a[n]));const lt=n.crop_type,vt=n.orientation,v=n.animate_in,y=n.animate_out;let r,u=n.html_id,e=n.css;if(null!=u&&""!==u&&null!=e&&""!==e||(u=void 0,e=void 0),i===ir.es||i===f.Ee.Ne)r=new ir(o,p,s,h,w,b,k,c,l,d,g,ot,nt,tt,it,rt,ut,v,y,st,ht,ct,ft,et,lt,u,e);else if(i===bi.es)r=new bi(o,p,s,h,w,b,k,c,l,d,g,ot,nt,tt,it,rt,ut,v,y,st,ht,ct,ft,et,lt,vt,u,e);else if(i===ki.es)r=new ki(o,p,at,s,h,w,b,k,c,l,d,g,nt,tt,it,rt,ut,v,y,u,e);else{if(i!==oi.es&&i!==f.Ee.Pe)return void t.j.error("Ignoring message with unknown type "+i);{const t=n.message_fields;r=new oi(o,s,h,c,l,v,y,ft,u,e,t);r.trusted=n.trusted||!1}}return r.Ce=i,r}function eo(n,t,r){const u=n||document.querySelector("head"),f=`ab-${t}-css-definitions-${"4.8.0".replace(/\./g,"-")}`,e=u.ownerDocument||document;if(null==e.getElementById(f)){const n=e.createElement("style");n.innerHTML=r;n.id=f;const t=i.nn(s.lo);null!=t&&n.setAttribute("nonce",t);u.appendChild(n)}}function oo(){if(!i.nn(s.Lo)){const n="https://use.fontawesome.com/7f85a56ba4.css";if(!(null!==document.querySelector('link[rel=stylesheet][href="'+n+'"]'))){const t=document.createElement("link");t.setAttribute("rel","stylesheet");t.setAttribute("href",n);document.getElementsByTagName("head")[0].appendChild(t)}}}function fl(n){eo(n,"feed","body>.ab-feed{position:fixed;top:0;right:0;bottom:0;width:421px;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}body>.ab-feed .ab-feed-body{position:absolute;top:0;left:0;right:0;border:none;border-left:1px solid #d0d0d0;padding-top:70px;min-height:100%}body>.ab-feed .ab-initial-spinner{float:none}body>.ab-feed .ab-no-cards-message{position:absolute;width:100%;margin-left:-20px;top:40%}.ab-feed{-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 1px 7px 1px rgba(66,82,113,.15);-moz-box-shadow:0 1px 7px 1px rgba(66,82,113,.15);box-shadow:0 1px 7px 1px rgba(66,82,113,.15);width:402px;background-color:#eee;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;font-size:13px;line-height:130%;letter-spacing:normal;overflow-y:auto;overflow-x:visible;z-index:9011;-webkit-overflow-scrolling:touch}.ab-feed :focus,.ab-feed:focus{outline:0}.ab-feed .ab-feed-body{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:1px solid #d0d0d0;border-top:none;padding:20px 20px 0 20px}.ab-feed.ab-effect-slide{-webkit-transform:translateX(450px);-moz-transform:translateX(450px);-ms-transform:translateX(450px);transform:translateX(450px);-webkit-transition:transform .5s ease-in-out;-moz-transition:transform .5s ease-in-out;-o-transition:transform .5s ease-in-out;transition:transform .5s ease-in-out}.ab-feed.ab-effect-slide.ab-show{-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}.ab-feed.ab-effect-slide.ab-hide{-webkit-transform:translateX(450px);-moz-transform:translateX(450px);-ms-transform:translateX(450px);transform:translateX(450px)}.ab-feed .ab-card{position:relative;-webkit-box-shadow:0 2px 3px 0 rgba(178,178,178,.5);-moz-box-shadow:0 2px 3px 0 rgba(178,178,178,.5);box-shadow:0 2px 3px 0 rgba(178,178,178,.5);-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;width:100%;border:1px solid #d0d0d0;margin-bottom:20px;overflow:hidden;background-color:#fff;-webkit-transition:height .4s ease-in-out,margin .4s ease-in-out;-moz-transition:height .4s ease-in-out,margin .4s ease-in-out;-o-transition:height .4s ease-in-out,margin .4s ease-in-out;transition:height .4s ease-in-out,margin .4s ease-in-out}.ab-feed .ab-card .ab-pinned-indicator{position:absolute;right:0;top:0;margin-right:-1px;width:0;height:0;border-style:solid;border-width:0 24px 24px 0;border-color:transparent #1676d0 transparent transparent}.ab-feed .ab-card .ab-pinned-indicator .fa-star{position:absolute;right:-21px;top:2px;font-size:9px;color:#fff}.ab-feed .ab-card.ab-effect-card.ab-hide{-webkit-transition:all .5s ease-in-out;-moz-transition:all .5s ease-in-out;-o-transition:all .5s ease-in-out;transition:all .5s ease-in-out}.ab-feed .ab-card.ab-effect-card.ab-hide.ab-swiped-left{-webkit-transform:translateX(-450px);-moz-transform:translateX(-450px);-ms-transform:translateX(-450px);transform:translateX(-450px)}.ab-feed .ab-card.ab-effect-card.ab-hide.ab-swiped-right{-webkit-transform:translateX(450px);-moz-transform:translateX(450px);-ms-transform:translateX(450px);transform:translateX(450px)}.ab-feed .ab-card.ab-effect-card.ab-hide:not(.ab-swiped-left):not(.ab-swiped-right){opacity:0}.ab-feed .ab-card .ab-close-button{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;background-color:transparent;background-size:15px;border:none;width:15px;min-width:15px;height:15px;cursor:pointer;display:block;font-size:15px;line-height:0;padding-top:15px;padding-right:15px;padding-left:15px;padding-bottom:15px;position:absolute;right:0;top:0;z-index:9021;opacity:0;-webkit-transition:.5s;-moz-transition:.5s;-o-transition:.5s;transition:.5s}.ab-feed .ab-card .ab-close-button svg{-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease;fill:#9b9b9b;height:auto;width:100%}.ab-feed .ab-card .ab-close-button svg.ab-chevron{display:none}.ab-feed .ab-card .ab-close-button:active{background-color:transparent}.ab-feed .ab-card .ab-close-button:focus{background-color:transparent}.ab-feed .ab-card .ab-close-button:hover{background-color:transparent}.ab-feed .ab-card .ab-close-button:hover svg{fill-opacity:.8}.ab-feed .ab-card .ab-close-button:hover{opacity:1}.ab-feed .ab-card .ab-close-button:focus{opacity:1}.ab-feed .ab-card a{float:none;color:inherit;text-decoration:none}.ab-feed .ab-card a:hover{text-decoration:underline}.ab-feed .ab-card .ab-image-area{float:none;display:inline-block;vertical-align:top;line-height:0;overflow:hidden;width:100%;-webkit-box-sizing:initial;-moz-box-sizing:initial;box-sizing:initial}.ab-feed .ab-card .ab-image-area img{float:none;height:auto;width:100%}.ab-feed .ab-card.ab-banner .ab-card-body{display:none}.ab-feed .ab-card .ab-card-body{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:inline-block;width:100%;position:relative}.ab-feed .ab-card .ab-unread-indicator{position:absolute;bottom:0;margin-right:-1px;width:100%;height:5px;background-color:#1676d0}.ab-feed .ab-card .ab-unread-indicator.read{background-color:transparent}.ab-feed .ab-card .ab-title{float:none;letter-spacing:0;margin:0;font-weight:700;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;display:block;overflow:hidden;word-wrap:break-word;text-overflow:ellipsis;font-size:18px;line-height:130%;padding:20px 25px 0 25px}.ab-feed .ab-card .ab-description{float:none;color:#545454;padding:15px 25px 20px 25px;word-wrap:break-word;white-space:pre-wrap}.ab-feed .ab-card .ab-description.ab-no-title{padding-top:20px}.ab-feed .ab-card .ab-url-area{float:none;color:#1676d0;margin-top:12px;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif}.ab-feed .ab-card.ab-classic-card .ab-card-body{min-height:40px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.ab-feed .ab-card.ab-classic-card.with-image .ab-card-body{min-height:100px;padding-left:72px}.ab-feed .ab-card.ab-classic-card.with-image .ab-image-area{width:60px;height:60px;padding:20px 0 25px 25px;position:absolute}.ab-feed .ab-card.ab-classic-card.with-image .ab-image-area img{-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;max-width:100%;max-height:100%;width:auto;height:auto}.ab-feed .ab-card.ab-classic-card.with-image .ab-title{background-color:transparent;font-size:16px}.ab-feed .ab-card.ab-classic-card.with-image .ab-description{padding-top:10px}.ab-feed .ab-card.ab-control-card{height:0;width:0;margin:0;border:0}.ab-feed .ab-feed-buttons-wrapper{float:none;position:relative;background-color:#282828;height:50px;-webkit-box-shadow:0 2px 3px 0 rgba(178,178,178,.5);-moz-box-shadow:0 2px 3px 0 rgba(178,178,178,.5);box-shadow:0 2px 3px 0 rgba(178,178,178,.5);z-index:1}.ab-feed .ab-feed-buttons-wrapper .ab-close-button,.ab-feed .ab-feed-buttons-wrapper .ab-refresh-button{float:none;cursor:pointer;color:#fff;font-size:18px;padding:16px;-webkit-transition:.2s;-moz-transition:.2s;-o-transition:.2s;transition:.2s}.ab-feed .ab-feed-buttons-wrapper .ab-close-button:hover,.ab-feed .ab-feed-buttons-wrapper .ab-refresh-button:hover{font-size:22px}.ab-feed .ab-feed-buttons-wrapper .ab-close-button{float:right}.ab-feed .ab-feed-buttons-wrapper .ab-close-button:hover{padding-top:12px;padding-right:14px}.ab-feed .ab-feed-buttons-wrapper .ab-refresh-button{padding-left:17px}.ab-feed .ab-feed-buttons-wrapper .ab-refresh-button:hover{padding-top:13px;padding-left:14px}.ab-feed .ab-no-cards-message{text-align:center;margin-bottom:20px}@media (max-width:600px){body>.ab-feed{width:100%}}")}function so(){fl();oo()}function ho(n){eo(n,"iam",".ab-pause-scrolling,body.ab-pause-scrolling,html.ab-pause-scrolling{overflow:hidden;touch-action:none}.ab-iam-root.v3{position:fixed;top:0;right:0;bottom:0;left:0;pointer-events:none;z-index:9011;-webkit-tap-highlight-color:transparent}.ab-iam-root.v3:focus{outline:0}.ab-iam-root.v3.ab-effect-fullscreen,.ab-iam-root.v3.ab-effect-html,.ab-iam-root.v3.ab-effect-modal{opacity:0}.ab-iam-root.v3.ab-effect-fullscreen.ab-show,.ab-iam-root.v3.ab-effect-html.ab-show,.ab-iam-root.v3.ab-effect-modal.ab-show{opacity:1}.ab-iam-root.v3.ab-effect-fullscreen.ab-show.ab-animate-in,.ab-iam-root.v3.ab-effect-html.ab-show.ab-animate-in,.ab-iam-root.v3.ab-effect-modal.ab-show.ab-animate-in{-webkit-transition:opacity .5s;-moz-transition:opacity .5s;-o-transition:opacity .5s;transition:opacity .5s}.ab-iam-root.v3.ab-effect-fullscreen.ab-hide,.ab-iam-root.v3.ab-effect-html.ab-hide,.ab-iam-root.v3.ab-effect-modal.ab-hide{opacity:0}.ab-iam-root.v3.ab-effect-fullscreen.ab-hide.ab-animate-out,.ab-iam-root.v3.ab-effect-html.ab-hide.ab-animate-out,.ab-iam-root.v3.ab-effect-modal.ab-hide.ab-animate-out{-webkit-transition:opacity .5s;-moz-transition:opacity .5s;-o-transition:opacity .5s;transition:opacity .5s}.ab-iam-root.v3.ab-effect-slide .ab-in-app-message{-webkit-transform:translateX(535px);-moz-transform:translateX(535px);-ms-transform:translateX(535px);transform:translateX(535px)}.ab-iam-root.v3.ab-effect-slide.ab-show .ab-in-app-message{-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}.ab-iam-root.v3.ab-effect-slide.ab-show.ab-animate-in .ab-in-app-message{-webkit-transition:transform .5s ease-in-out;-moz-transition:transform .5s ease-in-out;-o-transition:transform .5s ease-in-out;transition:transform .5s ease-in-out}.ab-iam-root.v3.ab-effect-slide.ab-hide .ab-in-app-message{-webkit-transform:translateX(535px);-moz-transform:translateX(535px);-ms-transform:translateX(535px);transform:translateX(535px)}.ab-iam-root.v3.ab-effect-slide.ab-hide .ab-in-app-message.ab-swiped-left{-webkit-transform:translateX(-535px);-moz-transform:translateX(-535px);-ms-transform:translateX(-535px);transform:translateX(-535px)}.ab-iam-root.v3.ab-effect-slide.ab-hide .ab-in-app-message.ab-swiped-up{-webkit-transform:translateY(-535px);-moz-transform:translateY(-535px);-ms-transform:translateY(-535px);transform:translateY(-535px)}.ab-iam-root.v3.ab-effect-slide.ab-hide .ab-in-app-message.ab-swiped-down{-webkit-transform:translateY(535px);-moz-transform:translateY(535px);-ms-transform:translateY(535px);transform:translateY(535px)}.ab-iam-root.v3.ab-effect-slide.ab-hide.ab-animate-out .ab-in-app-message{-webkit-transition:transform .5s ease-in-out;-moz-transition:transform .5s ease-in-out;-o-transition:transform .5s ease-in-out;transition:transform .5s ease-in-out}.ab-iam-root.v3 .ab-ios-scroll-wrapper{position:fixed;top:0;right:0;bottom:0;left:0;overflow:auto;pointer-events:all;touch-action:auto;-webkit-overflow-scrolling:touch}.ab-iam-root.v3 .ab-in-app-message{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:fixed;text-align:center;-webkit-box-shadow:0 0 4px rgba(0,0,0,.3);-moz-box-shadow:0 0 4px rgba(0,0,0,.3);box-shadow:0 0 4px rgba(0,0,0,.3);line-height:normal;letter-spacing:normal;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;z-index:9011;max-width:100%;overflow:hidden;display:inline-block;pointer-events:all;color:#333}.ab-iam-root.v3 .ab-in-app-message.ab-no-shadow{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none}.ab-iam-root.v3 .ab-in-app-message :focus,.ab-iam-root.v3 .ab-in-app-message:focus{outline:0}.ab-iam-root.v3 .ab-in-app-message.ab-clickable{cursor:pointer}.ab-iam-root.v3 .ab-in-app-message.ab-background{background-color:#fff}.ab-iam-root.v3 .ab-in-app-message .ab-close-button{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;background-color:transparent;background-size:15px;border:none;width:15px;min-width:15px;height:15px;cursor:pointer;display:block;font-size:15px;line-height:0;padding-top:15px;padding-right:15px;padding-left:15px;padding-bottom:15px;position:absolute;right:0;top:0;z-index:9021}.ab-iam-root.v3 .ab-in-app-message .ab-close-button svg{-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease;fill:#9b9b9b;height:auto;width:100%}.ab-iam-root.v3 .ab-in-app-message .ab-close-button svg.ab-chevron{display:none}.ab-iam-root.v3 .ab-in-app-message .ab-close-button:active{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-close-button:focus{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-close-button:hover{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-close-button:hover svg{fill-opacity:.8}.ab-iam-root.v3 .ab-in-app-message .ab-message-text{float:none;line-height:1.5;margin:20px 25px;max-width:100%;overflow:hidden;overflow-y:auto;vertical-align:text-bottom;word-wrap:break-word;white-space:pre-wrap;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif}.ab-iam-root.v3 .ab-in-app-message .ab-message-text.start-aligned{text-align:start}.ab-iam-root.v3 .ab-in-app-message .ab-message-text.end-aligned{text-align:end}.ab-iam-root.v3 .ab-in-app-message .ab-message-text.center-aligned{text-align:center}.ab-iam-root.v3 .ab-in-app-message .ab-message-text::-webkit-scrollbar{-webkit-appearance:none;width:14px}.ab-iam-root.v3 .ab-in-app-message .ab-message-text::-webkit-scrollbar-thumb{-webkit-appearance:none;border:4px solid transparent;background-clip:padding-box;-webkit-border-radius:7px;-moz-border-radius:7px;border-radius:7px;background-color:rgba(0,0,0,.2)}.ab-iam-root.v3 .ab-in-app-message .ab-message-text::-webkit-scrollbar-button{width:0;height:0;display:none}.ab-iam-root.v3 .ab-in-app-message .ab-message-text::-webkit-scrollbar-corner{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-message-header{float:none;letter-spacing:0;margin:0;font-weight:700;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;display:block;font-size:20px;margin-bottom:10px;line-height:1.3}.ab-iam-root.v3 .ab-in-app-message .ab-message-header.start-aligned{text-align:start}.ab-iam-root.v3 .ab-in-app-message .ab-message-header.end-aligned{text-align:end}.ab-iam-root.v3 .ab-in-app-message .ab-message-header.center-aligned{text-align:center}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen,.ab-iam-root.v3 .ab-in-app-message.ab-modal,.ab-iam-root.v3 .ab-in-app-message.ab-slideup{-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;cursor:pointer;overflow:hidden;word-wrap:break-word;text-overflow:ellipsis;font-size:14px;font-weight:700;margin:20px;margin-top:calc(constant(safe-area-inset-top,0) + 20px);margin-right:calc(constant(safe-area-inset-right,0) + 20px);margin-bottom:calc(constant(safe-area-inset-bottom,0) + 20px);margin-left:calc(constant(safe-area-inset-left,0) + 20px);margin-top:calc(env(safe-area-inset-top,0) + 20px);margin-right:calc(env(safe-area-inset-right,0) + 20px);margin-bottom:calc(env(safe-area-inset-bottom,0) + 20px);margin-left:calc(env(safe-area-inset-left,0) + 20px);max-height:150px;padding:10px;right:0;background-color:#efefef}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone{max-height:66px;margin:10px;margin-top:calc(constant(safe-area-inset-top,0) + 10px);margin-right:calc(constant(safe-area-inset-right,0) + 10px);margin-bottom:calc(constant(safe-area-inset-bottom,0) + 10px);margin-left:calc(constant(safe-area-inset-left,0) + 10px);margin-top:calc(env(safe-area-inset-top,0) + 10px);margin-right:calc(env(safe-area-inset-right,0) + 10px);margin-bottom:calc(env(safe-area-inset-bottom,0) + 10px);margin-left:calc(env(safe-area-inset-left,0) + 10px);max-width:90%;max-width:calc(100% - 40px);min-width:90%;min-width:calc(100% - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-close-button{display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-close-button svg:not(.ab-chevron){display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone.ab-clickable .ab-close-button{display:block;height:20px;padding:0 20px 0 18px;pointer-events:none;top:50%;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);width:12px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone.ab-clickable .ab-close-button svg.ab-chevron{display:inline}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone.ab-clickable .ab-message-text{border-right-width:40px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-message-text{max-width:100%;border-right-width:10px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-message-text span{max-height:66px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-message-text.ab-with-icon,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-message-text.ab-with-image{max-width:80%;max-width:calc(100% - 50px - 5px - 10px - 25px)}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-image-area{width:50px;height:50px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-image-area img{max-width:100%;max-height:100%;width:auto;height:auto}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:active .ab-message-text,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:focus .ab-message-text,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:hover .ab-message-text{opacity:.8}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:active .ab-close-button svg.ab-chevron,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:focus .ab-close-button svg.ab-chevron,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:hover .ab-close-button svg.ab-chevron{fill-opacity:.8}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:table-cell;border-color:transparent;border-style:solid;border-width:5px 25px 5px 10px;max-width:430px;vertical-align:middle;margin:0}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text span{display:block;max-height:150px;overflow:auto}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text.ab-with-icon,.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text.ab-with-image{max-width:365px;border-top:0;border-bottom:0}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;background-color:transparent;background-size:15px;border:none;width:15px;min-width:15px;height:15px;cursor:pointer;display:block;font-size:15px;line-height:0;padding-top:15px;padding-right:15px;padding-left:15px;padding-bottom:15px;position:absolute;right:0;top:0;z-index:9021}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button svg{-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease;fill:#9b9b9b;height:auto;width:100%}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button svg.ab-chevron{display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button:active{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button:focus{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button:hover{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button:hover svg{fill-opacity:.8}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area{float:none;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:table-cell;border-color:transparent;border-style:solid;border-width:5px 0 5px 5px;vertical-align:top;width:60px;margin:0}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area.ab-icon-area{width:auto}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area img{float:none;width:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen,.ab-iam-root.v3 .ab-in-app-message.ab-modal{font-size:14px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area{float:none;position:relative;display:block;overflow:hidden}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-image-area .ab-center-cropped-img,.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area .ab-center-cropped-img{background-size:cover;background-repeat:no-repeat;background-position:50% 50%;position:absolute;top:0;right:0;bottom:0;left:0}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-icon,.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-icon{margin-top:20px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic{padding:0}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-message-text,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-message-text{display:none}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-message-buttons,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-message-buttons{bottom:0;left:0}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-image-area{float:none;height:auto;margin:0}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-image-area img,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-image-area img{display:block;top:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none}.ab-iam-root.v3 .ab-in-app-message.ab-modal{padding-top:20px;width:450px;max-width:450px;max-height:720px}.ab-iam-root.v3 .ab-in-app-message.ab-modal.simulate-phone{max-width:91%;max-width:calc(100% - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal.simulate-phone.graphic .ab-image-area img{max-width:91vw;max-width:calc(100vw - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text{max-height:660px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-image{max-height:524.82758621px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-icon{max-height:610px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-buttons{margin-bottom:93px;max-height:587px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-buttons.ab-with-image{max-height:451.82758621px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-buttons.ab-with-icon{max-height:537px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area{margin-top:-20px;max-height:155.17241379px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area img{max-width:100%;max-height:155.17241379px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area.ab-icon-area{height:auto}.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic{width:auto;overflow:hidden}.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-image-area{display:inline}.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-image-area img{width:auto;max-height:720px;max-width:450px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen{width:450px;max-height:720px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape{width:720px;max-height:450px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape .ab-image-area{height:225px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape.graphic .ab-image-area{height:450px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape .ab-message-text{max-height:112px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-message-text{max-height:247px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-message-text.ab-with-buttons{margin-bottom:93px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-image-area{height:360px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-image-area{height:720px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone{-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone:not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone:not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.graphic{display:block}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-html-message{background-color:transparent;border:none;height:100%;overflow:auto;position:relative;touch-action:auto;width:100%}.ab-iam-root.v3 .ab-in-app-message .ab-message-buttons{position:absolute;bottom:0;width:100%;padding:17px 25px 30px 25px;z-index:inherit;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.ab-iam-root.v3 .ab-in-app-message .ab-message-button{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;cursor:pointer;display:inline-block;font-size:14px;font-weight:700;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;height:44px;line-height:normal;letter-spacing:normal;margin:0;max-width:100%;min-width:80px;padding:0 12px;position:relative;text-transform:none;width:48%;width:calc(50% - 5px);border:1px solid #1b78cf;-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease;overflow:hidden;word-wrap:break-word;text-overflow:ellipsis;word-wrap:normal;white-space:nowrap}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:first-of-type{float:left;background-color:#fff;color:#1b78cf}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:last-of-type{float:right;background-color:#1b78cf;color:#fff}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:first-of-type:last-of-type{float:none;width:auto}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:after{-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:hover{opacity:.8}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:active:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.08)}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:focus:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.15)}.ab-iam-root.v3 .ab-in-app-message .ab-message-button a{color:inherit;text-decoration:inherit}.ab-iam-root.v3 .ab-in-app-message img{float:none;display:inline-block}.ab-iam-root.v3 .ab-in-app-message .ab-icon{float:none;display:inline-block;padding:10px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.ab-iam-root.v3 .ab-in-app-message .ab-icon .fa{float:none;font-size:30px;width:30px}.ab-iam-root.v3 .ab-start-hidden{visibility:hidden}.ab-iam-root.v3 .ab-centered{margin:auto;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ab-iam-root.v3{-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.ab-iam-root.v3 .ab-page-blocker{position:fixed;top:0;left:0;width:100%;height:100%;z-index:9001;pointer-events:all;background-color:rgba(51,51,51,.75)}@media (max-width:600px){.ab-iam-root.v3 .ab-in-app-message.ab-slideup{max-height:66px;margin:10px;margin-top:calc(constant(safe-area-inset-top,0) + 10px);margin-right:calc(constant(safe-area-inset-right,0) + 10px);margin-bottom:calc(constant(safe-area-inset-bottom,0) + 10px);margin-left:calc(constant(safe-area-inset-left,0) + 10px);margin-top:calc(env(safe-area-inset-top,0) + 10px);margin-right:calc(env(safe-area-inset-right,0) + 10px);margin-bottom:calc(env(safe-area-inset-bottom,0) + 10px);margin-left:calc(env(safe-area-inset-left,0) + 10px);max-width:90%;max-width:calc(100% - 40px);min-width:90%;min-width:calc(100% - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button{display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button svg:not(.ab-chevron){display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable .ab-close-button{display:block;height:20px;padding:0 20px 0 18px;pointer-events:none;top:50%;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);width:12px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable .ab-close-button svg.ab-chevron{display:inline}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable .ab-message-text{border-right-width:40px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text{max-width:100%;border-right-width:10px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text span{max-height:66px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text.ab-with-icon,.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text.ab-with-image{max-width:80%;max-width:calc(100% - 50px - 5px - 10px - 25px)}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area{width:50px;height:50px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area img{max-width:100%;max-height:100%;width:auto;height:auto}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape{-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-close-button,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen .ab-image-area,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-image-area,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen .ab-message-text,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen .ab-message-text.ab-with-buttons,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-message-text.ab-with-buttons,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape:not(.graphic),.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen:not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape:not(.graphic) .ab-message-buttons,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen:not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.graphic,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.graphic{display:block}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.graphic .ab-image-area,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.graphic .ab-message-button,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}}@media (max-width:480px){.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop){max-width:91%;max-width:calc(100% - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop).graphic .ab-image-area img{max-width:91vw;max-width:calc(100vw - 30px)}}@media (max-height:750px){.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop){max-height:91%;max-height:calc(100% - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop).graphic .ab-image-area img{max-height:91vh;max-height:calc(100vh - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text{max-height:65vh;max-height:calc(100vh - 30px - 60px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-image{max-height:45vh;max-height:calc(100vh - 30px - 155.17241379310346px - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-icon{max-height:45vh;max-height:calc(100vh - 30px - 70px - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-buttons{max-height:50vh;max-height:calc(100vh - 30px - 93px - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-buttons.ab-with-image{max-height:30vh;max-height:calc(100vh - 30px - 155.17241379310346px - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-buttons.ab-with-icon{max-height:30vh;max-height:calc(100vh - 30px - 70px - 93px - 20px)}}@media (min-width:601px){.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-image-area img{max-height:100%;max-width:100%}}@media (max-height:750px) and (min-width:601px){.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop){-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important;width:450px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop) .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop) .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop) .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop):not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop):not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).graphic{display:block}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}}@media (max-height:480px){.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop){-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop):not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop):not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic{display:block}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}}@media (max-width:750px){.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop){-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop):not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop):not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic{display:block}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}}")}function co(){ho();oo()}function el(n){let t="";return n.animateIn&&(t+=" ab-animate-in"),n.animateOut&&(t+=" ab-animate-out"),n instanceof bi?t+=" ab-effect-fullscreen":n instanceof oi?t+=" ab-effect-html":n instanceof ir?t+=" ab-effect-modal":n instanceof ki&&(t+=" ab-effect-slide"),t}function lo(n,t,i){const r=document.createElement("button");r.setAttribute("aria-label",n);r.setAttribute("tabindex","0");r.setAttribute("role","button");ar(r,"touchstart");r.className="ab-close-button";const u=ro("0 0 15 15","M15 1.5L13.5 0l-6 6-6-6L0 1.5l6 6-6 6L1.5 15l6-6 6 6 1.5-1.5-6-6 6-6z",t);return r.appendChild(u),r.addEventListener("keydown",n=>{n.keyCode!==ei.yo&&n.keyCode!==ei.Fo||(i(),n.stopPropagation())}),r.onclick=n=>{i(),n.stopPropagation()},r}function ol(n){return n=parseInt(n),!isNaN(n)&&(4278190080&n)>>>24==0}function vt(n,t){if(n=parseInt(n),isNaN(n))return"";t=parseFloat(t);isNaN(t)&&(t=1);const i=255&(n>>>=0),r=(65280&n)>>>8,u=(16711680&n)>>>16,f=((4278190080&n)>>>24)/255;return it.Og()?"rgba("+[u,r,i,f*t].join(",")+")":"rgb("+[u,r,i].join(",")+")"}function ru(n){if(!i.rr())return!1;if(!(n instanceof f||n instanceof yi))return t.j.error(pu),!1;const r=n instanceof yi?t.q.ro:t.q._i;return ii.m().N(n,r).O}function ao(n){if(!i.rr())return!1;if(!(n instanceof f))return t.j.error(pu),!1;const r=ii.m().N(n,t.q.Ii);if(r){n.Lr()||ru(n);for(let t=0;t<r.ve.length;t++)d.er().je(v.Kr,[n.triggerId],r.ve[t])}return r.O}function sl(){return screen.width<=600}function hl(){if("orientation"in window)return 90===Math.abs(window.orientation)||270===window.orientation?ci.LANDSCAPE:ci.PORTRAIT;if("screen"in window){let n=window.screen.orientation||screen.mozOrientation||screen.msOrientation;return null!=n&&"object"==typeof n&&(n=n.type),"landscape-primary"===n||"landscape-secondary"===n?ci.LANDSCAPE:ci.PORTRAIT}return ci.PORTRAIT}function cl(n,t,i){t||null!=i&&i.metaKey?window.open(n):window.location=n}function ll(){return window.location.href}function lf(){if(i.rr())return i.jr()}function uu(n,r,u){if(i.rr())if(cr.test(n)){const r=du(n);if(!r)return;const u=n=>{if(!de(n))return void t.j.error(`Decoded Braze Action json is invalid: ${JSON.stringify(n,null,2)}`);const f=o.properties.type,e=o.properties.ce,s=o.properties.me,r=n[f];if(r===o.types.le){const t=n[e];for(const n of t)u(n)}else{const f=n[s];let e,u;switch(r){case o.types.logCustomEvent:Promise.resolve().then(function(){return df}).then(({logCustomEvent:n})=>{i.ue()?(u=Array.prototype.slice.call(f),n(...u)):t.j.error(at)});break;case o.types.requestPushPermission:Promise.resolve().then(function(){return ne}).then(({requestPushPermission:n})=>{i.ue()?"Safari"===it.browser&&it.OS===dt.fe?window.navigator.standalone&&n():n():t.j.error(at)});break;case o.types.setEmailNotificationSubscriptionType:case o.types.setPushNotificationSubscriptionType:case o.types.setCustomUserAttribute:case o.types.addToSubscriptionGroup:case o.types.removeFromSubscriptionGroup:case o.types.addToCustomAttributeArray:case o.types.removeFromCustomAttributeArray:(e=lf(),e)&&e[r](...Array.prototype.slice.call(f));break;case o.types.de:case o.types.pe:u=Array.prototype.slice.call(f);li.openUri(...u);break;default:t.j.info(`Ignoring unknown Braze Action: ${r}`)}}};u(r)}else li.openUri(n,r,u)}function al(n,t){uu(n,t)}function fu(n,r,u){if(!i.rr())return!1;if(!(n instanceof oi))return t.j.error("inAppMessage argument to logInAppMessageHtmlClick must be an HtmlMessage object."),!1;let e=t.q.Ii;null!=r&&(e=t.q.Mi);const f=ii.m().N(n,e,r,u);if(f.O)for(let t=0;t<f.ve.length;t++)d.er().je(v.Kr,[n.triggerId,r],f.ve[t]);return f.O}function vo(n){null==n&&(n="");const t=n.split("?").slice(1).join("?"),i={};if(null!=t){const n=t.split("&");for(let t=0;t<n.length;t++){const r=n[t].split("=");""!==r[0]&&(i[r[0]]=r[1])}}return i}function af(n){return!(!n||0!==(n=n.toString().toLowerCase()).lastIndexOf("javascript:",0)&&0!==n.lastIndexOf("data:",0))}function vl(n,r,u,e,o,s){const h=document.createElement("iframe");h.setAttribute("title","Modal Message");o&&(h.style.zIndex=(o+1).toString());const c=t=>{const i=t.getAttribute("href"),r=t.onclick;return u=>{if(null==r||"function"!=typeof r||!1!==r.bind(t)(u)){let o=vo(i).abButtonId;if(null!=o&&""!==o||(o=t.getAttribute("id")||void 0),null!=i&&""!==i&&0!==i.indexOf("#")){const c="blank"===(t.getAttribute("target")||"").toLowerCase().replace("_",""),r=e||n.openTarget===f.OpenTarget.BLANK||c,s=()=>{fu(n,o,i),li.openUri(i,r,u)};r?s():n.he(h,s)}else fu(n,o,i||void 0);return u.stopPropagation(),!1}}},l=(n,t,i)=>{const u=`([\\w]+)\\s*=\\s*document.createElement\\(['"]${i}['"]\\)`,r=n.match(new RegExp(u));if(r){const i=`${r[1]}.setAttribute("nonce", "${t}")`;return`${n.slice(0,r.index+r[0].length)};${i};${n.slice(r.index+r[0].length)}`}return null};if(h.onload=()=>{let a=null;if(null!=s){a=document.createElement("html");a.innerHTML=n.message||"";const i=a.getElementsByTagName("style");for(let n=0;n<i.length;n++)i[n].setAttribute("nonce",s);const t=a.getElementsByTagName("script");for(let n=0;n<t.length;n++){t[n].setAttribute("nonce",s);t[n].innerHTML=t[n].innerHTML.replace(/<style>/g,`<style nonce='${s}'>`);const i=l(t[n].innerHTML,s,"script");i&&(t[n].innerHTML=i);const r=l(t[n].innerHTML,s,"style");r&&(t[n].innerHTML=r)}}const e=h.contentWindow;e.focus();e.document.write(a?a.innerHTML:n.message||"");const v=e.document.getElementsByTagName("head")[0];if(null!=v){if(ho(v),n.ye()){const t=document.createElement("style");t.innerHTML=n.css||"";t.id=n.Ae()||"";null!=s&&t.setAttribute("nonce",s);v.appendChild(t)}const t=e.document.createElement("base");null!=t&&(t.setAttribute("target","_parent"),v.appendChild(t))}const y=e.document.getElementsByTagName("title");y&&y.length>0&&h.setAttribute("title",y[0].textContent||"");const o={closeMessage:function(){n.he(h)},logClick:function(){fu(n,...arguments)},display:{},web:{}},b=function(){return function(){const n=arguments;Promise.resolve().then(function(){return ne}).then(r=>{i.ue()?r.requestPushPermission(...Array.prototype.slice.call(n)):t.j.error(at)})}},k={requestImmediateDataFlush:function(){const n=arguments;Promise.resolve().then(function(){return bs}).then(({requestImmediateDataFlush:r})=>{i.ue()?r(...Array.prototype.slice.call(n)):t.j.error(at)})},logCustomEvent:function(){const n=arguments;Promise.resolve().then(function(){return df}).then(({logCustomEvent:r})=>{if(!i.ue())return void t.j.error(at);r(...Array.prototype.slice.call(n))})},logPurchase:function(){const n=arguments;Promise.resolve().then(function(){return ps}).then(({logPurchase:r})=>{if(!i.ue())return void t.j.error(at);r(...Array.prototype.slice.call(n))})},unregisterPush:function(){const n=arguments;Promise.resolve().then(function(){return fh}).then(({unregisterPush:r})=>{i.ue()?r(...Array.prototype.slice.call(n)):t.j.error(at)})},requestPushPermission:b(),changeUser:function(){const n=arguments;Promise.resolve().then(function(){return as}).then(({changeUser:r})=>{if(!i.ue())return void t.j.error(at);r(...Array.prototype.slice.call(n))})}},tt=function(n){return function(){k[n](...Array.prototype.slice.call(arguments))}};for(const n of ct(k))o[n]=tt(n);const p=["setFirstName","setLastName","setEmail","setGender","setDateOfBirth","setCountry","setHomeCity","setEmailNotificationSubscriptionType","setLanguage","addAlias","setPushNotificationSubscriptionType","setPhoneNumber","setCustomUserAttribute","addToCustomAttributeArray","removeFromCustomAttributeArray","incrementCustomUserAttribute","setCustomLocationAttribute","addToSubscriptionGroup","removeFromSubscriptionGroup"],it=function(n){return function(){const t=lf();t&&t[n](...Array.prototype.slice.call(arguments))}},d={};for(let n=0;n<p.length;n++)d[p[n]]=it(p[n]);o.getUser=function(){return d};const g={showFeed:r},rt=function(t){return function(){const i=arguments;n.he(h,function(){g[t](...Array.prototype.slice.call(i))})}},ut=o.display;for(const n of ct(g))ut[n]=rt(n);const nt={registerAppboyPushMessages:b()},ft=function(n){return function(){nt[n](...Array.prototype.slice.call(arguments))}},et=o.web;for(const n of ct(nt))et[n]=ft(n);if(e.appboyBridge=o,e.brazeBridge=o,n.Ce!==f.Ee.Pe){const n=e.document.getElementsByTagName("a");for(let t=0;t<n.length;t++)n[t].onclick=c(n[t]);const t=e.document.getElementsByTagName("button");for(let n=0;n<t.length;n++)t[n].onclick=c(t[n])}const w=e.document.body;if(null!=w){n.$e()&&(w.id=n.htmlId||"");const t=document.createElement("hidden");t.onclick=o.closeMessage;t.className="ab-programmatic-close-button";w.appendChild(t)}e.dispatchEvent(new CustomEvent("ab.BridgeReady"));-1!==h.className.indexOf("ab-start-hidden")&&(h.className=h.className.replace("ab-start-hidden",""),u(h));document.activeElement!==h&&h.focus()},h.className="ab-in-app-message ab-start-hidden ab-html-message ab-modal-interactions",it.OS===dt.fe){const t=document.createElement("div");return t.className="ab-ios-scroll-wrapper",t.appendChild(h),n.qe=t,t}return n.qe=h,h}function yo(n,r){if(!i.rr())return!1;if(!(n instanceof wi))return t.j.error("button must be an InAppMessageButton object"),!1;if(!(r instanceof f))return t.j.error(pu),!1;const u=ii.m().Oi(n,r);if(u.O)for(let t=0;t<u.ve.length;t++)d.er().je(v.Kr,[r.triggerId,n.id],u.ve[t]);return u.O}function yl(n,i,r,u,e,o,s){if(n.ke=document.activeElement,n instanceof oi)return vl(n,i,r,e,o,s);const h=function(n,i,r,u,e,o){const s=document.createElement("div");s.className="ab-in-app-message ab-start-hidden ab-background";o&&(s.style.zIndex=(o+1).toString());n.xe()&&(s.className+=" ab-modal-interactions",s.setAttribute("tabindex","-1"));n.ye()||(s.style.color=vt(n.textColor),s.style.backgroundColor=vt(n.backgroundColor),ol(n.backgroundColor)&&(s.className+=" ab-no-shadow"));const l=()=>{-1!==s.className.indexOf("ab-start-hidden")&&(s.className=s.className.replace("ab-start-hidden",""),document.querySelectorAll(".ab-iam-img-loading").length>0?u(`Cannot show in-app message ${n.message} because another message is being shown.`,f.Me.ze):r(s))},y=()=>{const n=document.querySelectorAll(".ab-iam-root");n&&n.length>0&&(n[0].classList.remove("ab-iam-img-loading"),l())};n.imageStyle===f.ImageStyle.GRAPHIC&&(s.className+=" graphic");n.orientation===f.Orientation.LANDSCAPE&&(s.className+=" landscape");null!=n.buttons&&0===n.buttons.length&&(n.clickAction!==f.ClickAction.NONE&&(s.className+=" ab-clickable"),s.onclick=t=>(n.he(s,()=>{ao(n),n.clickAction===f.ClickAction.URI?uu(n.uri||"",e||n.openTarget===f.OpenTarget.BLANK,t):n.clickAction===f.ClickAction.NEWS_FEED&&i()}),t.stopPropagation(),!1));const a=lo("Close Message",n.ye()?void 0:vt(n.closeButtonColor),()=>{n.he(s)});s.appendChild(a);o&&(a.style.zIndex=(o+2).toString());const h=document.createElement("div");h.className="ab-message-text";const p=(n.messageAlignment||n.Le).toLowerCase();h.className+=" "+p+"-aligned";let v=!1;const c=document.createElement("div");if(c.className="ab-image-area",n.imageUrl){if(n.cropType===f.CropType.CENTER_CROP){const t=document.createElement("span");t.className="ab-center-cropped-img";t.style.backgroundImage="url("+n.imageUrl+")";t.setAttribute("role","img");t.setAttribute("aria-label","Modal Image");n.Ie(t);c.appendChild(t)}else{const t=document.createElement("img");if(t.setAttribute("src",n.imageUrl),n.Ie(t),0===document.querySelectorAll(".ab-iam-img-loading").length){v=!0;const n=document.querySelectorAll(".ab-iam-root");n&&n.length>0&&n[0].classList.add("ab-iam-img-loading");t.onload=y}setTimeout(l,1e3);c.appendChild(t)}s.appendChild(c);h.className+=" ab-with-image"}else if(n.icon){c.className+=" ab-icon-area";const t=document.createElement("span");t.className="ab-icon";n.ye()||(t.style.backgroundColor=vt(n.iconBackgroundColor),t.style.color=vt(n.iconColor));const i=document.createElement("i");i.className="fa";i.appendChild(document.createTextNode(n.icon));i.setAttribute("aria-hidden","true");t.appendChild(i);c.appendChild(t);s.appendChild(c);h.className+=" ab-with-icon"}if(ar(h,"touchstart"),n.header&&n.header.length>0){const i=document.createElement("h1");i.className="ab-message-header";n.Te=t.Z.Y();i.id=n.Te;const r=(n.headerAlignment||f.TextAlignment.CENTER).toLowerCase();i.className+=" "+r+"-aligned";n.ye()||(i.style.color=vt(n.headerTextColor));i.appendChild(document.createTextNode(n.header));h.appendChild(i)}return h.appendChild(n.Be()),s.appendChild(h),v||l(),n.qe=s,s}(n,i,r,u,e,o);if(n instanceof bi||n instanceof ir){const t=n instanceof bi?"ab-fullscreen":"ab-modal";h.className+=` ${t} ab-centered`;vf.De(n,i,h,e);vf.Ge(h);vf.He(n.Te,h)}else if(n instanceof ki){h.className+=" ab-slideup";const t=h.getElementsByClassName("ab-close-button")[0];if(null!=t){const i=ro("0 0 11.38 19.44","M11.38 9.72l-9.33 9.72L0 17.3l7.27-7.58L0 2.14 2.05 0l9.33 9.72z",n.ye()?void 0:vt(n.closeButtonColor));i.setAttribute("class","ab-chevron");t.appendChild(i)}let i,r;vr(h,ni.W,n=>{h.className+=" ab-swiped-left",null!=t&&null!=t.onclick&&t.onclick(n)});vr(h,ni.X,n=>{h.className+=" ab-swiped-right",null!=t&&null!=t.onclick&&t.onclick(n)});n.slideFrom===f.SlideFrom.TOP?(i=ni.Je,r=" ab-swiped-up"):(i=ni.Ke,r=" ab-swiped-down");vr(h,i,n=>{h.className+=r,null!=t&&null!=t.onclick&&t.onclick(n)})}return h}function po(n,r,u){if(i.rr()){if(co(),null==n)return!1;if(n instanceof yi)return t.j.info("User received control for a multivariate test, logging to Braze servers."),ru(n),!0;if(!(n instanceof f))return!1;const o=ii.m();n.Ah();const h=n instanceof oi;if(h&&!n.trusted&&!i.nr())return t.j.error('HTML in-app messages are disabled. Use the "allowUserSuppliedJavascript" option for braze.initialize to enable these messages.'),o.Ye(n.triggerId,f.Me.Oh),!1;if((null==r&&(r=document.body),n.xe())&&r.querySelectorAll(".ab-modal-interactions").length>0)return t.j.info(`Cannot show in-app message ${n.message} because another message is being shown.`),o.Ye(n.triggerId,f.Me.ze),!1;if(li.no()){const i=li.ao();if(i===ci.PORTRAIT&&n.orientation===f.Orientation.LANDSCAPE||i===ci.LANDSCAPE&&n.orientation===f.Orientation.PORTRAIT){const r=i===ci.PORTRAIT?"portrait":"landscape",u=n.orientation===f.Orientation.PORTRAIT?"portrait":"landscape";return t.j.info(`Not showing ${u} in-app message ${n.message} because the screen is currently ${r}`),o.Ye(n.triggerId,f.Me.Sh),!1}}if(!i.nr()){let i=!1;if(n.buttons&&n.buttons.length>0){const t=n.buttons;for(let n=0;n<t.length;n++)if(t[n].clickAction===f.ClickAction.URI){const r=t[n].uri;i=af(r)}}else n.clickAction===f.ClickAction.URI&&(i=af(n.uri));if(i)return t.j.error('Javascript click actions are disabled. Use the "allowUserSuppliedJavascript" option for braze.initialize to enable these actions.'),o.Ye(n.triggerId,f.Me.Oh),!1}const e=document.createElement("div");if(e.className="ab-iam-root v3",e.className+=el(n),e.setAttribute("role","complementary"),n.$e()&&(e.id=n.htmlId),i.nn(s.mo)&&(e.style.zIndex=i.nn(s.mo)+1),r.appendChild(e),n.ye()){const t=document.createElement("style");t.innerHTML=n.css;t.id=n.Ae();null!=i.nn(s.lo)&&t.setAttribute("nonce",i.nn(s.lo));document.getElementsByTagName("head")[0].appendChild(t)}const c=n instanceof ki,l=yl(n,()=>{Promise.resolve().then(function(){return nh}).then(n=>{i.ue()?n.showFeed():t.j.error(at)})},t=>{if(n.xe()&&n.io()){const r=document.createElement("div");if(r.className="ab-page-blocker",n.ye()||(r.style.backgroundColor=vt(n.frameColor)),i.nn(s.mo)&&(r.style.zIndex=i.nn(s.mo)),e.appendChild(r),!i.nn(s.Lh)){const i=(new Date).valueOf();r.onclick=r=>{(new Date).valueOf()-i>f.Uh&&(n.he(t),r.stopPropagation())}}e.appendChild(t);t.focus();n.ah(e)}else if(c){const r=document.querySelectorAll(".ab-slideup");let i=null;for(let n=r.length-1;n>=0;n--)if(r[n]!==t){i=r[n];break}if(n.slideFrom===f.SlideFrom.TOP){let n=0;null!=i&&(n=i.offsetTop+i.offsetHeight);t.style.top=Math.max(n,0)+"px"}else{let n=0;null!=i&&(n=(window.innerHeight||document.documentElement.clientHeight)-i.offsetTop);t.style.bottom=Math.max(n,0)+"px"}}else if(h&&!i.nn(s.Lh)){const i=n;uo(t)&&t.contentWindow&&t.contentWindow.addEventListener("keydown",function(n){n.keyCode===ei.Ih&&i.closeMessage()})}ru(n);n.dismissType===f.DismissType.AUTO_DISMISS&&setTimeout(()=>{e.contains(t)&&n.he(t)},n.duration);"function"==typeof u&&u()},(i,r)=>{t.j.info(i),o.Ye(n.triggerId,r)},i.nn(s.po),i.nn(s.mo),i.nn(s.lo));return(h||c)&&(e.appendChild(l),n.ah(e)),!0}}function wo(n){if(i.rr())return"function"!=typeof n?null:ii.m().Ve(function(t){return n(t[0]),t.slice(1)})}function pl(){if(i.rr()){co();const n=ii.m();if(null==n.We()){const t=wo(n=>po(n));n.Xe(t)}return n.We()}}function ou(n,u){return!!i.rr()&&(n instanceof r?eu.m().h(n,u).O:(t.j.error("card "+wu),!1))}function ko(n){return!!i.rr()&&(n instanceof r?eu.m().A(n).O:(t.j.error("card "+wu),!1))}function su(n,u){if(!i.rr())return!1;if(!b(n))return t.j.error("cards must be an array"),!1;for(const i of n)if(!(i instanceof r))return t.j.error(`Each card in cards ${wu}`),!1;return eu.m().J(n,u).O}function na(n){return su(n,!0)}function ta(n){return ou(n,!0)}function pf(n,i,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){let g;if(i===r.es.ct||i===r.es.St)g=new ye(n,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k);else if(i===r.es.tt)g=new ve(n,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k);else if(i===r.es.rs)g=new ae(n,u,e,s,h,c,l,a,v,y,p,w,b,k);else{if(i!==r.es.At)return t.j.error("Ignoring card with unknown type "+i),null;g=new sr(n,u,h,l,p,w)}return d&&(g.test=d),g}function wf(n){if(n[r.Tt.It])return null;const u=n[r.Tt.ns],f=n[r.Tt.ts],e=n[r.Tt.ls],o=n[r.Tt.st],s=n[r.Tt.os],h=n[r.Tt.it],t=lt(n[r.Tt.us]),c=t;let i;return i=n[r.Tt.ps]===r.Nt?null:lt(n[r.Tt.ps]),pf(u,f,e,o,s,h,c,t,null,i,n[r.Tt.URL],n[r.Tt.bs],n[r.Tt.fs],n[r.Tt.xs],n[r.Tt.js],n[r.Tt.zs],n[r.Tt.gs],n[r.Tt.ks]||!1)}function ia(n){return pf(n.id,n.type,n.viewed,n.title,n.image,n.description,lt(n.created),lt(n.updated),n.categories,lt(n.expires_at),n.url,n.domain,n.aspect_ratio,n.extras,!1,!1)}function go(n){return pf(n[r.hs.ns],n[r.hs.ts],n[r.hs.ls],n[r.hs.st],n[r.hs.os],n[r.hs.it],vi(n[r.hs.cs]),vi(n[r.hs.us]),n[r.hs.ds],vi(n[r.hs.ps]),n[r.hs.URL],n[r.hs.bs],n[r.hs.fs],n[r.hs.xs],n[r.hs.js],n[r.hs.zs],n[r.hs.gs],n[r.hs.ks]||!1)||void 0}function ns(n,t){if(i.rr())return ur.er().Es(n,t)}function ua(){if(i.rr())return ur.er().As(!1)}function fa(n){return null!=n&&!!n.getAttribute("data-ab-had-top-impression")}function ea(n){null!=n&&n.setAttribute("data-ab-had-top-impression","true")}function oa(n){return null!=n&&!!n.getAttribute("data-ab-had-bottom-impression")}function sa(n){null!=n&&n.setAttribute("data-ab-had-bottom-impression","true")}function ts(n){if(null!=n){const t=n.querySelectorAll(".ab-unread-indicator")[0];null!=t&&(t.className+=" read")}}function ha(n){return n.getAttribute("data-ab-card-id")}function ca(n,t){let i="";n.title||n.description||(i="Feed Image");t.setAttribute("alt",i)}function is(n,t){const r=t.querySelectorAll(".ab-image-area");let i,u=0;r.length>0&&(u=r[0].offsetWidth);for(const t of n)if(i=t._,i&&t.imageUrl&&"number"==typeof t.aspectRatio){const n=u/t.aspectRatio;n&&(i.style.height=`${n}px`)}}function la(n,i,r){const u=document.createElement("div");u.className="ab-card ab-effect-card "+n.U;n.id&&u.setAttribute("data-ab-card-id",n.id);u.setAttribute("role","article");u.setAttribute("tabindex","0");let o="",s=!1;n.url&&""!==n.url&&(o=n.url,s=!0);const h=t=>(ts(u),s&&(i(n),uu(o,r,t)),!1);if(n.pinned){const n=document.createElement("div");n.className="ab-pinned-indicator";const t=document.createElement("i");t.className="fa fa-star";n.appendChild(t);u.appendChild(n)}if(n.imageUrl&&""!==n.imageUrl){const t=document.createElement("div");t.className="ab-image-area";const i=document.createElement("img");if(i.setAttribute("src",n.imageUrl),i.onload=()=>{u.style.height="auto"},ca(n,i),t.appendChild(i),u.className+=" with-image",s&&!n.V){const n=document.createElement("a");n.setAttribute("href",o);n.onclick=h;n.appendChild(t);u.appendChild(n)}else u.appendChild(t)}const f=document.createElement("div");if(f.className="ab-card-body",n.dismissible){n.logCardDismissal=()=>ko(n);const t=lo("Dismiss Card",void 0,n.dismissCard.bind(n));u.appendChild(t);vr(f,ni.W,n=>{u.className+=" ab-swiped-left",t.onclick(n)});vr(f,ni.X,n=>{u.className+=" ab-swiped-right",t.onclick(n)})}let c="",l=!1;if(n.title&&""!==n.title&&(c=n.title,l=!0),l){const n=document.createElement("h1");if(n.className="ab-title",n.id=t.Z.Y(),u.setAttribute("aria-labelledby",n.id),s){const t=document.createElement("a");t.setAttribute("href",o);t.onclick=h;t.appendChild(document.createTextNode(c));n.appendChild(t)}else n.appendChild(document.createTextNode(c));f.appendChild(n)}const e=document.createElement("div");if(e.className=l?"ab-description":"ab-description ab-no-title",e.id=t.Z.Y(),u.setAttribute("aria-describedby",e.id),n.description&&e.appendChild(document.createTextNode(n.description)),s){const i=document.createElement("div");i.className="ab-url-area";const t=document.createElement("a");t.setAttribute("href",o);n.linkText&&t.appendChild(document.createTextNode(n.linkText));t.onclick=h;i.appendChild(t);e.appendChild(i)}f.appendChild(e);u.appendChild(f);const a=document.createElement("div");return a.className="ab-unread-indicator",n.viewed&&(a.className+=" read"),u.appendChild(a),n._=u,u}function rs(n){i.rr()&&i.removeSubscription(n)}function fr(n){n&&(n.className=n.className.replace("ab-show","ab-hide"),setTimeout(()=>{n&&n.parentNode&&n.parentNode.removeChild(n)},di.Th));const t=n.getAttribute("data-update-subscription-id");null!=t&&rs(t)}function fs(n,i){const r=document.createElement("div");if(r.className="ab-feed-body",r.setAttribute("aria-label","Feed"),r.setAttribute("role","feed"),null==n.lastUpdated){const n=document.createElement("div");n.className="ab-no-cards-message";const t=document.createElement("i");t.className="fa fa-spinner fa-spin fa-4x ab-initial-spinner";n.appendChild(t);r.appendChild(n)}else{let u=!1;const f=t=>{n.logCardClick(t)};for(const e of n.cards){const o=e instanceof sr;!o||n.ur()?(r.appendChild(la(e,f,i)),u=u||!o):t.j.error("Received a control card for a legacy news feed. Control cards are only supported with content cards.")}if(!u){const n=document.createElement("div");n.className="ab-no-cards-message";n.innerHTML=pt.m().get("NO_CARDS_MESSAGE");n.setAttribute("role","article");r.appendChild(n)}}return r}function cu(n,t){if(null!=t){const r=[],i=t.querySelectorAll(".ab-card");n.fo||(n.fo={});for(let t=0;t<i.length;t++){const e=ha(i[t]);if(!n.fo[e]){let u=fa(i[t]),f=oa(i[t]);const h=u,c=f,o=il(i[t]),s=rl(i[t]);if(!u&&o&&(u=!0,ea(i[t])),!f&&s&&(f=!0,sa(i[t])),u&&f){if(o||s||ts(i[t]),h&&c)continue;for(const t of n.cards)if(t.id===e){n.fo[t.id]=!0;r.push(t);break}}}}r.length>0&&n.logCardImpressions(r)}}function bf(n,t){t.setAttribute("aria-busy","true");const i=t.querySelectorAll(".ab-refresh-button")[0];null!=i&&(i.className+=" fa-spin");const r=(new Date).valueOf().toString();t.setAttribute("data-last-requested-refresh",r);setTimeout(()=>{if(t.getAttribute("data-last-requested-refresh")===r){const i=t.querySelectorAll(".fa-spin");for(let n=0;n<i.length;n++)i[n].className=i[n].className.replace(/fa-spin/g,"");const n=t.querySelectorAll(".ab-initial-spinner")[0];if(null!=n){const t=document.createElement("span");t.innerHTML=pt.m().get("FEED_TIMEOUT_MESSAGE");n.parentNode.appendChild(t);n.parentNode.removeChild(n)}"true"===t.getAttribute("aria-busy")&&t.setAttribute("aria-busy","false")}},di.uo);n.sr()}function es(n,t){const i=document.createElement("div");i.className="ab-feed ab-hide ab-effect-slide";i.setAttribute("role","dialog");i.setAttribute("aria-label","Feed");i.setAttribute("tabindex","-1");const f=document.createElement("div");f.className="ab-feed-buttons-wrapper";f.setAttribute("role","group");i.appendChild(f);const u=document.createElement("i");u.className="fa fa-times ab-close-button";u.setAttribute("aria-label","Close Feed");u.setAttribute("tabindex","0");u.setAttribute("role","button");const e=n=>{fr(i),n.stopPropagation()};u.addEventListener("keydown",n=>{n.keyCode!==ei.yo&&n.keyCode!==ei.Fo||e(n)});u.onclick=e;const r=document.createElement("i");r.className="fa fa-refresh ab-refresh-button";null==n.lastUpdated&&(r.className+=" fa-spin");r.setAttribute("aria-label","Refresh Feed");r.setAttribute("tabindex","0");r.setAttribute("role","button");const o=t=>{bf(n,i),t.stopPropagation()};return r.addEventListener("keydown",n=>{n.keyCode!==ei.yo&&n.keyCode!==ei.Fo||o(n)}),r.onclick=o,f.appendChild(r),f.appendChild(u),i.appendChild(fs(n,t)),i.onscroll=()=>{cu(n,i)},i}function lu(n,i,u,f,e){if(b(i)){const o=[];for(const n of i)if(n instanceof r){if(n.url&&cr.test(n.url)){let i=du(n.url);if(gu(i)){t.j.error(ku(hr.Ji,"Content Card"));continue}}o.push(n)}if(n.cards=o,n.lastUpdated=u,null!=f)if(f.setAttribute("aria-busy","false"),null==n.lastUpdated)fr(f);else{const t=f.querySelectorAll(".ab-feed-body")[0];if(null!=t){const i=fs(n,e);t.parentNode.replaceChild(i,t);cu(n,i.parentNode)}}}}function os(n,t){t.setAttribute("data-update-subscription-id",n)}function ss(n){if(i.rr()){const t=document.querySelectorAll(".ab-feed");for(let i=0;i<t.length;i++)(null==n||null!=n&&t[i].parentNode===n)&&fr(t[i])}}function va(){if(i.rr())return ge("logContentCardsDisplayed","method"),!0}function hs(n,r){if(i.rr()){so();let h=!1;null==n&&(n=document.body,h=!0);const e=i.nn(s.tn)||i.nn(s.en)||!1,f=ur.er().As(!1);"function"==typeof r&&lu(f,r(f.cards.slice()),f.lastUpdated,null,e);const u=es(f,e),c=ur.er(),l=c.Vt();(null==f.lastUpdated||(new Date).valueOf()-f.lastUpdated.valueOf()>si.mr)&&(null==l||(new Date).valueOf()-l>si.mr)&&(t.j.info(`Cached content cards were older than max TTL of ${si.mr} ms, requesting an update from the server.`),bf(f,u),c.Wt((new Date).valueOf()));const v=(new Date).valueOf(),y=cs(function(n){const t=u.querySelectorAll(".ab-refresh-button")[0];if(null!=t){let n=500,i=n-=(new Date).valueOf()-v;const r=u.getAttribute(us);r&&(i=parseInt(r),isNaN(i)||(n-=(new Date).valueOf()-i));setTimeout(function(){t.className=t.className.replace(/fa-spin/g,"")},Math.max(n,0))}let i=n.cards;"function"==typeof r&&(i=r(i.slice()));lu(f,i,n.lastUpdated,u,e)});os(y,u);const a=function(n){const i=n.querySelectorAll(".ab-feed");let t=null;for(let r=0;r<i.length;r++)i[r].parentNode===n&&(t=i[r]);null!=t?(fr(t),null!=t.parentNode&&t.parentNode.replaceChild(u,t)):n.appendChild(u);setTimeout(function(){u.className=u.className.replace("ab-hide","ab-show")},0);h&&u.focus();cu(f,u);is(f.cards,n)};var o;null!=n?a(n):window.onload=(o=window.onload,function(){"function"==typeof o&&o(new Event("oldLoad"));a(document.body)})}}function cs(n){if(i.rr()){const t=ur.er(),r=t.hi(n);if(!t.Xt()){const n=i.cr();if(n){const i=n.pr(()=>{t.Es()});i&&t.Yt(i)}}return r}}function ya(n,t){i.rr()&&(document.querySelectorAll(".ab-feed").length>0?ss():hs(n,t))}function pa(n){if(i.rr()){if(!b(n))return t.j.error("Cannot set SDK metadata because metadata is not an array."),!1;for(const t of n)if(!st(kf,t,"sdkMetadata contained an invalid value.","BrazeSdkMetadata"))return!1;const r=i.ar();return r&&r.addSdkMetadata(n),!0}}function ls(n,r){if(i.rr()){if(null==n||0===n.length||n!=n)return void t.j.error("changeUser requires a non-empty userId.");if(dr(n)>h.lr)return void t.j.error(`Rejected user id "${n}" because it is longer than ${h.lr} bytes.`);if(null==r||ot(r,"set signature for new user","signature")){const u=i.cr();u&&u.changeUser(n.toString(),i.gr(),r)}}}function wa(){t.j.info("Destroying Braze instance");i.destroy(!0)}function ba(){const r=i.cr();r&&r.requestImmediateDataFlush();const f=new g.ee(null,!0);f.store(u.re,"This-cookie-will-expire-in-"+f.ne());const n=t.zt.Ft;new t.xt(n,t.j).setItem(n.Jt.oe,n.se,!0);i.destroy(!1);i.ae(!0)}function ka(){new g.ee(null,!0).remove(u.re);const n=t.zt.Ft;new t.xt(n,t.j).br(n.Jt.oe,n.se);i.destroy(!1);i.ae(!1)}function da(n){if(i.rr()){null==n&&t.j.error("getDeviceId must be supplied with a callback. e.g., braze.getDeviceId(function(deviceId) {console.log('the device id is ' + deviceId)})");const r=i.ie();"function"==typeof n&&r&&n(r.te().id)}}function ga(n,t){return i.initialize(n,t)}function nv(){return!!new g.ee(null,!0).wr(u.re)}function vs(n,r){if(!i.rr())return!1;if(null==n||n.length<=0)return t.j.error(`logCustomEvent requires a non-empty eventName, got "${n}". Ignoring event.`),!1;if(!et(n,"log custom event","the event name"))return!1;const[e,o]=gr(r,nc,"eventProperties",`log custom event "${n}"`,"event");if(!e)return!1;const f=i.tr();if(f&&f.ge(n))return t.j.info(`Custom Event "${n}" is blocklisted, ignoring.`),!1;const u=y.N(t.q.CustomEvent,{n:n,p:o});if(u.O){t.j.info(`Logged custom event "${n}".`);for(const t of u.ve)d.er().je(v.be,[n,r],t)}return u.O}function ys(n,r,u,f,e){if(!i.rr())return!1;if(null==u&&(u="USD"),null==f&&(f=1),null==n||n.length<=0)return t.j.error(`logPurchase requires a non-empty productId, got "${n}", ignoring.`),!1;if(!et(n,"log purchase","the purchase name"))return!1;if(null==r||isNaN(parseFloat(r.toString())))return t.j.error(`logPurchase requires a numeric price, got ${r}, ignoring.`),!1;const h=parseFloat(r.toString()).toFixed(2);if(null==f||isNaN(parseInt(f.toString())))return t.j.error(`logPurchase requires an integer quantity, got ${f}, ignoring.`),!1;const o=parseInt(f.toString());if(o<1||o>le)return t.j.error(`logPurchase requires a quantity >1 and <${le}, got ${o}, ignoring.`),!1;if(u=null!=u?u.toUpperCase():u,-1===["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BRL","BSD","BTC","BTN","BWP","BYR","BZD","CAD","CDF","CHF","CLF","CLP","CNY","COP","CRC","CUC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EEK","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GGP","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","IMP","INR","IQD","IRR","ISK","JEP","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LTL","LVL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRO","MTL","MUR","MVR","MWK","MXN","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","STD","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","UYU","UZS","VEF","VND","VUV","WST","XAF","XAG","XAU","XCD","XDR","XOF","XPD","XPF","XPT","YER","ZAR","ZMK","ZMW","ZWL"].indexOf(u))return t.j.error(`logPurchase requires a valid currencyCode, got ${u}, ignoring.`),!1;const[l,a]=gr(e,"logPurchase","purchaseProperties",`log purchase "${n}"`,"purchase");if(!l)return!1;const c=i.tr();if(c&&c.Dr(n))return t.j.info(`Purchase "${n}" is blocklisted, ignoring.`),!1;const s=y.N(t.q.Pr,{pid:n,c:u,p:h,q:o,pr:a});if(s.O){t.j.info(`Logged ${o} purchase${o>1?"s":""} of "${n}" for ${u} ${h}.`);for(const t of s.ve)d.er().je(v.Rr,[n,e],t)}return s.O}function tv(){if(i.rr()){const n=i.cr();if(n){n.openSession();const r=t.zt.Ft,u=new t.xt(r,t.j);u.hr(r.Jt.kr,function(i,f){const o=f.lastClick,e=f.trackingString;t.j.info(`Firing push click trigger from ${e} push click at ${o}`);const h=n.vr(o,e),s=function(){d.er().je(v.zr,[e],h)};n.$r(s,s);u.br(r.Jt.kr,i)});u.Mt(r.Jt.yr,function(t){n.Fr(t)})}}}function iv(){i.rr()&&i.removeAllSubscriptions()}function ws(n){if(i.rr()){const t=i.cr();t&&t.requestImmediateDataFlush(n)}}function rv(n){t.j.setLogger(n)}function uv(n){if(!i.rr()||""===n||!ot(n,"set signature","signature",!1))return!1;const t=i.Sr();return!!t&&(t.setSdkAuthenticationSignature(n),!0)}function fv(n){if(i.rr()){const t=i.Sr();if(t)return t.subscribeToSdkAuthenticationFailures(n)}}function ev(){t.j.toggleLogging()}function ov(){if(null==i.l())throw new Error(at);const n=i.l();n&&n.clearData();const r=ct(t.zt);for(let n=0;n<r.length;n++){const i=r[n],u=t.zt[i];new t.xt(u,t.j).clearData()}if(i.rr())for(const n of i.gr())n.clearData(!0)}function ks(){if(i.rr())return yr.er().Es()}function hv(){if(i.rr())return yr.er().Ei()}function ds(){if(i.rr()){const n=document.querySelectorAll(".ab-feed");for(let t=0;t<n.length;t++)fr(n[t])}}function gs(){if(i.rr()){const n=i.ar();if(n)return n.qr(t.Cr.Ar).O}}function gf(n,r,u){if(i.rr()){so();const o=(n,t)=>{if(null==t)return n;const i=[];for(let n=0;n<t.length;n++)i.push(t[n].toLowerCase());const r=[];for(let t=0;t<n.length;t++){const u=[],f=n[t].categories||[];for(let n=0;n<f.length;n++)u.push(f[n].toLowerCase());bh(u,i).length>0&&r.push(n[t])}return r},h=i.nn(s.tn)||i.nn(s.en)||!1;let l=!1;null==n&&(n=document.body,l=!0);let a=!1,f=null;null==r?(f=yr.er().Ei(),lu(f,o(f.cards,u),f.lastUpdated,null,h),a=!0):f=new gi(o(r,u),new Date);const e=es(f,h);if(a){(null==f.lastUpdated||(new Date).valueOf()-f.lastUpdated.valueOf()>gi.mr)&&(t.j.info(`Cached feed was older than max TTL of ${gi.mr} ms, requesting an update from the server.`),bf(f,e));const n=(new Date).valueOf(),i=th(function(t){const i=e.querySelectorAll(".ab-refresh-button")[0];if(null!=i){let t=500;t-=(new Date).valueOf()-n;const r=e.getAttribute(us);if(r){const n=parseInt(r);isNaN(n)||(t-=(new Date).valueOf()-n)}setTimeout(function(){i.className=i.className.replace(/fa-spin/g,"")},Math.max(t,0))}lu(f,o(t.cards,u),t.lastUpdated,e,h)});os(i,e)}const v=n=>{const i=n.querySelectorAll(".ab-feed");let t=null;for(let r=0;r<i.length;r++)i[r].parentNode===n&&(t=i[r]);null!=t?(fr(t),t.parentNode&&t.parentNode.replaceChild(e,t)):n.appendChild(e);setTimeout(function(){e.className=e.className.replace("ab-hide","ab-show")},0);l&&e.focus();gs();cu(f,e);f&&is(f.cards,n)};var c;null!=n?v(n):window.onload=(c=window.onload,function(){"function"==typeof c&&c(new Event("oldLoad"));v(document.body)})}}function th(n){if(i.rr())return yr.er().hi(n)}function cv(n,t,r){i.rr()&&(document.querySelectorAll(".ab-feed").length>0?ds():gf(n,t,r))}function lv(){if(i.rr())return rt.isPushBlocked()}function av(){if(i.rr())return rt.isPushPermissionGranted()}function vv(){if(i.rr())return rt.isPushSupported()}function rh(n,t){if(i.rr())return vu.m().subscribe((t,r,u)=>{const f=i.cr();f&&f.requestImmediateDataFlush();"function"==typeof n&&n(t,r,u)},t)}function uh(n,t){if(i.rr())return vu.m().unsubscribe(n,t)}function yv(n){if(n[p.Tt.ns]&&"boolean"==typeof n[p.Tt.Fe])return new p(n[p.Tt.ns],n[p.Tt.Fe],n[p.Tt.we]);t.j.info(`Unable to create feature flag from ${JSON.stringify(n,null,2)}`)}function pv(n){if(n[p.hs.ns]&&"boolean"==typeof n[p.hs.Fe])return new p(n[p.hs.ns],n[p.hs.Fe],n[p.hs.we]);t.j.info(`Unable to deserialize feature flag from ${JSON.stringify(n,null,2)}`)}function eh(n,t,r=!1){if(i.rr())return pr.er().refreshFeatureFlags(n,t,r)}function oh(n,t){eh(n,t)}function bv(n){if(i.rr()){const r=i.tr();if(r&&!r.bi())return t.j.info("Feature flags are not enabled."),new p(n);const u=pr.er().Ti();return u[n]?u[n]:new p(n)}}function sh(){if(i.rr()){const n=[],r=i.tr();if(r&&!r.bi())return t.j.info("Feature flags are not enabled."),n;const u=pr.er().Ti();for(const t in u)n.push(u[t]);return n}}function kv(n){if(i.rr()){const t=sh();return t&&"function"==typeof n&&n(t),pr.er().hi(n)}}function gv(){return re}function ny(n){var t=[kt,ie].join("-");if(!n){window.console.log("You must pass a config object to register the kit "+t);return}if(!oe(n)){window.console.log("'config' must be an object. You passed in a "+typeof n);return}oe(n.kits)?n.kits[t]={constructor:fe}:(n.kits={},n.kits[t]={constructor:fe});window.console.log("Successfully registered "+t+" to your mParticle configuration")}function ee(){for(var r,t,n,u={},i=0;i<arguments.length;i+=1)for(r=arguments[i],t=Object.keys(r),n=0;n<t.length;n+=1)u[t[n]]=r[t[n]];return u}function oe(n){return n!=null&&typeof n=="object"&&Array.isArray(n)===!1}var se,t,c,hi,rt,v,ii,y,eu,ur,hu,kf,as,df,ps,bs,yr,nh,vu,ih,ne,fh,pr,te,hh,ch,ah;const yh={Wn:function(n){const r=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=atob(r),i=new Uint8Array(t.length);for(let n=0;n<t.length;++n)i[n]=t.charCodeAt(n);return i}},ph={Y:()=>{const n=n=>{const t=(Math.random().toString(16)+"000000000").substr(2,8);return n?"-"+t.substr(0,4)+"-"+t.substr(4,4):t};return n()+n(!0)+n(!0)+n()}};class yu{constructor(n,t){this.td="undefined"==typeof window?self:window;this.ed=n;this.nd=t}od(){if("indexedDB"in this.td)return this.td.indexedDB}rd(){try{if(null==this.od())return!1;{const n=this.od().open("Braze IndexedDB Support Test");if(n.onupgradeneeded=()=>n.result.close(),n.onsuccess=()=>n.result.close(),"undefined"!=typeof window){const n=window.chrome||window.browser||window.msBrowser;if(n&&n.runtime&&n.runtime.id)return this.nd.info("Not using IndexedDB for storage because we are running inside an extension"),!1}return!0}}catch(n){return this.nd.info("Not using IndexedDB for storage due to following error: "+n),!1}}sd(n,t){const r=this.od().open(this.ed.dd,this.ed.VERSION);if(null==r)return"function"==typeof t&&t(),!1;const i=this;return r.onupgradeneeded=n=>{i.nd.info("Upgrading indexedDB "+i.ed.dd+" to v"+i.ed.VERSION+"...");const t=n.target.result;for(const n in i.ed.Jt)i.ed.Jt.hasOwnProperty(n)&&!t.objectStoreNames.contains(i.ed.Jt[n])&&t.createObjectStore(i.ed.Jt[n])},r.onsuccess=r=>{const u=r.target.result;u.onversionchange=()=>{u.close(),"function"==typeof t&&t(),i.nd.error("Needed to close the database unexpectedly because of an upgrade in another tab")};n(u)},r.onerror=n=>(i.nd.info("Could not open indexedDB "+i.ed.dd+" v"+i.ed.VERSION+": "+n.target.errorCode),"function"==typeof t&&t(),!0),!0}setItem(n,t,i,r,u){if(!this.rd())return"function"==typeof u&&u(),!1;const f=this;return this.sd(e=>{if(!e.objectStoreNames.contains(n))return f.nd.error("Could not store object "+t+" in "+n+" on indexedDB "+f.ed.dd+" - "+n+" is not a valid objectStore"),"function"==typeof u&&u(),void e.close();const o=e.transaction([n],"readwrite");o.oncomplete=()=>e.close();const s=o.objectStore(n).put(i,t);s.onerror=()=>{f.nd.error("Could not store object "+t+" in "+n+" on indexedDB "+f.ed.dd),"function"==typeof u&&u()};s.onsuccess=()=>{"function"==typeof r&&r()}},u)}getItem(n,t,i){if(!this.rd())return!1;const r=this;return this.sd(u=>{if(!u.objectStoreNames.contains(n))return r.nd.error("Could not retrieve object "+t+" in "+n+" on indexedDB "+r.ed.dd+" - "+n+" is not a valid objectStore"),void u.close();const f=u.transaction([n],"readonly");f.oncomplete=()=>u.close();const e=f.objectStore(n).get(t);e.onerror=()=>{r.nd.error("Could not retrieve object "+t+" in "+n+" on indexedDB "+r.ed.dd)};e.onsuccess=n=>{const t=n.target.result;null!=t&&i(t)}})}hr(n,t,i){if(!this.rd())return"function"==typeof i&&i(),!1;const r=this;return this.sd(u=>{if(!u.objectStoreNames.contains(n))return r.nd.error("Could not retrieve last record from "+n+" on indexedDB "+r.ed.dd+" - "+n+" is not a valid objectStore"),"function"==typeof i&&i(),void u.close();const f=u.transaction([n],"readonly");f.oncomplete=()=>u.close();const e=f.objectStore(n).openCursor(null,"prev");e.onerror=()=>{r.nd.error("Could not open cursor for "+n+" on indexedDB "+r.ed.dd),"function"==typeof i&&i()};e.onsuccess=n=>{const r=n.target.result;null!=r&&null!=r.value&&null!=r.key?t(r.key,r.value):"function"==typeof i&&i()}},i)}br(n,t){if(!this.rd())return!1;const i=this;return this.sd(r=>{if(!r.objectStoreNames.contains(n))return i.nd.error("Could not delete record "+t+" from "+n+" on indexedDB "+i.ed.dd+" - "+n+" is not a valid objectStore"),void r.close();const u=r.transaction([n],"readwrite");u.oncomplete=()=>r.close();u.objectStore(n).delete(t).onerror=()=>{i.nd.error("Could not delete record "+t+" from "+n+" on indexedDB "+i.ed.dd)}})}Mt(n,t){if(!this.rd())return!1;const i=this;return this.sd(r=>{if(!r.objectStoreNames.contains(n))return i.nd.error("Could not retrieve objects from "+n+" on indexedDB "+i.ed.dd+" - "+n+" is not a valid objectStore"),void r.close();const f=r.transaction([n],"readwrite");f.oncomplete=()=>r.close();const e=f.objectStore(n),o=e.openCursor(),u=[];o.onerror=()=>{u.length>0?(i.nd.info("Cursor closed midway through for "+n+" on indexedDB "+i.ed.dd),t(u)):i.nd.error("Could not open cursor for "+n+" on indexedDB "+i.ed.dd)};o.onsuccess=n=>{const i=n.target.result;null!=i?(null!=i.value&&null!=i.key&&(e.delete(i.key).onsuccess=()=>{u.push(i.value)}),i.continue()):u.length>0&&t(u)}})}clearData(){if(!this.rd())return!1;const n=[];for(const t in this.ed.Jt)this.ed.Jt.hasOwnProperty(t)&&this.ed.Jt[t]!==this.ed.Jt.oe&&n.push(this.ed.Jt[t]);const t=this;return this.sd(function(i){const r=i.transaction(n,"readwrite");r.oncomplete=()=>i.close();for(let i=0;i<n.length;i++){const u=n[i];r.objectStore(u).clear().onerror=function(){t.nd.error("Could not clear "+this.source.name+" on indexedDB "+t.ed.dd)}}r.onerror=function(){t.nd.error("Could not clear object stores on indexedDB "+t.ed.dd)}})}}yu.ep={Ft:{dd:"AppboyServiceWorkerAsyncStorage",VERSION:6,Jt:{Xa:"data",kr:"pushClicks",cu:"pushSubscribed",ud:"fallbackDevice",qt:"cardUpdates",oe:"optOut",yr:"pendingData",gu:"sdkAuthenticationSignature"},se:1}};const a={init:function(n){void 0===n&&void 0!==a.zg||(a.zg=!!n);a.Eg||(a.Eg=!0)},destroy:function(){a.Eg=!1;a.zg=void 0;a.nd=void 0},setLogger:function(n){"function"==typeof n?(a.init(),a.nd=n):a.info("Ignoring setLogger call since logger is not a function")},toggleLogging:function(){a.init();a.zg?(console.log("Disabling Braze logging"),a.zg=!1):(console.log("Enabled Braze logging"),a.zg=!0)},info:function(n){if(a.zg){const t="Braze: "+n;null!=a.nd?a.nd(t):console.log(t)}},warn:function(n){if(a.zg){const t="Braze SDK Warning: "+n+" (v4.8.0)";null!=a.nd?a.nd(t):console.warn(t)}},error:function(n){if(a.zg){const t="Braze SDK Error: "+n+" (v4.8.0)";null!=a.nd?a.nd(t):console.error(t)}}};se={ho:"allowCrawlerActivity",Eo:"baseUrl",_o:"noCookies",Io:"devicePropertyAllowlist",ia:"disablePushTokenMaintenance",Ao:"enableLogging",So:"enableSdkAuthentication",ta:"manageServiceWorkerExternally",No:"minimumIntervalBetweenTriggerActionsInSeconds",wo:"sessionTimeoutInSeconds",To:"appVersion",na:"serviceWorkerLocation",ra:"safariWebsitePushId",Mn:"localization",lo:"contentSecurityNonce",Oo:"enableHtmlInAppMessages",Co:"allowUserSuppliedJavascript",mo:"inAppMessageZIndex",po:"openInAppMessagesInNewTab",en:"openNewsFeedCardsInNewTab",Lh:"requireExplicitInAppMessageDismissal",Lo:"doNotLoadFontAwesome",Po:"sdkFlavor",tn:"openCardsInNewTab"};const wh={_n:yh,q:{CustomEvent:"ce",Pr:"p",Rl:"pc",cc:"ca",ya:"i",Is:"ie",P:"cci",T:"ccic",$:"ccc",H:"ccd",Vh:"ss",Fh:"se",_i:"si",Ii:"sc",Mi:"sbc",Ze:"sfe",ro:"iec",Pl:"lr",Ll:"uae",R:"ci",B:"cc",Nl:"lcaa",Ml:"lcar",Rn:"inc",Bn:"add",Ln:"rem",Fn:"set",$n:"ncam",Ol:"sgu"},Cr:{Ar:"feed_displayed",dc:"content_cards_displayed"},Z:ph,xt:yu,zt:yu.ep,j:a,Jo:se};t=wh;const le=100,pu="inAppMessage must be an InAppMessage object",wu="must be a Card object",gh=500,nc="logCustomEvent",nr="setCustomUserAttribute",at="Braze must be initialized before calling methods.",tc=5,ic=90,rc=72e5,uc=3;class k{constructor(){this.zo={}}lt(n){if("function"!=typeof n)return null;const i=t.Z.Y();return this.zo[i]=n,i}removeSubscription(n){delete this.zo[n]}removeAllSubscriptions(){this.zo={}}fu(){return Object.keys(this.zo).length}Et(n){const t=[];for(let i in this.zo)t.push(this.zo[i](n));return t}}class r{constructor(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.id=n;this.viewed=t;this.title=i;this.imageUrl=r;this.description=u;this.created=f;this.updated=e;this.categories=o;this.expiresAt=s;this.url=h;this.linkText=c;this.aspectRatio=l;this.extras=a;this.pinned=v;this.dismissible=y;this.clicked=p;this.id=n;this.viewed=t||!1;this.title=i||"";this.imageUrl=r;this.description=u||"";this.created=f||null;this.updated=e||null;this.categories=o||[];this.expiresAt=s||null;this.url=h;this.linkText=c;null==l?this.aspectRatio=null:(l=parseFloat(l.toString()),this.aspectRatio=isNaN(l)?null:l);this.extras=a||{};this.pinned=v||!1;this.dismissible=y||!1;this.dismissed=!1;this.clicked=p||!1;this.isControl=!1;this.test=!1;this.ht=null;this.nt=null}subscribeToClickedEvent(n){return this.et().lt(n)}subscribeToDismissedEvent(n){return this.rt().lt(n)}removeSubscription(n){this.et().removeSubscription(n);this.rt().removeSubscription(n)}removeAllSubscriptions(){this.et().removeAllSubscriptions();this.rt().removeAllSubscriptions()}dismissCard(){if(this.dismissible&&!this.dismissed){"function"==typeof this.logCardDismissal&&this.logCardDismissal();const n=this._;n&&(n.style.height=n.offsetHeight+"px",n.className=n.className+" ab-hide",setTimeout(function(){n&&n.parentNode&&(n.style.height="0",n.style.margin="0",setTimeout(function(){n&&n.parentNode&&n.parentNode.removeChild(n)},r.ut))},gh))}}et(){return null==this.ht&&(this.ht=new k),this.ht}rt(){return null==this.nt&&(this.nt=new k),this.nt}M(){this.viewed=!0}p(){this.viewed=!0;this.clicked=!0;this.et().Et()}F(){return!(!this.dismissible||this.dismissed)&&(this.dismissed=!0,this.rt().Et(),!0)}ot(n){if(null==n||n[r.Tt.ns]!==this.id)return!0;if(n[r.Tt.It])return!1;if(null!=n[r.Tt.us]&&null!=this.updated&&parseInt(n[r.Tt.us])<or(this.updated.valueOf()))return!0;if(n[r.Tt.ls]&&!this.viewed&&(this.viewed=!0),n[r.Tt.gs]&&!this.clicked&&(this.clicked=n[r.Tt.gs]),null!=n[r.Tt.st]&&(this.title=n[r.Tt.st]),null!=n[r.Tt.os]&&(this.imageUrl=n[r.Tt.os]),null!=n[r.Tt.it]&&(this.description=n[r.Tt.it]),null!=n[r.Tt.us]){const t=lt(n[r.Tt.us]);null!=t&&(this.updated=t)}if(null!=n[r.Tt.ps]){let t;t=n[r.Tt.ps]===r.Nt?null:lt(n[r.Tt.ps]);this.expiresAt=t}if(null!=n[r.Tt.URL]&&(this.url=n[r.Tt.URL]),null!=n[r.Tt.bs]&&(this.linkText=n[r.Tt.bs]),null!=n[r.Tt.fs]){const t=parseFloat(n[r.Tt.fs].toString());this.aspectRatio=isNaN(t)?null:t}return null!=n[r.Tt.xs]&&(this.extras=n[r.Tt.xs]),null!=n[r.Tt.js]&&(this.pinned=n[r.Tt.js]),null!=n[r.Tt.zs]&&(this.dismissible=n[r.Tt.zs]),null!=n[r.Tt.ks]&&(this.test=n[r.Tt.ks]),!0}ss(){throw new Error("Must be implemented in a subclass");}}r.Nt=-1;r.Tt={ns:"id",ls:"v",zs:"db",It:"r",us:"ca",js:"p",ps:"ea",xs:"e",ts:"tp",os:"i",st:"tt",it:"ds",URL:"u",bs:"dm",fs:"ar",gs:"cl",ks:"t"};r.es={tt:"captioned_image",ct:"text_announcement",St:"short_news",rs:"banner_image",At:"control"};r.hs={ns:"id",ls:"v",zs:"db",cs:"cr",us:"ca",js:"p",ds:"t",ps:"ea",xs:"e",ts:"tp",os:"i",st:"tt",it:"ds",URL:"u",bs:"dm",fs:"ar",gs:"cl",ks:"s"};r.Dt={dt:"ADVERTISING",Ct:"ANNOUNCEMENTS",Rt:"NEWS",bt:"SOCIAL"};r.ut=400;class ae extends r{constructor(n,t,i,r,u,f,e,o,s,h,c,l,a,v){super(n,t,null,i,null,r,u,f,e,o,s,h,c,l,a,v);this.U="ab-banner";this.V=!1;this.test=!1}ss(){const n={};return n[r.hs.ts]=r.es.rs,n[r.hs.ns]=this.id,n[r.hs.ls]=this.viewed,n[r.hs.os]=this.imageUrl,n[r.hs.us]=this.updated,n[r.hs.cs]=this.created,n[r.hs.ds]=this.categories,n[r.hs.ps]=this.expiresAt,n[r.hs.URL]=this.url,n[r.hs.bs]=this.linkText,n[r.hs.fs]=this.aspectRatio,n[r.hs.xs]=this.extras,n[r.hs.js]=this.pinned,n[r.hs.zs]=this.dismissible,n[r.hs.gs]=this.clicked,n[r.hs.ks]=this.test,n}}class ve extends r{constructor(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){super(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p);this.U="ab-captioned-image";this.V=!0;this.test=!1}ss(){const n={};return n[r.hs.ts]=r.es.tt,n[r.hs.ns]=this.id,n[r.hs.ls]=this.viewed,n[r.hs.st]=this.title,n[r.hs.os]=this.imageUrl,n[r.hs.it]=this.description,n[r.hs.us]=this.updated,n[r.hs.cs]=this.created,n[r.hs.ds]=this.categories,n[r.hs.ps]=this.expiresAt,n[r.hs.URL]=this.url,n[r.hs.bs]=this.linkText,n[r.hs.fs]=this.aspectRatio,n[r.hs.xs]=this.extras,n[r.hs.js]=this.pinned,n[r.hs.zs]=this.dismissible,n[r.hs.gs]=this.clicked,n[r.hs.ks]=this.test,n}}class ye extends r{constructor(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){super(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p);this.U="ab-classic-card";this.V=!0}ss(){const n={};return n[r.hs.ts]=r.es.St,n[r.hs.ns]=this.id,n[r.hs.ls]=this.viewed,n[r.hs.st]=this.title,n[r.hs.os]=this.imageUrl,n[r.hs.it]=this.description,n[r.hs.us]=this.updated,n[r.hs.cs]=this.created,n[r.hs.ds]=this.categories,n[r.hs.ps]=this.expiresAt,n[r.hs.URL]=this.url,n[r.hs.bs]=this.linkText,n[r.hs.fs]=this.aspectRatio,n[r.hs.xs]=this.extras,n[r.hs.js]=this.pinned,n[r.hs.zs]=this.dismissible,n[r.hs.gs]=this.clicked,n[r.hs.ks]=this.test,n}}class sr extends r{constructor(n,t,i,r,u,f){super(n,t,null,null,null,null,i,null,r,null,null,null,u,f);this.isControl=!0;this.U="ab-control-card";this.V=!1}ss(){const n={};return n[r.hs.ts]=r.es.At,n[r.hs.ns]=this.id,n[r.hs.ls]=this.viewed,n[r.hs.us]=this.updated,n[r.hs.ps]=this.expiresAt,n[r.hs.xs]=this.extras,n[r.hs.js]=this.pinned,n[r.hs.ks]=this.test,n}}class pe{constructor(){}tf(){}ef(){}ua(){}static rf(n,t){if(n&&t)if(n=n.toLowerCase(),b(t.if)){for(let i=0;i<t.if.length;i++)if(-1!==n.indexOf(t.if[i].toLowerCase()))return t.identity}else if(-1!==n.indexOf(t.if.toLowerCase()))return t.identity}}const tt={OE:"Chrome",RE:"Edge",Pg:"Internet Explorer",IE:"Opera",kg:"Safari",AE:"Firefox"},dt={Fg:"Android",fe:"iOS",jg:"Mac",Dg:"Windows"};class we extends pe{constructor(){if(super(),this.userAgentData=navigator.userAgentData,this.userAgentData){const n=this.ic();this.browser=n.browser||"Unknown Browser";this.version=n.version||"Unknown Version"}}tf(){return this.browser}ef(){return this.version}ua(n){if(this.OS)return Promise.resolve(this.OS);const t=t=>{for(let i=0;i<n.length;i++){const r=we.rf(t,n[i]);if(r)return this.OS=r,this.OS}return t};return this.userAgentData.platform?Promise.resolve(t(this.userAgentData.platform)):this.nc().then(n=>t(n.platform)).catch(()=>navigator.platform)}ic(){const n={},t=this.userAgentData.brands;if(t&&t.length)for(const i of t){const r=this.oc(tt),t=i.brand.match(r);if(t&&t.length>0){n.browser=t[0];n.version=i.version;break}}return n}oc(n){const t=[];for(const i in n)n[i]!==tt.Pg&&t.push(n[i]);return new RegExp("("+t.join("|")+")","i")}nc(){return this.userAgentData.getHighEntropyValues?this.userAgentData.getHighEntropyValues(["platform"]):Promise.reject()}}class bu extends pe{constructor(){super();this.Vu=bu.Uu(navigator.userAgent||"")}tf(){return this.Vu[0]||"Unknown Browser"}ef(){return this.Vu[1]||"Unknown Version"}ua(n){for(let t=0;t<n.length;t++){let r=n[t].string,i=bu.rf(r,n[t]);if(i)return i===dt.jg&&navigator.maxTouchPoints>1&&(i=dt.fe),Promise.resolve(i)}return Promise.resolve(navigator.platform)}static Uu(n){let t,i=n.match(/(samsungbrowser|tizen|roku|konqueror|icab|crios|opera|ucbrowser|chrome|safari|firefox|camino|msie|trident(?=\/))\/?\s*(\.?\d+(\.\d+)*)/i)||[];if(/trident/i.test(i[1]))return t=/\brv[ :]+(\.?\d+(\.\d+)*)/g.exec(n)||[],[tt.Pg,t[1]||""];if(-1!==n.indexOf("(Web0S; Linux/SmartTV)"))return["LG Smart TV",null];if(-1!==n.indexOf("CrKey"))return["Chromecast",null];if(-1!==n.indexOf("BRAVIA")||-1!==n.indexOf("SonyCEBrowser")||-1!==n.indexOf("SonyDTV"))return["Sony Smart TV",null];if(-1!==n.indexOf("PhilipsTV"))return["Philips Smart TV",null];if(n.match(/\b(Roku)\b/))return["Roku",null];if(n.match(/\bAFTM\b/))return["Amazon Fire Stick",null];if(i[1]===tt.OE&&(t=n.match(/\b(OPR|Edge|EdgA|Edg|UCBrowser)\/(\.?\d+(\.\d+)*)/),null!=t))return t=t.slice(1),t[0]=t[0].replace("OPR",tt.IE),t[0]=t[0].replace("EdgA",tt.RE),"Edg"===t[0]&&(t[0]=tt.RE),[t[0],t[1]];if(i[1]===tt.kg&&(t=n.match(/\b(EdgiOS)\/(\.?\d+(\.\d+)*)/),null!=t))return t=t.slice(1),t[0]=t[0].replace("EdgiOS",tt.RE),[t[0],t[1]];if(i=i[2]?[i[1],i[2]]:[null,null],i[0]===tt.kg&&null!=(t=n.match(/version\/(\.?\d+(\.\d+)*)/i))&&i.splice(1,1,t[1]),null!=(t=n.match(/\b(UCBrowser)\/(\.?\d+(\.\d+)*)/))&&i.splice(1,1,t[2]),i[0]===tt.IE&&null!=(t=n.match(/mini\/(\.?\d+(\.\d+)*)/i)))return["Opera Mini",t[1]||""];if(i[0]){const n=i[0].toLowerCase();"msie"===n&&(i[0]=tt.Pg);"crios"===n&&(i[0]=tt.OE);"tizen"===n&&(i[0]="Samsung Smart TV",i[1]=null);"samsungbrowser"===n&&(i[0]="Samsung Browser")}return i}}class kr{constructor(){const n=navigator.userAgentData?we:bu;this.Sg=new n;this.userAgent=navigator.userAgent;this.browser=this.Sg.tf();this.version=this.Sg.ef();this.ua().then(n=>this.OS=n);this.language=(navigator.userLanguage||navigator.language||navigator.browserLanguage||navigator.systemLanguage||"").toLowerCase();this.$o=kr.Bg(this.userAgent)}Og(){return this.browser!==tt.Pg||this.version>8}rE(){return this.browser===tt.kg}la(){return this.OS||null}ua(){return this.OS?Promise.resolve(this.OS):this.Sg.ua(kr.xg).then(n=>(this.OS=n,n))}static Bg(n){n=n.toLowerCase();const t=["googlebot","bingbot","slurp","duckduckbot","baiduspider","yandex","facebookexternalhit","sogou","ia_archiver","https://github.com/prerender/prerender","aolbuild","bingpreview","msnbot","adsbot","mediapartners-google","teoma"];for(let i=0;i<t.length;i++)if(-1!==n.indexOf(t[i]))return!0;return!1}}kr.xg=[{string:navigator.platform,"if":"Win",identity:dt.Dg},{string:navigator.platform,"if":"Mac",identity:dt.jg},{string:navigator.platform,"if":"BlackBerry",identity:"BlackBerry"},{string:navigator.platform,"if":"FreeBSD",identity:"FreeBSD"},{string:navigator.platform,"if":"OpenBSD",identity:"OpenBSD"},{string:navigator.platform,"if":"Nintendo",identity:"Nintendo"},{string:navigator.platform,"if":"SunOS",identity:"SunOS"},{string:navigator.platform,"if":"PlayStation",identity:"PlayStation"},{string:navigator.platform,"if":"X11",identity:"X11"},{string:navigator.userAgent,"if":["iPhone","iPad","iPod"],identity:dt.fe},{string:navigator.platform,"if":"Pike v",identity:dt.fe},{string:navigator.userAgent,"if":["Web0S"],identity:"WebOS"},{string:navigator.platform,"if":["Linux armv7l","Android"],identity:dt.Fg},{string:navigator.userAgent,"if":["Android"],identity:dt.Fg},{string:navigator.platform,"if":"Linux",identity:"Linux"}];const it=new kr;class ft{constructor(n,t,i,r,u){this.userId=n;this.type=t;this.time=dh(i);this.sessionId=r;this.data=u}Wi(){const n={name:this.type,time:or(this.time),data:this.data||{},session_id:this.sessionId};return null!=this.userId&&(n.user_id=this.userId),n}ss(){return{u:this.userId,t:this.type,ts:this.time,s:this.sessionId,d:this.data}}static fromJson(n){return new ft(n.user_id,n.name,n.time,n.session_id,n.data)}static Za(n){return null!=n&&er(n)&&null!=n.t&&""!==n.t}static Tn(n){return new ft(n.u,n.t,n.ts,n.s,n.d)}}class tr{constructor(n,i,r){null==n&&(n=t.Z.Y());r=parseInt(r);(isNaN(r)||0===r)&&(r=(new Date).valueOf());this.iu=n;this.Hh=r;this.Jh=(new Date).valueOf();this.Bh=i}ss(){return{g:this.iu,e:this.Bh,c:this.Hh,l:this.Jh}}static Tn(n){if(null==n||null==n.g)return null;const t=new tr(n.g,n.e,n.c);return t.Jh=n.l,t}}const o={types:{le:"container",logCustomEvent:"logCustomEvent",setEmailNotificationSubscriptionType:"setEmailNotificationSubscriptionType",setPushNotificationSubscriptionType:"setPushNotificationSubscriptionType",setCustomUserAttribute:"setCustomUserAttribute",requestPushPermission:"requestPushPermission",addToSubscriptionGroup:"addToSubscriptionGroup",removeFromSubscriptionGroup:"removeFromSubscriptionGroup",addToCustomAttributeArray:"addToCustomAttributeArray",removeFromCustomAttributeArray:"removeFromCustomAttributeArray",de:"openLink",pe:"openLinkInWebView"},properties:{type:"type",ce:"steps",me:"args"}},hr={Ji:"unknownBrazeAction",Li:"noPushPrompt"},ku=(n,t)=>{switch(n){case hr.Ji:return`${t} contains an unknown braze action type and will not be displayed.`;case hr.Li:return`${t} contains a push prompt braze action, but is not eligible for a push prompt. Ignoring.`;default:return""}};const ec=/^[^\x00-\x1F\x22]+$/,oc=/[$.]/,sc=["$add","$update","$remove","$identifier_key","$identifier_value","$new_object","$time"],hc=new RegExp(/^.+@.+\..+$/),cr=/^brazeActions:\/\/v\d+\//;class h{constructor(n,t){this.ft=n;this.Ci=t;this.ft=n;this.Ci=t}getUserId(n){null==n&&t.j.error("getUserId must be supplied with a callback. e.g., braze.getUser().getUserId(function(userId) {console.log('the user id is ' + userId)})");"function"==typeof n&&n(this.ft.getUserId())}addAlias(n,i){return!ot(n,"add alias","the alias",!1)||n.length<=0?(t.j.error("addAlias requires a non-empty alias"),!1):!ot(i,"add alias","the label",!1)||i.length<=0?(t.j.error("addAlias requires a non-empty label"),!1):this.Ci.Cn(n,i).O}setFirstName(n){return!!ot(n,"set first name","the firstName",!0)&&this.ft.nu("first_name",n)}setLastName(n){return!!ot(n,"set last name","the lastName",!0)&&this.ft.nu("last_name",n)}setEmail(n){return null===n||ac(n)?this.ft.nu("email",n):(t.j.error(`Cannot set email address - "${n}" did not pass RFC-5322 validation.`),!1)}setGender(n){return"string"==typeof n&&(n=n.toLowerCase()),!(null!==n&&!st(h.Genders,n,`Gender "${n}" is not a valid gender.`,"User.Genders"))&&this.ft.nu("gender",n)}setDateOfBirth(n,i,r){return null===n&&null===i&&null===r?this.ft.nu("dob",null):(n=null!=n?parseInt(n.toString()):null,i=null!=i?parseInt(i.toString()):null,r=null!=r?parseInt(r.toString()):null,null==n||null==i||null==r||isNaN(n)||isNaN(i)||isNaN(r)||i>12||i<1||r>31||r<1?(t.j.error("Cannot set date of birth - parameters should comprise a valid date e.g. setDateOfBirth(1776, 7, 4);"),!1):this.ft.nu("dob",`${n}-${i}-${r}`))}setCountry(n){return!!ot(n,"set country","the country",!0)&&this.ft.nu("country",n)}setHomeCity(n){return!!ot(n,"set home city","the homeCity",!0)&&this.ft.nu("home_city",n)}setLanguage(n){return!!ot(n,"set language","the language",!0)&&this.ft.nu("language",n)}setEmailNotificationSubscriptionType(n){return!!st(h.NotificationSubscriptionTypes,n,`Email notification setting "${n}" is not a valid subscription type.`,"User.NotificationSubscriptionTypes")&&this.ft.nu("email_subscribe",n)}setPushNotificationSubscriptionType(n){return!!st(h.NotificationSubscriptionTypes,n,`Push notification setting "${n}" is not a valid subscription type.`,"User.NotificationSubscriptionTypes")&&this.ft.nu("push_subscribe",n)}setPhoneNumber(n){return!!ot(n,"set phone number","the phoneNumber",!0)&&(null===n||n.match(h.In)?this.ft.nu("phone",n):(t.j.error(`Cannot set phone number - "${n}" did not pass validation.`),!1))}setLastKnownLocation(n,i,r,u,f){return null==n||null==i?(t.j.error("Cannot set last-known location - latitude and longitude are required."),!1):(n=parseFloat(n.toString()),i=parseFloat(i.toString()),null!=r&&(r=parseFloat(r.toString())),null!=u&&(u=parseFloat(u.toString())),null!=f&&(f=parseFloat(f.toString())),isNaN(n)||isNaN(i)||null!=r&&isNaN(r)||null!=u&&isNaN(u)||null!=f&&isNaN(f)?(t.j.error("Cannot set last-known location - all supplied parameters must be numeric."),!1):n>90||n<-90||i>180||i<-180?(t.j.error("Cannot set last-known location - latitude and longitude are bounded by 90 and 180 respectively."),!1):null!=r&&r<0||null!=f&&f<0?(t.j.error("Cannot set last-known location - accuracy and altitudeAccuracy may not be negative."),!1):this.Ci.setLastKnownLocation(this.ft.getUserId(),n,i,u,r,f).O)}setCustomUserAttribute(n,i,r){if(!nf(n))return!1;const u=t=>{const[i]=gr(t,nr,"attribute value",`set custom user attribute "${n}"`,"custom user attribute");return i};if(b(i)){const[r,f]=lc(n,i);if(!r&&!f&&0!==i.length)return!1;if(r||0===i.length)return this.Ci.En(t.q.Fn,n,i).O;for(const n of i)if(!u(n))return!1}else if(er(i)){if(!u(i))return!1;if(r)return this.Ci.En(t.q.$n,n,i).O}else if(!(void 0!==i&&tf(i))||(ht(i)&&(i=br(i)),"string"==typeof i&&!et(i,`set custom user attribute "${n}"`,"the element in the given array")))return!1;return this.ft.setCustomUserAttribute(n,i)}addToCustomAttributeArray(n,i){return!!et(n,"add to custom user attribute array","the given key")&&!(null!=i&&!et(i,"add to custom user attribute array","the given value"))&&this.Ci.En(t.q.Bn,n,i).O}removeFromCustomAttributeArray(n,i){return!!et(n,"remove from custom user attribute array","the given key")&&!(null!=i&&!et(i,"remove from custom user attribute array","the given value"))&&this.Ci.En(t.q.Ln,n,i).O}incrementCustomUserAttribute(n,i){if(!et(n,"increment custom user attribute","the given key"))return!1;null==i&&(i=1);const r=parseInt(i.toString());return isNaN(r)||r!==parseFloat(i.toString())?(t.j.error(`Cannot increment custom user attribute because the given incrementValue "${i}" is not an integer.`),!1):this.Ci.En(t.q.Rn,n,r).O}setCustomLocationAttribute(n,i,r){return!!et(n,"set custom location attribute","the given key")&&((null!==i||null!==r)&&(i=null!=i?parseFloat(i.toString()):null,r=null!=r?parseFloat(r.toString()):null,null==i&&null!=r||null!=i&&null==r||null!=i&&(isNaN(i)||i>90||i<-90)||null!=r&&(isNaN(r)||r>180||r<-180))?(t.j.error("Received invalid values for latitude and/or longitude. Latitude and longitude are bounded by 90 and 180 respectively, or must both be null for removal."),!1):this.Ci.On(n,i,r).O)}addToSubscriptionGroup(n){return!ot(n,"add user to subscription group","subscription group ID",!1)||n.length<=0?(t.j.error("addToSubscriptionGroup requires a non-empty subscription group ID"),!1):this.Ci.Gn(n,h.qn.SUBSCRIBED).O}removeFromSubscriptionGroup(n){return!ot(n,"remove user from subscription group","subscription group ID",!1)||n.length<=0?(t.j.error("removeFromSubscriptionGroup requires a non-empty subscription group ID"),!1):this.Ci.Gn(n,h.qn.UNSUBSCRIBED).O}yn(n,t,i,r,u){this.ft.yn(n,t,i,r,u);this.Ci.zn()}wn(n){this.ft.wn(n)}}h.Genders={MALE:"m",FEMALE:"f",OTHER:"o",UNKNOWN:"u",NOT_APPLICABLE:"n",PREFER_NOT_TO_SAY:"p"};h.NotificationSubscriptionTypes={OPTED_IN:"opted_in",SUBSCRIBED:"subscribed",UNSUBSCRIBED:"unsubscribed"};h.In=/^[0-9 .\\(\\)\\+\\-]+$/;h.qn={SUBSCRIBED:"subscribed",UNSUBSCRIBED:"unsubscribed"};h.Hn="user_id";h.lu="custom";h.lr=997;const u={eu:{su:"ab.storage.userId",oa:"ab.storage.deviceId",Wh:"ab.storage.sessionId"},k:{_a:"ab.test",Ia:"ab.storage.events",Ka:"ab.storage.attributes",Ya:"ab.storage.attributes.anonymous_user",ma:"ab.storage.device",ga:"ab.storage.sdk_metadata",qa:"ab.storage.session_id_for_cached_metadata",xn:"ab.storage.pushToken",ki:"ab.storage.newsFeed",Ai:"ab.storage.lastNewsFeedRefresh",L:"ab.storage.cardImpressions",ll:"ab.storage.serverConfig",Na:"ab.storage.triggers",Ga:"ab.storage.triggers.ts",qh:"ab.storage.messagingSessionStart",Zt:"ab.storage.cc",vs:"ab.storage.ccLastFullSync",ys:"ab.storage.ccLastCardUpdated",Ws:"ab.storage.ccLastClientRequest",ui:"ab.storage.ccRateLimitCurrentTokenCount",C:"ab.storage.ccClicks",K:"ab.storage.ccImpressions",G:"ab.storage.ccDismissals",Ua:"ab.storage.lastDisplayedTriggerTimesById",La:"ab.storage.lastDisplayedTriggerTime",Fa:"ab.storage.triggerFireInstancesById",bu:"ab.storage.signature",Fs:"ab.storage.brazeSyncRetryCount",Ss:"ab.storage.sdkVersion",Di:"ab.storage.ff",$i:"ab.storage.ffLastRefreshAt",Pa:"ab.storage.lastReqToEndpoint"},re:"ab.optOut"};class g{constructor(n,t){this.Ja=n;this.Va=t}uu(n,t){let i=t;null!=t&&t instanceof tr&&(i=t.ss());this.Ja.store(n,i)}Ha(n){const t=this.tu(n);null!=t&&(t.Jh=(new Date).valueOf(),this.uu(n,t))}tu(n){return tr.Tn(this.Ja.wr(n))}Yh(n){this.Ja.remove(n)}co(n){if(null==n||0===n.length)return!1;b(n)||(n=[n]);let t=this.Va.wr(u.k.Ia);null!=t&&b(t)||(t=[]);for(let i=0;i<n.length;i++)t.push(n[i].ss());return this.Va.store(u.k.Ia,t)}Qh(n){return null!=n&&this.co([n])}Wa(){let n=this.Va.wr(u.k.Ia);this.Va.remove(u.k.Ia);null==n&&(n=[]);const r=[];let f=!1,i=null;if(b(n))for(let t=0;t<n.length;t++)ft.Za(n[t])?r.push(ft.Tn(n[t])):i=t;else f=!0;if(f||null!=i){let u="Stored events could not be deserialized as Events";f&&(u+=", was "+Object.prototype.toString.call(n)+" not an array");null!=i&&(u+=", value at index "+i+" does not look like an event");u+=", serialized values were of type "+typeof n+": "+JSON.stringify(n);r.push(new ft(null,t.q.Is,(new Date).valueOf(),null,{e:u}))}return r}D(n,t){return!!st(u.k,n,"StorageManager cannot store object.","STORAGE_KEYS.OBJECTS")&&this.Va.store(n,t)}v(n){return!!st(u.k,n,"StorageManager cannot retrieve object.","STORAGE_KEYS.OBJECTS")&&this.Va.wr(n)}ri(n){return!!st(u.k,n,"StorageManager cannot remove object.","STORAGE_KEYS.OBJECTS")&&(this.Va.remove(n),!0)}xo(n){const t=ct(u.eu),i=new g.ee(n);for(const n of t)i.remove(u.eu[n])}clearData(){const n=ct(u.eu),t=ct(u.k);for(let t=0;t<n.length;t++){const i=n[t];this.Ja.remove(u.eu[i])}for(let n=0;n<t.length;n++){const i=t[n];this.Va.remove(u.k[i])}}$a(n){return n||u.k.Ya}wa(n){let t=this.Va.wr(u.k.Ka);null==t&&(t={});const i=this.$a(n[h.Hn]);for(let r in n)r===h.Hn||null!=t[i]&&null!=t[i][r]||this.mu(n[h.Hn],r,n[r])}mu(n,t,i){let f=this.Va.wr(u.k.Ka);null==f&&(f={});const e=this.$a(n);let r=f[e];if(null==r&&(r={},null!=n&&(r[h.Hn]=n)),t===h.lu){null==r[t]&&(r[t]={});for(let n in i)r[t][n]=i[n]}else r[t]=i;return f[e]=r,this.Va.store(u.k.Ka,f)}tE(){const n=this.Va.wr(u.k.Ka);this.Va.remove(u.k.Ka);const t=[];for(let i in n)null!=n[i]&&t.push(n[i]);return t}ou(n){const t=this.Va.wr(u.k.Ka);if(null!=t){const r=this.$a(null),i=t[r];null!=i&&(t[r]=void 0,this.Va.store(u.k.Ka,t),i[h.Hn]=n,this.wa(i))}const r=this.tu(u.eu.Wh);let f=null;null!=r&&(f=r.iu);const i=this.Wa();if(null!=i)for(let t=0;t<i.length;t++){const r=i[t];null==r.userId&&r.sessionId==f&&(r.userId=n);this.Qh(r)}}eE(){return this.Va.sE}}g.Ma=(class{constructor(n){this.Ko=n;this.sE=it.rE()?3:10}oE(n){return n+"."+this.Ko}store(n,i){const r={v:i};try{return localStorage.setItem(this.oE(n),JSON.stringify(r)),!0}catch(n){return t.j.info("Storage failure: "+n.message),!1}}wr(n){try{const t=JSON.parse(localStorage.getItem(this.oE(n)));return null==t?null:t.v}catch(n){return t.j.info("Storage retrieval failure: "+n.message),null}}remove(n){try{localStorage.removeItem(this.oE(n))}catch(n){return t.j.info("Storage removal failure: "+n.message),!1}}});g.ee=(class{constructor(n,t){this.Ko=n;this.nE=this.aE();this.iE=576e3;this.EE=!!t}oE(n){return null!=this.Ko?n+"."+this.Ko:n}aE(){let i=0,n=document.location.hostname;const r=n.split("."),t="ab._gd";for(;i<r.length-1&&-1===document.cookie.indexOf(t+"="+t);)i++,n="."+r.slice(-1-i).join("."),document.cookie=t+"="+t+";domain="+n+";";return document.cookie=t+"=;expires="+new Date(0).toGMTString()+";domain="+n+";",n}ne(){const n=new Date;return n.setTime(n.getTime()+6e4*this.iE),n.getFullYear()}lE(){const n=wr(u.eu),t=document.cookie.split(";");for(let i=0;i<t.length;i++){let r=t[i];for(;" "===r.charAt(0);)r=r.substring(1);let u=!1;for(let t=0;t<n.length;t++)if(0===r.indexOf(n[t])){u=!0;break}if(u){const n=r.split("=")[0];-1===n.indexOf("."+this.Ko)&&this.SE(n)}}}store(n,i){this.lE();const r=new Date;r.setTime(r.getTime()+6e4*this.iE);const e="expires="+r.toUTCString(),o="domain="+this.nE;let f;f=this.EE?i:encodeURIComponent(JSON.stringify(i));const u=this.oE(n)+"="+f+";"+e+";"+o+";path=/";return u.length>=4093?(t.j.info("Storage failure: string is "+u.length+" chars which is too large to store as a cookie."),!1):(document.cookie=u,!0)}wr(n){const i=[],r=this.oE(n)+"=",u=document.cookie.split(";");for(let f=0;f<u.length;f++){let e=u[f];for(;" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(r))try{let n;n=this.EE?e.substring(r.length,e.length):JSON.parse(decodeURIComponent(e.substring(r.length,e.length)));i.push(n)}catch(i){return t.j.info("Storage retrieval failure: "+i.message),this.remove(n),null}}return i.length>0?i[i.length-1]:null}remove(n){this.SE(this.oE(n))}SE(n){const t=n+"=;expires="+new Date(0).toGMTString();document.cookie=t;document.cookie=t+";path=/";const i=t+";domain="+this.nE;document.cookie=i;document.cookie=i+";path=/"}});g.Qa=(class{constructor(){this._E={};this.uE=5242880;this.sE=3}store(n,i){const u={value:i},r=this.cE(i);return r>this.uE?(t.j.info("Storage failure: object is "+r+" bytes which is greater than the max of "+this.uE),!1):(this._E[n]=u,!0)}cE(n){const r=[],i=[n];let t=0;for(;i.length;){const n=i.pop();if("boolean"==typeof n)t+=4;else if("string"==typeof n)t+=2*n.length;else if("number"==typeof n)t+=8;else if("object"==typeof n&&-1===r.indexOf(n)){r.push(n);for(let t in n)i.push(n[t])}}return t}wr(n){const t=this._E[n];return null==t?null:t.value}remove(n){this._E[n]=null}});g.xa=(class{constructor(n,t,i){this.Ko=n;this.TE=[];t&&this.TE.push(new g.ee(n));i&&this.TE.push(new g.Ma(n));this.TE.push(new g.Qa(n))}store(n,t){let i=!0;for(let r=0;r<this.TE.length;r++)i=this.TE[r].store(n,t)&&i;return i}wr(n){for(let t=0;t<this.TE.length;t++){const i=this.TE[t].wr(n);if(null!=i)return i}return null}remove(n){new g.ee(this.Ko).remove(n);for(let t=0;t<this.TE.length;t++)this.TE[t].remove(n)}});class yc{constructor(n,t,i){this.Jn=n;this.Kn=t||!1;this.Qn=i;this.Vn=new k;this.Xn=0;this.Yn=1}Zn(){return this.Kn}au(){return this.Jn.v(u.k.bu)}setSdkAuthenticationSignature(n){const r=this.au();this.Jn.D(u.k.bu,n);const i=t.zt.Ft;new t.xt(i,t.j).setItem(i.Jt.gu,this.Yn,n);r!==n&&this.si()}du(){this.Jn.ri(u.k.bu);const n=t.zt.Ft;new t.xt(n,t.j).br(n.Jt.gu,this.Yn)}subscribeToSdkAuthenticationFailures(n){return this.Qn.lt(n)}Su(n){this.Qn.Et(n)}Au(){this.Vn.removeAllSubscriptions()}pu(){this.Xn+=1}Fu(){return this.Xn}si(){this.Xn=0}}class lr{constructor(){}Ts(){}changeUser(){}clearData(){}}c={BROWSER:"browser",BROWSER_VERSION:"browserVersion",OS:"os",RESOLUTION:"resolution",LANGUAGE:"language",TIME_ZONE:"timeZone",USER_AGENT:"userAgent"};class pc{constructor(n){this.id=n}Wi(){const n={};return null!=this[c.BROWSER]&&(n.browser=this[c.BROWSER]),null!=this[c.BROWSER_VERSION]&&(n.browser_version=this[c.BROWSER_VERSION]),null!=this[c.OS]&&(n.os_version=this[c.OS]),null!=this[c.RESOLUTION]&&(n.resolution=this[c.RESOLUTION]),null!=this[c.LANGUAGE]&&(n.locale=this[c.LANGUAGE]),null!=this[c.TIME_ZONE]&&(n.time_zone=this[c.TIME_ZONE]),null!=this[c.USER_AGENT]&&(n.user_agent=this[c.USER_AGENT]),n}}class wc{constructor(n,t){this.Jn=n;null==t&&(t=wr(c));this.sa=t}te(){let i=this.Jn.tu(u.eu.oa);null==i&&(i=new tr(t.Z.Y()),this.Jn.uu(u.eu.oa,i));const n=new pc(i.iu);for(let t=0;t<this.sa.length;t++){const i=this.sa[t];switch(i){case c.BROWSER:n[i]=it.browser;break;case c.BROWSER_VERSION:n[i]=it.version;break;case c.OS:n[i]=this.ca();break;case c.RESOLUTION:n[i]=screen.width+"x"+screen.height;break;case c.LANGUAGE:n[i]=it.language;break;case c.TIME_ZONE:n[i]=this.fa(new Date);break;case c.USER_AGENT:n[i]=it.userAgent}}return n}ca(){if(it.la())return it.la();const n=this.Jn.v(u.k.ma);return n&&n.os_version?n.os_version:it.ua()}fa(n){if("undefined"!=typeof Intl&&"function"==typeof Intl.DateTimeFormat)try{if("function"==typeof Intl.DateTimeFormat().resolvedOptions){const n=Intl.DateTimeFormat().resolvedOptions().timeZone;if(null!=n&&""!==n)return n}}catch(i){t.j.info("Intl.DateTimeFormat threw an error, cannot detect user's time zone:"+i.message);n=""}if(!n)return n;const i=n.getTimezoneOffset();return this.ha(i)}ha(n){const i=parseInt(n/60),r=parseInt(n%60);let t="GMT";return 0!==n&&(t+=n<0?"+":"-",t+=("00"+Math.abs(i)).slice(-2)+":"+("00"+Math.abs(r)).slice(-2)),t}}hi={Da:"invalid_api_key",Sa:"blacklisted",va:"no_device_identifier",Ba:"invalid_json_response",za:"empty_response",__:"sdk_auth_error"};const w={Qs:{Xa:"d",Os:"cc",xi:"ff",Xi:"t"},Lu:n=>{if(n)return n.v(u.k.Pa)},qu:(n,t)=>{n&&n.D(u.k.Pa,t)},Ea:(n,t)=>{if(!n||!t)return-1;const r=w.Lu(n);if(null==r)return-1;const i=r[t];return null==i||isNaN(i)?-1:i},Xs:(n,t,i)=>{if(n&&t){let r=w.Lu(n);null==r&&(r={});r[t]=i;w.qu(n,r)}}};class bc{constructor(n,t,i,r,u,f,e,o,s,h,c){this.Xo=n;this.Jn=t;this.gh=i;this.Qo=r;this.fh=u;this.Zo=f;this.Ko=e;this.Ho=o;this.Vo=s;this.Yo=h;this.pa=c;this.Ra=["npm"]}Gs(n,t){const i=this.Xo.te(),r=i.Wi(),f=this.Jn.v(u.k.ma);ai(f,r)||(n.device=r);n.api_key=this.Ko;n.time=or((new Date).valueOf(),!0);const e=this.Jn.v(u.k.ga)||[],o=this.Jn.v(u.k.qa)||"";if(this.Ra.length>0&&(!ai(e,this.Ra)||o!==this.fh.ba())&&(n.sdk_metadata=this.Ra),n.sdk_version=this.Vo,this.Yo&&(n.sdk_flavor=this.Yo),n.app_version=this.pa,n.device_id=i.id,t){const t=this.Qo.getUserId();null!=t&&(n.user_id=t)}return n}ti(n,i,r){const u=i.auth_error,f=i.error;if(!u&&!f)return!0;if(u){let f;this.gh.pu();const i={errorCode:u.error_code};for(const n of r)b(n)&&"X-Braze-Auth-Signature"===n[0]&&(i.signature=n[1]);n.respond_with&&n.respond_with.user_id?i.userId=n.respond_with.user_id:n.user_id&&(i.userId=n.user_id);const e=u.reason;return e?(i.reason=e,f=`due to ${e}`):f=`with error code ${u.error_code}.`,this.gh.Zn()||(f+=' Please use the "enableSdkAuthentication" initialization option to enable authentication.'),t.j.error(`SDK Authentication failed ${f}`),this.Aa(n.events,n.attributes),this.gh.Su(i),!1}if(f){let r,u=f;switch(u){case hi.za:return r="Received successful response with empty body.",y.N(t.q.Is,{e:r}),t.j.info(r),!1;case hi.Ba:return r="Received successful response with invalid JSON",y.N(t.q.Is,{e:r+": "+i.response}),t.j.info(r),!1;case hi.Da:u=`The API key "${n.api_key}" is invalid for the baseUrl ${this.Ho}`;break;case hi.Sa:u="Sorry, we are not currently accepting your requests. If you think this is in error, please contact us.";break;case hi.va:u="No device identifier. Please contact support@braze.com"}t.j.error("Backend error: "+u)}return!1}ka(n,t,i,r){return!!(n&&0!==n.length||t&&0!==t.length||i||r)}Ta(n,t,i,r){const o=[],c=n=>n||"",l=c(this.Qo.getUserId());let e,s,h,u,f=this.Vi(n,t);if(i.length>0){const n=[];for(const t of i){if(e=t.Wi(),this.gh.Zn()){if(l&&!e.user_id){u||(u={},u.events=[]);u.events.push(e);continue}if(c(e.user_id)!==l){s||(s=[]);s.push(e);continue}}n.push(e)}n.length>0&&(f.events=n)}if(r.length>0){const n=[];for(const t of r)this.gh.Zn()&&c(t.user_id)!==l?(h||(h=[]),h.push(t)):n.push(t);n.length>0&&(f.attributes=n)}if(this.Aa(s,h),f=this.Gs(f,!0),u){u=this.Gs(u,!1);const n={requestData:u,headers:this.Ks(u,w.Qs.Xa)};o.push(n)}if(f&&!this.ka(f.events,f.attributes,n,t))return u?o:null;const a={requestData:f,headers:this.Ks(f,w.Qs.Xa)};return o.push(a),o}Aa(n,t){if(n){const t=[];for(const i of n){const n=ft.fromJson(i);n.time=kh(n.time);t.push(n)}this.Jn.co(t)}if(t)for(const n of t)this.Jn.wa(n)}ii(n,i){let r="HTTP error ";null!=n&&(r+=n+" ");r+=i;t.j.error(r)}qr(n){return y.N(t.q.ya,{n:n})}Vi(n,t,i){const r={};n&&(r.feed=!0);t&&(r.triggers=!0);const u=null!=i?i:this.Qo.getUserId();return u&&(r.user_id=u),r.config={config_time:this.Zo.oi()},{respond_with:r}}Ca(n){const r=(new Date).valueOf();let t=rc.toString(),i=w.Ea(this.Jn,n);return-1!==i&&(t=(r-i).toString()),t}Ks(n,t,i){const r=[["X-Braze-Api-Key",this.Ko]];let e=this.Ca(t);r.push(["X-Braze-Last-Req-Ms-Ago",e]);let f=!1;if(null!=n.respond_with&&n.respond_with.triggers&&(r.push(["X-Braze-TriggersRequest","true"]),f=!0),null!=n.respond_with&&n.respond_with.feed&&(r.push(["X-Braze-FeedRequest","true"]),f=!0),t===w.Qs.Os){r.push(["X-Braze-ContentCardsRequest","true"]);let n=this.Jn.v(u.k.Fs);n&&i||(n=0,this.Jn.D(u.k.Fs,n));r.push(["BRAZE-SYNC-RETRY-COUNT",n.toString()]);f=!0}if(t===w.Qs.xi&&(r.push(["X-Braze-FeatureFlagsRequest","true"]),f=!0),f&&r.push(["X-Braze-DataRequest","true"]),this.gh.Zn()){const n=this.gh.au();null!=n&&r.push(["X-Braze-Auth-Signature",n])}return r}Vs(n,t){const i=n.device;i&&i.os_version instanceof Promise?i.os_version.then(i=>{n.device.os_version=i,t()}):t()}si(){this.gh.si()}Zs(){return this.Ho}addSdkMetadata(n){for(const t of n)-1===this.Ra.indexOf(t)&&this.Ra.push(t)}}const nu={Ys:n=>{let i,r;try{const u=()=>{t.j.error("This browser does not have any supported ajax options!")};if(window.XMLHttpRequest?(i=new XMLHttpRequest,i||u()):u(),null!=i){const t=()=>{"function"==typeof n.error&&n.error(i.status),"function"==typeof n.ei&&n.ei(!1)};i.onload=()=>{let r=!1;if(4===i.readyState)if(r=i.status>=200&&i.status<300||304===i.status,r){if("function"==typeof n.O){let t,r;try{t=JSON.parse(i.responseText);r=i.getAllResponseHeaders()}catch(t){const u={error:""===i.responseText?hi.za:hi.Ba,response:i.responseText};n.O(u,r)}t&&n.O(t,r)}"function"==typeof n.ei&&n.ei(!0)}else t()};i.onerror=()=>{t()};i.ontimeout=()=>{t()};r=JSON.stringify(n.data);i.open("POST",n.url,!0);i.setRequestHeader("Content-type","application/json");i.setRequestHeader("X-Requested-With","XMLHttpRequest");const u=n.headers||[];for(const n of u)i.setRequestHeader(n[0],n[1]);i.send(r)}}catch(n){t.j.error(`Network request error: ${n.message}`)}}},kc=n=>{let t={};const i=n.toString().split("\r\n");if(!i)return t;let r,u;for(const n of i)n&&(r=n.slice(0,n.indexOf(":")).toLowerCase().trim(),u=n.slice(n.indexOf(":")+1).trim(),t[r]=u);return t},tu=(n,t)=>(n=Math.ceil(n),t=Math.floor(t),Math.floor(Math.random()*(t-n+1))+n);class gt{constructor(n,t){this.O=!!n;this.ve=t||[]}S(n){this.O=this.O&&n.O;this.ve.push(...n.ve)}}const fi={an:()=>"serviceWorker"in navigator&&"undefined"!=typeof ServiceWorkerRegistration&&"showNotification"in ServiceWorkerRegistration.prototype&&"PushManager"in window,fn:()=>"safari"in window&&"pushNotification"in window.safari&&"function"==typeof window.safari.pushNotification.permission&&"function"==typeof window.safari.pushNotification.requestPermission,isPushSupported:()=>fi.an()||fi.fn(),isPushBlocked:()=>{const n=fi.isPushSupported()&&"Notification"in window&&null!=window.Notification&&null!=window.Notification.permission&&"denied"===window.Notification.permission,t=fi.isPushSupported()&&(!("Notification"in window)||null==window.Notification);return n||t},isPushPermissionGranted:()=>fi.isPushSupported()&&"Notification"in window&&null!=window.Notification&&null!=window.Notification.permission&&"granted"===window.Notification.permission,Ki:()=>!fi.isPushBlocked()&&fi.isPushSupported()&&!fi.isPushPermissionGranted()};rt=fi;class dc{constructor(n,t,i,r,u,f,e,o,s,h){this.Ko=n;this.Ho=t;this.wl=0;this.kl=e.eE();this.yl=null;this.fh=i;this.Xo=r;this.Qo=u;this.Zo=f;this.Jn=e;this.gh=s;this.wh=h;this.vl=o;this.jl=new k;this.Sl=50}$l(n,t){return!n&&!t&&this.gh.Fu()>=this.Sl}ql(n){let i=this.fh.kh();if(n.length>0){const r=this.Qo.getUserId();for(const u of n){const n=!u.userId&&!r||u.userId===r;u.type===t.q.Vh&&n&&(i=!0)}}return i}Al(n,i,r,f,e,o,s){null==r&&(r=!0);r&&this.Cl();const h=this.Jn.Wa(),a=this.Jn.tE();let v=!1;const b=(n,t)=>{let i=!1;w.Xs(this.Jn,w.Qs.Xa,(new Date).valueOf());nu.Ys({url:this.Ho+"/data/",data:n,headers:t,O:r=>{null!=n.respond_with&&n.respond_with.triggers&&(this.wl=Math.max(this.wl-1,0)),this.wh.ti(n,r,t)?(this.gh.si(),this.Zo.ol(r),null!=n.respond_with&&n.respond_with.user_id!=this.Qo.getUserId()||(null!=n.device&&this.Jn.D(u.k.ma,n.device),null!=n.sdk_metadata&&(this.Jn.D(u.k.ga,n.sdk_metadata),this.Jn.D(u.k.qa,this.fh.ba())),this.vl(r),"function"==typeof f&&f())):r.auth_error&&(i=!0)},error:()=>{null!=n.respond_with&&n.respond_with.triggers&&(this.wl=Math.max(this.wl-1,0)),this.wh.Aa(n.events,n.attributes),"function"==typeof e&&e()},ei:n=>{if("function"==typeof o&&o(n),r&&!v){if(n&&!i)this.Tl();else{let n=this.yl;(null==n||n<1e3*this.kl)&&(n=1e3*this.kl);this.Tl(Math.min(3e5,tu(1e3*this.kl,3*n)))}v=!0}}})},c=this.ql(h),l=i||c;if(this.$l(s,c))return void t.j.info("Declining to flush data due to 50 consecutive authentication failures");if(r&&!this.wh.ka(h,a,n,l))return this.Tl(),void("function"==typeof o&&o(!0));const y=this.wh.Ta(n,l,h,a);l&&this.wl++;let p=!1;if(y)for(const n of y)this.wh.Vs(n.requestData,()=>b(n.requestData,n.headers)),p=!0;this.gh.Zn()&&r&&!p?this.Tl():c&&(t.j.info("Invoking new session subscriptions"),this.jl.Et())}_l(){return this.wl>0}Tl(n){this.Dl||(null==n&&(n=1e3*this.kl),this.Cl(),this.Fl=setTimeout(()=>{if(document.hidden){const n="visibilitychange",t=()=>{document.hidden||(document.removeEventListener(n,t,!1),this.Al())};document.addEventListener(n,t,!1)}else this.Al()},n),this.yl=n)}Cl(){null!=this.Fl&&(clearTimeout(this.Fl),this.Fl=null)}initialize(){this.Dl=!1;this.Tl()}destroy(){this.jl.removeAllSubscriptions();this.gh.Au();this.Cl();this.Dl=!0;this.Al(null,null,!1);this.Fl=null}pr(n){return this.jl.lt(n)}openSession(){const n=this.fh.ba()!==this.fh.bo();n&&(this.Jn.Ha(u.eu.oa),this.Jn.Ha(u.eu.su));this.Al(null,!1,null,null,null);this.zn();n&&Promise.resolve().then(function(){return ih}).then(n=>{if(!this.Dl){const i=n.default.m();if(null!=i&&(rt.isPushPermissionGranted()||rt.isPushBlocked())){const n=()=>{i.ln()?t.j.info("Push token maintenance is disabled, not refreshing token for backend."):i.subscribe()},f=(t,i)=>{i&&n()},e=()=>{const t=this.Jn.v(u.k.xn);(null==t||t)&&n()},r=t.zt.Ft;new t.xt(r,t.j).hr(r.Jt.cu,f,e)}}})}changeUser(n,i,r){const f=this.Qo.getUserId();if(f!==n){this.fh.Xh();null!=f&&this.Al(null,!1,null,null,null);this.Qo.ru(n);r?this.gh.setSdkAuthenticationSignature(r):this.gh.du();for(let n=0;n<i.length;n++)i[n].changeUser(null==f);null!=f&&this.Jn.ri(u.k.L);this.Jn.ri(u.k.ma);this.openSession();t.j.info('Changed user to "'+n+'".')}else{let i="Doing nothing.";r&&this.gh.au()!==r&&(this.gh.setSdkAuthenticationSignature(r),i="Updated SDK authentication signature");t.j.info(`Current user is already ${n}. ${i}`)}}requestImmediateDataFlush(n){this.Cl();this.fh.bo();this.Al(null,null,null,null,()=>{t.j.error("Failed to flush data, request will be retried automatically.")},n,!0)}requestFeedRefresh(){this.fh.bo();this.Al(!0)}$r(n,i){this.fh.bo();t.j.info("Requesting explicit trigger refresh.");this.Al(null,!0,null,n,i)}Cn(n,i){const u=t.q.Ll,f={a:n,l:i},r=y.N(u,f);return r&&t.j.info(`Logged alias ${n} with label ${i}`),r}En(n,i,r){if(this.Zo.hu(i))return t.j.info(`Custom Attribute "${i}" is blocklisted, ignoring.`),new gt;const f={key:i,value:r},u=y.N(n,f);if(u){const n="object"==typeof r?JSON.stringify(r,null,2):r;t.j.info(`Logged custom attribute: ${i} with value: ${n}`)}return u}setLastKnownLocation(n,i,r,u,f,e){const o={latitude:i,longitude:r};null!=u&&(o.altitude=u);null!=f&&(o.ll_accuracy=f);null!=e&&(o.alt_accuracy=e);const s=y.N(t.q.Pl,o,n);return s&&t.j.info(`Set user last known location as ${JSON.stringify(o,null,2)}`),s}vr(n,i){const r=this.fh.bo();return new ft(this.Qo.getUserId(),t.q.Rl,n,r,{cid:i})}zn(){const n=t.zt.Ft;new t.xt(n,t.j).setItem(n.Jt.Xa,1,{baseUrl:this.Ho,data:{api_key:this.Ko,device_id:this.Xo.te().id},userId:this.Qo.getUserId(),sdkAuthEnabled:this.gh.Zn()})}Fr(n){for(const i of n)if(i.api_key===this.Ko)this.wh.Aa(i.events,i.attributes);else{const n=t.zt.Ft;new t.xt(n,t.j).setItem(n.Jt.yr,t.Z.Y(),i)}}On(n,i,r){if(this.Zo.hu(n))return t.j.info(`Custom Attribute "${n}" is blocklisted, ignoring.`),new gt;let u,f;return null===i&&null===r?(u=t.q.Ml,f={key:n}):(u=t.q.Nl,f={key:n,latitude:i,longitude:r}),y.N(u,f)}Gn(n,i){const r={group_id:n,status:i};return y.N(t.q.Ol,r)}}class iu{constructor(n,t,i,r,u,f,e,o){this.hl=n||0;this.cl=t||[];this.gl=i||[];this.fl=r||[];this.bl=u;null!=u&&""!==u||(this.bl=null);this.al=f||null;this.ul=e||{};this.mi=o||{}}ss(){return{s:"4.8.0",l:this.hl,e:this.cl,a:this.gl,p:this.fl,m:this.bl,v:this.al,c:this.ul,f:this.mi}}static Tn(n){let t=n.l;return"4.8.0"!==n.s&&(t=0),new iu(t,n.e,n.a,n.p,n.m,n.v,n.c,n.f)}}class gc{constructor(n){this.Jn=n;this.tl=new k;this.el=new k;this.sl=new k;this.il=null}rl(){if(null==this.il){const n=this.Jn.v(u.k.ll);this.il=null!=n?iu.Tn(n):new iu}return this.il}oi(){return this.rl().hl}ol(n){if(null!=n&&null!=n.config){const t=n.config;if(t.time>this.rl().hl){const n=new iu(t.time,t.events_blacklist,t.attributes_blacklist,t.purchases_blacklist,t.messaging_session_timeout,t.vapid_public_key,t.content_cards,t.feature_flags);let i=!1;null!=n.al&&this.jn()!==n.al&&(i=!0);let r=!1;null!=n.ul.enabled&&this.ni()!==n.ul.enabled&&(r=!0);let f=!1;null!=n.mi.enabled&&this.bi()!==n.mi.enabled&&(f=!0);this.il=n;this.Jn.D(u.k.ll,n.ss());i&&this.tl.Et();r&&this.el.Et();f&&this.sl.Et()}}}Un(n){let t=this.tl.lt(n);return this.ml&&this.tl.removeSubscription(this.ml),this.ml=t,t}$s(n){return this.el.lt(n)}Ni(n){return this.sl.lt(n)}ge(n){return-1!==this.rl().cl.indexOf(n)}hu(n){return-1!==this.rl().gl.indexOf(n)}Dr(n){return-1!==this.rl().fl.indexOf(n)}dl(){return this.rl().bl}jn(){return this.rl().al}ni(){return this.rl().ul.enabled||!1}_s(){const n=this.rl().ul.rate_limit;return!(!n||null==n.enabled)&&n.enabled}fi(){if(!this._s())return-1;const n=this.rl().ul.rate_limit;return null==n.capacity?tc:n.capacity<=0?-1:n.capacity}di(){if(!this._s())return-1;const n=this.rl().ul.rate_limit;return null==n.refill_rate?ic:n.refill_rate<=0?-1:n.refill_rate}bi(){return this.rl().mi.enabled&&null==this.Si()?(y.N(t.q.Is,{e:"Missing feature flag refresh_rate_limit."}),!1):this.rl().mi.enabled||!1}Si(){return this.rl().mi.refresh_rate_limit}}class nl{constructor(n,i,r,u){this.Jn=n;this.Qo=i;this.Zo=r;this.jh=1e3;u=parseFloat(u);isNaN(u)&&(u=1800);u<this.jh/1e3&&(t.j.info("Specified session timeout of "+u+"s is too small, using the minimum session timeout of "+this.jh/1e3+"s instead."),u=this.jh/1e3);this.xh=u}Gh(n,i){return new ft(this.Qo.getUserId(),t.q.Fh,n,i.iu,{d:or(n-i.Hh)})}ba(){const n=this.Jn.tu(u.eu.Wh);return null==n?null:n.iu}kh(){const t=(new Date).valueOf(),i=this.Zo.dl(),n=this.Jn.v(u.k.qh);if(null!=n&&null==i)return!1;const r=null==n||t-n>1e3*i;return r&&this.Jn.D(u.k.qh,t),r}yh(n,t){return null==t||!(n-t.Hh<this.jh)&&t.Bh<n}bo(){const i=(new Date).valueOf(),r=i+1e3*this.xh,n=this.Jn.tu(u.eu.Wh);if(this.yh(i,n)){let f="Generating session start event with time "+i;if(null!=n){let t=n.Jh;t-n.Hh<this.jh&&(t=n.Hh+this.Kh);this.Jn.Qh(this.Gh(t,n));f+=" (old session ended "+t+")"}f+=". Will expire "+r.valueOf();t.j.info(f);const e=new tr(t.Z.Y(),r);return this.Jn.Qh(new ft(this.Qo.getUserId(),t.q.Vh,i,e.iu)),this.Jn.uu(u.eu.Wh,e),null==this.Jn.v(u.k.qh)&&this.Jn.D(u.k.qh,i),e.iu}return n.Jh=i,n.Bh=r,this.Jn.uu(u.eu.Wh,n),n.iu}Xh(){const n=this.Jn.tu(u.eu.Wh);null!=n&&(this.Jn.Yh(u.eu.Wh),this.Jn.Qh(this.Gh((new Date).valueOf(),n)))}}const no={qo:(n,i)=>{let r=!1;try{if(localStorage&&localStorage.getItem)try{localStorage.setItem(u.k._a,!0);localStorage.getItem(u.k._a)&&(localStorage.removeItem(u.k._a),r=!0)}catch(n){if("QuotaExceededError"!==n.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==n.name||!(localStorage.length>0))throw n;r=!0}}catch(n){t.j.info("Local Storage not supported!")}const e=no.Oa(),o=new g.xa(n,e&&!i,r);let f=null;return f=r?new g.Ma(n):new g.Qa,new g(o,f)},Oa:()=>navigator.cookieEnabled||"cookie"in document&&(document.cookie.length>0||(document.cookie="test").indexOf.call(document.cookie,"test")>-1)};class yi{constructor(n){this.triggerId=n;this.triggerId=n;this.extras={};this.isControl=!0}static fromJson(n){return new yi(n.trigger_id)}}const pi={Ou:null,eo:tl},ni={Je:"up",Ke:"down",W:"left",X:"right"};const ei={yo:32,oo:9,Fo:13,Ih:27},uo=n=>null!==n&&"IFRAME"===n.tagName;class f{constructor(n,t,i,r,u,e,o,s,h,c,l,a,v,y,p,w,b,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht){this.message=n;this.messageAlignment=t;this.slideFrom=i;this.extras=r;this.triggerId=u;this.clickAction=e;this.uri=o;this.openTarget=s;this.dismissType=h;this.duration=c;this.icon=l;this.imageUrl=a;this.imageStyle=v;this.iconColor=y;this.iconBackgroundColor=p;this.backgroundColor=w;this.textColor=b;this.closeButtonColor=d;this.animateIn=g;this.animateOut=nt;this.header=tt;this.headerAlignment=it;this.headerTextColor=rt;this.frameColor=ut;this.buttons=ft;this.cropType=et;this.orientation=ot;this.htmlId=st;this.css=ht;this.message=n;this.messageAlignment=t||f.TextAlignment.CENTER;this.duration=c||5e3;this.slideFrom=i||f.SlideFrom.BOTTOM;this.extras=r||{};this.triggerId=u;this.clickAction=e||f.ClickAction.NONE;this.uri=o;this.openTarget=s||f.OpenTarget.NONE;this.dismissType=h||f.DismissType.AUTO_DISMISS;this.icon=l;this.imageUrl=a;this.imageStyle=v||f.ImageStyle.TOP;this.iconColor=y||f.Ur.Vr;this.iconBackgroundColor=p||f.Ur.Qr;this.backgroundColor=w||f.Ur.Vr;this.textColor=b||f.Ur.th;this.closeButtonColor=d||f.Ur.sh;this.animateIn=g;null==this.animateIn&&(this.animateIn=!0);this.animateOut=nt;null==this.animateOut&&(this.animateOut=!0);this.header=tt;this.headerAlignment=it||f.TextAlignment.CENTER;this.headerTextColor=rt||f.Ur.th;this.frameColor=ut||f.Ur.ih;this.buttons=ft||[];this.cropType=et||f.CropType.FIT_CENTER;this.orientation=ot;this.htmlId=st;this.css=ht;this.isControl=!1;this.hh=!1;this.eh=!1;this.vo=!1;this.nh=!1;this.qe=null;this.ke=null;this.ht=new k;this.oh=new k;this.Le=f.TextAlignment.CENTER}subscribeToClickedEvent(n){return this.ht.lt(n)}subscribeToDismissedEvent(n){return this.oh.lt(n)}removeSubscription(n){this.ht.removeSubscription(n);this.oh.removeSubscription(n)}removeAllSubscriptions(){this.ht.removeAllSubscriptions();this.oh.removeAllSubscriptions()}closeMessage(){this.he(this.qe)}xe(){return!0}io(){return this.xe()}$e(){return null!=this.htmlId&&this.htmlId.length>4}ye(){return this.$e()&&null!=this.css&&this.css.length>0}Ae(){if(this.$e()&&this.ye())return this.htmlId+"-css"}M(){return!this.eh&&(this.eh=!0,!0)}Lr(){return this.eh}p(){return!this.vo&&(this.vo=!0,this.ht.Et(),!0)}F(){return!this.nh&&(this.nh=!0,this.oh.Et(),!0)}hide(n){if(n&&n.parentNode){let t=n.closest(".ab-iam-root");if(null==t&&(t=n),this.xe()&&null!=t.parentNode){const n=t.parentNode.classList;n&&n.contains(f.rh)&&n.remove(f.rh);document.body.removeEventListener("touchmove",f.lh)}t.className=t.className.replace(f.uh,f.Eh)}return this.animateOut||!1}he(n,t){if(null!=n){let r;this.qe=null;r=-1===n.className.indexOf("ab-in-app-message")?n.getElementsByClassName("ab-in-app-message")[0]:n;let u=!1;r&&(u=this.hide(r));const i=document.body;let e;null!=i&&(e=i.scrollTop);const o=()=>{if(n&&n.parentNode){let t=n.closest(".ab-iam-root");null==t&&(t=n);t.parentNode&&t.parentNode.removeChild(t)}const r=this.Ae();if(null!=r){const n=document.getElementById(r);n&&n.parentNode&&n.parentNode.removeChild(n)}null!=i&&"Safari"===it.browser&&(i.scrollTop=e);t?t():this.F()};u?setTimeout(o,f.Th):o();this.ke&&this.ke.focus()}}Be(){return document.createTextNode(this.message||"")}Ie(n){let t="";this.message||this.header||!this.xe()||(t="Modal Image");n.setAttribute("alt",t)}static lh(n){if(!n.targetTouches||!(n.targetTouches.length>1)){const t=n.target;t&&t.classList&&t.classList.contains("ab-message-text")&&t.scrollHeight>t.clientHeight||document.querySelector(`.${f.rh}`)&&n.preventDefault()}}ah(n){const t=n.parentNode;this.xe()&&null!=t&&this.orientation!==f.Orientation.LANDSCAPE&&(null!=t.classList&&t.classList.add(f.rh),document.body.addEventListener("touchmove",f.lh,!!to()&&{passive:!1}));n.className+=" "+f.uh}static mh(n){if(n.keyCode===ei.Ih&&!i.nn(s.Lh)&&document.querySelectorAll(".ab-modal-interactions").length>0){const t=document.getElementsByClassName("ab-html-message");let n=!1;for(const i of t){let t=null;uo(i)&&i.contentWindow&&(t=i.contentWindow.document.getElementsByClassName("ab-programmatic-close-button")[0]);null!=t&&(io(t),n=!0)}if(!n){const n=document.querySelectorAll(".ab-modal-interactions > .ab-close-button")[0];null!=n&&io(n)}}}Ah(){this.hh||i.nn(s.Lh)||(document.addEventListener("keydown",f.mh,!1),i.Nh(()=>{document.removeEventListener("keydown",f.mh)}),this.hh=!0)}}f.Ur={th:4281545523,Vr:4294967295,Qr:4278219733,dh:4293914607,_h:4283782485,ih:3224580915,sh:4288387995};f.Me={Oh:"hd",ze:"ias",Sh:"of",Dh:"do",Gr:"umt",Yi:"tf",Mh:"te"};f.SlideFrom={TOP:"TOP",BOTTOM:"BOTTOM"};f.ClickAction={NEWS_FEED:"NEWS_FEED",URI:"URI",NONE:"NONE"};f.DismissType={AUTO_DISMISS:"AUTO_DISMISS",MANUAL:"SWIPE"};f.OpenTarget={NONE:"NONE",BLANK:"BLANK"};f.ImageStyle={TOP:"TOP",GRAPHIC:"GRAPHIC"};f.Orientation={PORTRAIT:"PORTRAIT",LANDSCAPE:"LANDSCAPE"};f.TextAlignment={START:"START",CENTER:"CENTER",END:"END"};f.CropType={CENTER_CROP:"CENTER_CROP",FIT_CENTER:"FIT_CENTER"};f.Ee={Rh:"SLIDEUP",bh:"MODAL",Ne:"MODAL_STYLED",so:"FULL","do":"WEB_HTML",Pe:"HTML",ph:"HTML_FULL"};f.Th=500;f.Uh=200;f.uh="ab-show";f.Eh="ab-hide";f.rh="ab-pause-scrolling";class oi extends f{constructor(n,t,i,r,u,e,o,s,h,c,l){super(n,void 0,void 0,t,i,void 0,void 0,void 0,r=r||f.DismissType.MANUAL,u,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,e,o,void 0,void 0,void 0,s,void 0,void 0,void 0,h,c);this.messageFields=l;this.messageFields=l}io(){return!1}p(n){if(this.Ce===f.Ee.do){if(this.vo)return!1;this.vo=!0}return this.ht.Et(n),!0}}oi.es=f.Ee.do;class wi{constructor(n,t,i,r,u,e,o){this.text=n;this.backgroundColor=t;this.textColor=i;this.borderColor=r;this.clickAction=u;this.uri=e;this.id=o;this.text=n||"";this.backgroundColor=t||f.Ur.Qr;this.textColor=i||f.Ur.Vr;this.borderColor=r||this.backgroundColor;this.clickAction=u||f.ClickAction.NONE;this.uri=e;null==o&&(o=wi.Pi);this.id=o;this.vo=!1;this.ht=new k}subscribeToClickedEvent(n){return this.ht.lt(n)}removeSubscription(n){this.ht.removeSubscription(n)}removeAllSubscriptions(){this.ht.removeAllSubscriptions()}p(){return!this.vo&&(this.vo=!0,this.ht.Et(),!0)}static fromJson(n){return new wi(n.text,n.bg_color,n.text_color,n.border_color,n.click_action,n.uri,n.id)}}wi.Pi=-1;class bi extends f{constructor(n,t,i,r,u,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){s=s||f.DismissType.MANUAL;ft=ft||f.Orientation.PORTRAIT;super(n,t,void 0,i,r,u,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut=ut||f.CropType.CENTER_CROP,ft,et,ot);this.Le=f.TextAlignment.CENTER}}bi.es=f.Ee.so;class ir extends f{constructor(n,t,i,r,u,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){super(n,t,void 0,i,r,u,e,o,s=s||f.DismissType.MANUAL,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut=ut||f.CropType.FIT_CENTER,void 0,ft,et);this.Le=f.TextAlignment.CENTER}}ir.es=f.Ee.bh;class ki extends f{constructor(n,t,i,r,u,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){w=w||f.Ur._h;p=p||f.Ur.dh;super(n,t=t||f.TextAlignment.START,i,r,u,e,o,s,h,c,l,a,void 0,v,y,p,w,b,k,d,void 0,void 0,void 0,void 0,void 0,void 0,void 0,g,nt);this.Le=f.TextAlignment.START}xe(){return!1}Be(){const n=document.createElement("span");return n.appendChild(document.createTextNode(this.message||"")),n}ah(n){const t=n.getElementsByClassName("ab-in-app-message")[0];pi.eo(t,!0,!0)||(this.slideFrom===f.SlideFrom.TOP?t.style.top="0px":t.style.bottom="0px");super.ah(n)}}ki.es=f.Ee.Rh;class uf{constructor(n){this.xl=n}Bl(n){return null==this.xl||this.xl===n[0]}static fromJson(n){return new uf(n?n.event_name:null)}ss(){return this.xl}}class l{constructor(n,t,i,r){this.El=n;this.Hl=t;this.comparator=i;this.Il=r;this.Hl===l.Ql.Ul&&this.comparator!==l.Gl.Xl&&this.comparator!==l.Gl.Vl&&this.comparator!==l.Gl.Kl&&this.comparator!==l.Gl.Wl&&(this.Il=lt(this.Il))}Bl(n){let t=null;switch(null!=n&&(t=n[this.El]),this.comparator){case l.Gl.Yl:return null!=t&&t.valueOf()===this.Il.valueOf();case l.Gl.Zl:return null==t||t.valueOf()!==this.Il.valueOf();case l.Gl.Zh:return typeof t==typeof this.Il&&t>this.Il;case l.Gl.Xl:return this.Hl===l.Ql.Ul?null!=t&&ht(t)&&he(t)<=this.Il:typeof t==typeof this.Il&&t>=this.Il;case l.Gl.$h:return typeof t==typeof this.Il&&t<this.Il;case l.Gl.Vl:return this.Hl===l.Ql.Ul?null!=t&&ht(t)&&he(t)>=this.Il:typeof t==typeof this.Il&&t<=this.Il;case l.Gl.Eu:return null!=t&&"string"==typeof t&&typeof t==typeof this.Il&&null!=t.match(this.Il);case l.Gl.Tu:return null!=t;case l.Gl._u:return null==t;case l.Gl.Kl:return null!=t&&ht(t)&&ce(t)<this.Il;case l.Gl.Wl:return null!=t&&ht(t)&&ce(t)>this.Il;case l.Gl.yu:return null==t||typeof t!=typeof this.Il||"string"!=typeof t||null==t.match(this.Il)}return!1}static fromJson(n){return new l(n.property_key,n.property_type,n.comparator,n.property_value)}ss(){let n=this.Il;return ht(this.Il)&&(n=or(n.valueOf())),{k:this.El,t:this.Hl,c:this.comparator,v:n}}static Tn(n){return new l(n.k,n.t,n.c,n.v)}}l.Gl={Yl:1,Zl:2,Zh:3,Xl:4,$h:5,Vl:6,Eu:10,Tu:11,_u:12,Kl:15,Wl:16,yu:17};l.Ql={Nu:"boolean",Mu:"number",Ru:"string",Ul:"date"};class rr{constructor(n){this.filters=n}Bl(n){let t=!0;for(let i=0;i<this.filters.length;i++){const r=this.filters[i];let u=!1;for(let t=0;t<r.length;t++)if(r[t].Bl(n)){u=!0;break}if(!u){t=!1;break}}return t}static fromJson(n){if(null==n||!b(n))return null;const t=[];for(let i=0;i<n.length;i++){const r=[],u=n[i];for(let n=0;n<u.length;n++)r.push(l.fromJson(u[n]));t.push(r)}return new rr(t)}ss(){const n=[];for(let t=0;t<this.filters.length;t++){const i=this.filters[t],r=[];for(let n=0;n<i.length;n++)r.push(i[n].ss());n.push(r)}return n}static Tn(n){const t=[];for(let i=0;i<n.length;i++){const r=[],u=n[i];for(let n=0;n<u.length;n++)r.push(l.Tn(u[n]));t.push(r)}return new rr(t)}}class ff{constructor(n,t){this.xl=n;this.Jl=t}Bl(n){if(null==this.xl||null==this.Jl)return!1;const t=n[0],i=n[1];return t===this.xl&&this.Jl.Bl(i)}static fromJson(n){return new ff(n?n.event_name:null,n?rr.fromJson(n.property_filters):null)}ss(){return{e:this.xl,pf:this.Jl.ss()}}}class ef{constructor(n,t){this.ju=n;this.ku=t}Bl(n){if(null==this.ju)return!1;const t=e.wu(n[0],this.ju);if(!t)return!1;let i=null==this.ku||0===this.ku.length;if(null!=this.ku)for(let t=0;t<this.ku.length;t++)if(this.ku[t]===n[1]){i=!0;break}return t&&i}static fromJson(n){return new ef(n?n.id:null,n?n.buttons:null)}ss(){return this.ju}}class sf{constructor(n){this.productId=n}Bl(n){return null==this.productId||n[0]===this.productId}static fromJson(n){return new sf(n?n.product_id:null)}ss(){return this.productId}}class hf{constructor(n,t){this.productId=n;this.Jl=t}Bl(n){if(null==this.productId||null==this.Jl)return!1;const t=n[0],i=n[1];return t===this.productId&&this.Jl.Bl(i)}static fromJson(n){return new hf(n?n.product_id:null,n?rr.fromJson(n.property_filters):null)}ss(){return{id:this.productId,pf:this.Jl.ss()}}}class cf{constructor(n){this.ju=n}Bl(n){return null==this.ju||e.wu(n[0],this.ju)}static fromJson(n){return new cf(n?n.campaign_id:null)}ss(){return this.ju}}v={OPEN:"open",Rr:"purchase",zr:"push_click",be:"custom_event",Kr:"iam_click",ks:"test"};class e{constructor(n,t){this.type=n;this.data=t}ec(n,t){return e.tc[this.type]===n&&(null==this.data||this.data.Bl(t))}static wu(n,i){let r=null;try{r=window.atob(n)}catch(i){return t.j.info("Failed to unencode analytics id "+n+": "+i.message),!1}return i===r.split("_")[0]}static fromJson(n){const i=n.type;let t;switch(i){case e.rc.OPEN:t=null;break;case e.rc.Rr:t=sf.fromJson(n.data);break;case e.rc.ac:t=hf.fromJson(n.data);break;case e.rc.zr:t=cf.fromJson(n.data);break;case e.rc.be:t=uf.fromJson(n.data);break;case e.rc.sc:t=ff.fromJson(n.data);break;case e.rc.Kr:t=ef.fromJson(n.data);break;case e.rc.ks:t=null}return new e(i,t)}ss(){return{t:this.type,d:this.data?this.data.ss():null}}static Tn(n){let t,i;switch(n.t){case e.rc.OPEN:t=null;break;case e.rc.Rr:t=new sf(n.d);break;case e.rc.ac:i=n.d||{};t=new hf(i.id,rr.Tn(i.pf||[]));break;case e.rc.zr:t=new cf(n.d);break;case e.rc.be:t=new uf(n.d);break;case e.rc.sc:i=n.d||{};t=new ff(i.e,rr.Tn(i.pf||[]));break;case e.rc.Kr:t=new ef(n.d);break;case e.rc.ks:t=null}return new e(n.t,t)}}e.rc={OPEN:"open",Rr:"purchase",ac:"purchase_property",zr:"push_click",be:"custom_event",sc:"custom_event_property",Kr:"iam_click",ks:"test"};e.tc={};e.tc[e.rc.OPEN]=v.OPEN;e.tc[e.rc.Rr]=v.Rr;e.tc[e.rc.ac]=v.Rr;e.tc[e.rc.zr]=v.zr;e.tc[e.rc.be]=v.be;e.tc[e.rc.sc]=v.be;e.tc[e.rc.Kr]=v.Kr;e.tc[e.rc.ks]=v.ks;class ut{constructor(n,t,i,r,u,f,e,o,s,h,c,l){this.id=n;this.Du=t||[];void 0===i&&(i=null);this.startTime=i;void 0===r&&(r=null);this.endTime=r;this.priority=u||0;this.type=f;this.Pu=o||0;null==h&&(h=1e3*(this.Pu+30));this.Jr=h;this.data=e;null==s&&(s=ut.vu);this.zu=s;this.Iu=c;this.$u=l||null}xu(n){return null==this.$u||this.zu!==ut.vu&&n-this.$u>=1e3*this.zu}Bu(n){this.$u=n}Cu(n){const t=n+1e3*this.Pu;return Math.max(t-(new Date).valueOf(),0)}Hu(n){const i=(new Date).valueOf()-n,r=null==n||isNaN(i)||null==this.Jr||i<this.Jr;return r||t.j.info(`Trigger action ${this.type} is no longer eligible for display - fired ${i}ms ago and has a timeout of ${this.Jr}ms.`),!r}static fromJson(n){const r=n.id,t=[];for(let i=0;i<n.trigger_condition.length;i++)t.push(e.fromJson(n.trigger_condition[i]));const u=lt(n.start_time),f=lt(n.end_time),o=n.priority,i=n.type,s=n.delay,h=n.re_eligibility,c=n.timeout,l=n.data,a=n.min_seconds_since_last_trigger;return st(ut._r,i,"Could not construct Trigger from server data","Trigger.Types")?new ut(r,t,u,f,o,i,l,s,h,c,a):null}ss(){const n=[];for(let t=0;t<this.Du.length;t++)n.push(this.Du[t].ss());return{i:this.id,c:n,s:this.startTime,e:this.endTime,p:this.priority,t:this.type,da:this.data,d:this.Pu,r:this.zu,tm:this.Jr,ss:this.Iu,ld:this.$u}}static Tn(n){const t=[];for(let i=0;i<n.c.length;i++)t.push(e.Tn(n.c[i]));return new ut(n.i,t,vi(n.s),vi(n.e),n.p,n.t,n.da,n.d,n.r,n.tm,n.ss,n.ld)}}ut.vu=-1;ut._r={Mr:"inapp",Ju:"templated_iam"};class ul{constructor(n,t,r,u){this.gt=n;this._e=t;this.u=r;this.ft=u;this.gt=n;this._e=t;this.u=r;this.ft=u;this.Se=new k;i.jt(this.Se);this.Oe=1e3;this.Re=6e4;this.Qe=null}Ue(){return this.Se}Ve(n){return this.Se.lt(n)}We(){return this.Qe}Xe(n){this.Qe=n}Ye(n,i){if(!n||!st(f.Me,i,`${i} is not a valid in-app message display failure`,"InAppMessage.DisplayFailures"))return new gt;const r={trigger_ids:[n],error_code:i};return y.N(t.q.Ze,r)}N(n,i,r,u){const e=new gt;let f;if(n instanceof yi)f={trigger_ids:[n.triggerId]};else{if(i===t.q.Ii||n instanceof oi&&i===t.q.Mi){if(!n.p(u))return t.j.info("This in-app message has already received a click. Ignoring analytics event."),e}else if(i===t.q._i&&!n.M())return t.j.info("This in-app message has already received an impression. Ignoring analytics event."),e;f=this.Gi(n)}return null==f?e:(null!=r&&(f.bid=r),y.N(i,f))}Oi(n,i){const r=new gt;if(!n.p())return t.j.info("This in-app message button has already received a click. Ignoring analytics event."),r;const u=this.Gi(i);return null==u?r:n.id===wi.Pi?(t.j.info("This in-app message button does not have a tracking id. Not logging event to Braze servers."),r):(null!=n.id&&(u.bid=n.id),y.N(t.q.Mi,u))}Hi(n){if(n instanceof f){const i=n=>{if(n){const t=du(n);return gu(t)?ku(hr.Ji,"In-App Message"):ke(t)&&!rt.Ki()?ku(hr.Li,"In-App Message"):void 0}},r=n.buttons||[];let t;for(const n of r)if(n.clickAction===f.ClickAction.URI&&n.uri&&cr.test(n.uri)&&(t=i(n.uri),t))return t;if(n.clickAction===f.ClickAction.URI&&n.uri&&cr.test(n.uri))return i(n.uri)}}Qi(n,i,r,u){if(this.gt){const s=this.gt.Vi(!1,!1),e=this.gt.Gs(s);e.template={trigger_id:n.triggerId,trigger_event_type:i};null!=r&&(e.template.data=r.Wi());const o=this.gt.Ks(e,w.Qs.Xi);this.gt.Vs(e,()=>{this.gt&&(w.Xs(this.u,w.Qs.Xi,(new Date).valueOf()),nu.Ys({url:`${this.gt.Zs()}/template/`,data:e,headers:o,O:i=>{if(!this.gt.ti(e,i,o))return this.Ye(n.triggerId,f.Me.Yi),void("function"==typeof n.Zi&&n.Zi());if(this.gt.si(),null==i||null==i.templated_message)return void this.Ye(n.triggerId,f.Me.Yi);const u=i.templated_message;if(u.type!==ut._r.Mr)return void this.Ye(n.triggerId,f.Me.Gr);const r=fo(u.data);if(null==r)return void this.Ye(n.triggerId,f.Me.Gr);const s=this.Hi(r);if(s)return t.j.error(s),void("function"==typeof n.Zi&&n.Zi());"function"==typeof n.Or?n.Or(r):this.Ye(n.triggerId,f.Me.Yi)},error:t=>{let e=`getting user personalization for message ${n.triggerId}`;if((new Date).valueOf()-n.Hr>n.Jr)this.Ye(n.triggerId,f.Me.Yi);else{const o=Math.min(n.Jr,this.Re),f=this.Oe;null==u&&(u=f);const t=Math.min(o,tu(f,3*u));e+=`. Retrying in ${t} ms`;setTimeout(()=>{this.Qi(n,i,r,t)},t)}this.gt.ii(t,e)}}))})}}Gi(n){if(null==n.triggerId)return t.j.info("The in-app message has no analytics id. Not logging event to Braze servers."),null;const i={};return null!=n.triggerId&&(i.trigger_ids=[n.triggerId]),i}}const ti={i:null,t:!1,m:()=>(ti.o(),ti.i||(ti.i=new ul(i.ar(),i.aa(),i.l(),i.ir())),ti.i),o:()=>{ti.t||(i.g(ti),ti.t=!0)},destroy:()=>{ti.i=null,ti.t=!1}};ii=ti;const ci={PORTRAIT:0,LANDSCAPE:1};const li={openUri:cl,no:sl,ao:hl,An:ll};const vf={Ge:n=>{const t=n.querySelectorAll(".ab-close-button, .ab-message-text, .ab-message-button");let i;for(let n=0;n<t.length;n++)i=t[n],i.tabIndex=0;if(t.length>0){const i=t[0],r=t[t.length-1];n.addEventListener("keydown",t=>{const u=document.activeElement;t.keyCode===ei.oo&&(t.shiftKey||u!==r&&u!==n?!t.shiftKey||u!==i&&u!==n||(t.preventDefault(),r.focus()):(t.preventDefault(),i.focus()))})}},He:(n,t)=>{t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.setAttribute("aria-label","Modal Message"),n&&t.setAttribute("aria-labelledby",n)},De:(n,t,i,r)=>{if(n.buttons&&n.buttons.length>0){const u=document.createElement("div");u.className="ab-message-buttons";i.appendChild(u);const e=i.getElementsByClassName("ab-message-text")[0];null!=e&&(e.className+=" ab-with-buttons");const o=u=>e=>(n.he(i,()=>{yo(u,n),u.clickAction===f.ClickAction.URI?uu(u.uri||"",r||n.openTarget===f.OpenTarget.BLANK,e):u.clickAction===f.ClickAction.NEWS_FEED&&t()}),e.stopPropagation(),!1);for(let t=0;t<n.buttons.length;t++){const r=n.buttons[t],i=document.createElement("button");i.className="ab-message-button";i.setAttribute("type","button");ar(i,"touchstart");let f=r.text;""===r.text&&(f="");i.appendChild(document.createTextNode(f));n.ye()||(i.style.backgroundColor=vt(r.backgroundColor),i.style.color=vt(r.textColor),i.style.borderColor=vt(r.borderColor));i.onclick=o(r);u.appendChild(i)}}}};class bo{constructor(n,t,i,r,u){this.triggerId=n;this.Or=t;this.Zi=i;this.Hr=r;this.Jr=u;this.triggerId=n;this.Or=t;this.Zi=i;this.Hr=r;this.Jr=u}static fromJson(n,t,i,r,u){return null==n||null==n.trigger_id?null:new bo(n.trigger_id,t,i,r,u)}}class wl extends lr{constructor(n,t,i,r,u){super();this.tg=n;this.ig=t;this.Jn=i;this.Ch=r;this.sg=u;this.eg=[];this.hg=[];this.og=null;this.ng={};this.lg={};this.ag();this.gg()}fg(){this.og=this.Jn.v(u.k.La)||this.og;this.ng=this.Jn.v(u.k.Fa)||this.ng;this.lg=this.Jn.v(u.k.Ua)||this.lg;for(let n=0;n<this.cg.length;n++){const t=this.cg[n];null!=this.lg[t.id]&&t.Bu(this.lg[t.id])}}ag(){this.ug=this.Jn.v(u.k.Ga)||0;const n=this.Jn.v(u.k.Na)||[],t=[];for(let i=0;i<n.length;i++)t.push(ut.Tn(n[i]));this.cg=t;this.fg()}gg(){const i=this,r=function(n,t,r,u,f){return function(){i.dg(n,t,r,u,f)}},n={};for(let t=0;t<this.cg.length;t++)n[this.cg[t].id]=this.cg[t];let t=!1;for(let i=0;i<this.cg.length;i++){const u=this.cg[i];if(null!=this.ng[u.id]){const f=this.ng[u.id],i=[];for(let t=0;t<f.length;t++){const e=f[t],o=u.Cu(e.Hr);if(o>0){let t,f;i.push(e);null!=e.mg&&(t=e.mg);null!=e.pg&&ft.Za(e.pg)&&(f=ft.Tn(e.pg));const s=[];if(b(e.bg))for(let t=0;t<e.bg.length;t++){const i=n[e.bg[t]];null!=i&&s.push(i)}this.hg.push(setTimeout(r(u,e.Hr,t,f,s),o))}}this.ng[u.id].length>i.length&&(this.ng[u.id]=i,t=!0,0===this.ng[u.id].length&&delete this.ng[u.id])}}t&&this.Jn.D(u.k.Fa,this.ng)}Tg(){const n=[];for(let t=0;t<this.cg.length;t++)n.push(this.cg[t].ss());this.ug=(new Date).valueOf();this.Jn.D(u.k.Na,n);this.Jn.D(u.k.Ga,this.ug)}yg(){(this.Jn.v(u.k.Ga)||0)>this.ug?this.ag():this.fg()}Ts(n){let i=!1;if(null!=n&&n.triggers){this.fg();const r={},f={};this.cg=[];for(let t=0;t<n.triggers.length;t++){const u=ut.fromJson(n.triggers[t]);null!=this.lg[u.id]&&(u.Bu(this.lg[u.id]),r[u.id]=this.lg[u.id]);null!=this.ng[u.id]&&(f[u.id]=this.ng[u.id]);for(let n=0;n<u.Du.length;n++)if(u.Du[n].ec(v.ks,null)){i=!0;break}null!=u&&this.cg.push(u)}ai(this.lg,r)||(this.lg=r,this.Jn.D(u.k.Ua,this.lg));ai(this.ng,f)||(this.ng=f,this.Jn.D(u.k.Fa,this.ng));this.Tg();i&&(t.j.info("Trigger with test condition found, firing test."),this.je(v.ks));this.je(v.OPEN);const e=this.eg;this.eg=[];for(let n=0;n<e.length;n++)this.je.apply(this,e[n])}}dg(n,i,r,u,e){const l=u=>{this.fg();const e=(new Date).valueOf();if(!n.Hu(i))return!1===navigator.onLine&&n.type===ut._r.Mr&&u.imageUrl?(t.j.info(`Not showing ${n.type} trigger action ${n.id} due to offline state.`),void this.sg.Ye(n.id,f.Me.Dh)):void(n.xu(e)&&this.vg(n,e,r)?0===this.ig.fu()?t.j.info(`Not displaying trigger ${n.id} because neither automaticallyShowInAppMessages() nor subscribeToInAppMessage() were called.`):(this.ig.Et([u]),this.wg(n,e)):t.j.info(`Not displaying trigger ${n.id} because display time fell outside of the acceptable time window.`));n.type===ut._r.Ju?this.sg.Ye(n.id,f.Me.Yi):this.sg.Ye(n.id,f.Me.Mh)},s=()=>{this.fg();const o=e.pop();if(null!=o)if(this.$g(o,i,r,u,e),o.Hu(i)){let n=`Server aborted in-app message display, but the timeout on fallback trigger ${o.id} has already elapsed.`;e.length>0&&(n+=" Continuing to fall back.");t.j.info(n);this.sg.Ye(o.id,f.Me.Mh);s()}else{t.j.info(`Server aborted in-app message display. Falling back to lower priority ${o.type} trigger action ${n.id}.`);const f=1e3*o.Pu-((new Date).valueOf()-i);f>0?this.hg.push(setTimeout(()=>{this.dg(o,i,r,u,e)},f)):this.dg(o,i,r,u,e)}};let o,h,c;switch(n.type){case ut._r.Mr:if(o=fo(n.data),null==o){t.j.error(`Could not parse trigger data for trigger ${n.id}, ignoring.`);this.sg.Ye(n.id,f.Me.Gr);break}if(h=this.sg.Hi(o),h){t.j.error(h);s();break}l(o);break;case ut._r.Ju:if(c=bo.fromJson(n.data,l,s,i,n.Jr),null==c){t.j.error(`Could not parse trigger data for trigger ${n.id}, ignoring.`);this.sg.Ye(n.id,f.Me.Gr);break}this.sg.Qi(c,r,u);break;default:t.j.error(`Trigger ${n.id} was of unexpected type ${n.type}, ignoring.`);this.sg.Ye(n.id,f.Me.Gr)}}je(n,i,r){if(st(v,n,"Cannot fire trigger action.","TriggerEvents")){if(this.Ch._l())return t.j.info("Trigger sync is currently in progress, awaiting sync completion before firing trigger event."),void this.eg.push(arguments);this.yg();const f=(new Date).valueOf(),h=f-this.og;let o=!0,s=!0;const e=[];for(let t=0;t<this.cg.length;t++){const r=this.cg[t],u=f+1e3*r.Pu;if(r.xu(u)&&(null==r.startTime||r.startTime<=f)&&(null==r.endTime||r.endTime>=f)){let t=!1;for(let u=0;u<r.Du.length;u++)if(r.Du[u].ec(n,i)){t=!0;break}t&&(o=!1,this.vg(r,u,n)&&(s=!1,e.push(r)))}}if(o)return void t.j.info(`Trigger event ${n} did not match any trigger conditions.`);if(s)return void t.j.info(`Ignoring ${n} trigger event because a trigger was displayed ${h/1e3}s ago.`);e.sort((n,t)=>n.priority-t.priority);const u=e.pop();null!=u&&(t.j.info(`Firing ${u.type} trigger action ${u.id} from trigger event ${n}.`),this.$g(u,f,n,r,e),0===u.Pu?this.dg(u,f,n,r,e):this.hg.push(setTimeout(()=>{this.dg(u,f,n,r,e)},1e3*u.Pu)))}}changeUser(n){if(this.cg=[],this.Jn.ri(u.k.Na),!n){this.eg=[];this.og=null;this.lg={};this.ng={};for(let n=0;n<this.hg.length;n++)clearTimeout(this.hg[n]);this.hg=[];this.Jn.ri(u.k.La);this.Jn.ri(u.k.Ua);this.Jn.ri(u.k.Fa)}}clearData(){this.cg=[];this.og=null;this.lg={};this.ng={};for(let n=0;n<this.hg.length;n++)clearTimeout(this.hg[n]);this.hg=[]}vg(n,i,r){if(null==this.og)return!0;if(r===v.ks)return t.j.info("Ignoring minimum interval between trigger because it is a test type."),!0;let u=n.Iu;return null==u&&(u=this.tg),i-this.og>=1e3*u}$g(n,t,i,r,f){this.fg();this.ng[n.id]=this.ng[n.id]||[];const e={};let o;e.Hr=t;e.mg=i;null!=r&&(o=r.ss());e.pg=o;const s=[];for(let n=0;n<f.length;n++)s.push(f[n].id);e.bg=s;this.ng[n.id].push(e);this.Jn.D(u.k.Fa,this.ng)}wg(n,t){this.fg();n.Bu(t);this.og=t;this.Jn.D(u.k.La,t);this.lg[n.id]=t;this.Jn.D(u.k.Ua,this.lg)}}const d={t:!1,provider:null,er:()=>(d.init(),d.provider),rg:()=>{if(!d.provider){const n=i.nn(s.No);d.provider=new wl(null!=n?n:30,ii.m().Ue(),i.l(),i.cr(),ii.m());i.dr(d.provider)}},init:()=>{d.t||(d.rg(),i.g(d),d.t=!0)},destroy:()=>{d.provider=null,d.t=!1}};class yf{constructor(n,t,i,r,u){this.endpoint=n||null;this.Nn=t||null;this.publicKey=i||null;this.zl=r||null;this.al=u||null}ss(){return{e:this.endpoint,c:this.Nn,p:this.publicKey,u:this.zl,v:this.al}}static Tn(n){return new yf(n.e,vi(n.c),n.p,n.u,n.v)}}class bl{constructor(n,t){this.wt=n;this.u=t;this.wt=n;this.u=t}getUserId(){const t=this.u.tu(u.eu.su);if(null==t)return null;let n=t.iu,i=dr(n);if(i>h.lr){for(;i>h.lr;)n=n.slice(0,n.length-1),i=dr(n);t.iu=n;this.u.uu(u.eu.su,t)}return n}ru(n){const t=null==this.getUserId();this.u.uu(u.eu.su,new tr(n));t&&this.u.ou(n)}setCustomUserAttribute(n,i){if(this.wt.hu(n))return t.j.info('Custom Attribute "'+n+'" is blocklisted, ignoring.'),!1;const r={};return r[n]=i,this.nu(h.lu,r,!0)}nu(n,i,r=!1,u=!1){const o=this.u.mu(this.getUserId(),n,i);let s="",e=n,f=i;return r&&(s=" custom","object"==typeof i&&(e=Object.keys(i)[0],f=i[e],"object"==typeof f&&(f=JSON.stringify(f,null,2)))),!u&&o&&t.j.info(`Logged${s} attribute ${e} with value ${f}`),o}yn(n,i,r,f,e){this.nu("push_token",n,!1,!0);this.nu("custom_push_public_key",r,!1,!0);this.nu("custom_push_user_auth",f,!1,!0);this.nu("custom_push_vapid_public_key",e,!1,!0);const o=t.zt.Ft,s=new t.xt(o,t.j),h=new yf(n,i,r,f,e);this.u.D(u.k.xn,h.ss());s.setItem(o.Jt.cu,o.se,!0)}wn(n){if(this.nu("push_token",null,!1,!0),this.nu("custom_push_public_key",null,!1,!0),this.nu("custom_push_user_auth",null,!1,!0),this.nu("custom_push_vapid_public_key",null,!1,!0),n){const n=t.zt.Ft,i=new t.xt(n,t.j);this.u.D(u.k.xn,!1);i.setItem(n.Jt.cu,n.se,!1)}}}const s={ho:"allowCrawlerActivity",Eo:"baseUrl",_o:"noCookies",Io:"devicePropertyAllowlist",ia:"disablePushTokenMaintenance",Ao:"enableLogging",So:"enableSdkAuthentication",ta:"manageServiceWorkerExternally",No:"minimumIntervalBetweenTriggerActionsInSeconds",wo:"sessionTimeoutInSeconds",To:"appVersion",na:"serviceWorkerLocation",ra:"safariWebsitePushId",Mn:"localization",lo:"contentSecurityNonce",Oo:"enableHtmlInAppMessages",Co:"allowUserSuppliedJavascript",mo:"inAppMessageZIndex",po:"openInAppMessagesInNewTab",tn:"openCardsInNewTab",en:"openNewsFeedCardsInNewTab",Lh:"requireExplicitInAppMessageDismissal",Lo:"doNotLoadFontAwesome",Po:"sdkFlavor"};class kl{constructor(){this.Ro=!1;this.Mo=!1;this.jo=new k;this.Do=new k;this.Uo={};this.Bo=[];this.Wo=[];this.zo=[];this.Vo="4.8.0"}Go(n){this.jo.lt(n)}Nh(n){this.Do.lt(n)}initialize(n,i){if(this.ue())return t.j.info("Braze has already been initialized with an API key."),!0;this.Uo=i||{};let e=this.nn(s.Ao);const o=vo(li.An());if(o&&"true"===o.brazeLogging&&(e=!0),t.j.init(e),t.j.info(`Initialization Options: ${JSON.stringify(this.Uo,null,2)}`),null==n||""===n||"string"!=typeof n)return t.j.error("Braze requires a valid API key to be initialized."),!1;this.Ko=n;let r=this.nn(s.Eo);if(null==r||""===r||"string"!=typeof r)return t.j.error("Braze requires a valid baseUrl to be initialized."),!1;!1===/^https?:/.test(r)&&(r=`https://${r}`);let a=r;if(r=document.createElement("a"),r.href=a,"/"===r.pathname&&(r=`${r}api/v3`),this.Ho=r.toString(),it.$o&&!this.nn(s.ho))return t.j.info("Ignoring activity from crawler bot "+navigator.userAgent),this.Mo=!0,!1;const h=this.nn(s._o)||!1;if(this.Jn=no.qo(n,h),h&&this.Jn.xo(n),new g.ee(null,!0).wr(u.re))return t.j.info("Ignoring all activity due to previous opt out"),this.Mo=!0,!1;for(const n of ct(this.Uo))-1===wr(t.Jo).indexOf(n)&&t.j.warn(`Ignoring unknown initialization option '${n}'.`);const v=["mparticle","wordpress","tealium"];if(null!=this.nn(s.Po)){const n=this.nn(s.Po);-1!==v.indexOf(n)?this.Yo=n:t.j.error("Invalid sdk flavor passed: "+n)}let f=this.nn(t.Jo.Io);if(null!=f)if(b(f)){const n=[];for(let t=0;t<f.length;t++)st(c,f[t],"devicePropertyAllowlist contained an invalid value.","DeviceProperties")&&n.push(f[t]);f=n}else t.j.error("devicePropertyAllowlist must be an array. Defaulting to all properties."),f=null;this.Xo=new wc(this.Jn,f);this.Zo=new gc(this.Jn);this.Qo=new bl(this.Zo,this.Jn);this.fh=new nl(this.Jn,this.Qo,this.Zo,this.nn(s.wo));const l=new k;return this.gh=new yc(this.Jn,this.nn(s.So),l),this.jt(l),this.wh=new bc(this.Xo,this.Jn,this.gh,this.Qo,this.fh,this.Zo,this.Ko,this.Ho,this.Vo,this.Yo,this.nn(s.To)),this.Ch=new dc(this.Ko,this.Ho,this.fh,this.Xo,this.Qo,this.Zo,this.Jn,n=>{if(this.ue())for(const t of this.gr())t.Ts(n)},this.gh,this.wh),this.Ch.initialize(),t.j.info(`Initialized for the Braze backend at "${this.nn(s.Eo)}" with API key "${this.Ko}".`),null!=this.nn(s.Oo)&&ge("enableHtmlInAppMessages","initialization option","allowUserSuppliedJavascript"),d.init(),this.Zo.Ni(()=>{this.Ro&&this.Zo.bi()&&Promise.resolve().then(function(){return te}).then(n=>{this.Ro&&n.default()})}),this.Ch.pr(()=>{this.Ro&&this.Zo.bi()&&Promise.resolve().then(function(){return te}).then(n=>{this.Ro&&n.default(null,null,!0)})}),this.jo.Et(this.Uo),this.Ro=!0,!0}destroy(n){if(t.j.destroy(),this.ue()){this.Do.Et();this.Do.removeAllSubscriptions();for(const n of this.Bo)n.destroy();this.Bo=[];for(const n of this.Wo)n.clearData(!1);this.Wo=[];this.removeAllSubscriptions();this.zo=[];this.Ch.destroy();this.Ch=null;this.gh=null;this.Xo=null;this.wh=null;this.Zo=null;this.fh=null;this.Qo=null;this.Uo={};this.Yo=void 0;this.Ro=!1;this.Mo=!1;n&&(this.Jn=null)}}rr(){if(this.Ph())return!1;if(!this.ue())throw new Error(at);return!0}ea(){return this.Ko}Sr(){return this.gh}Zs(){return this.Ho}ie(){return this.Xo}ar(){return this.wh}nn(n){return this.Uo[n]}gr(){return this.Wo}cr(){return this.Ch}tr(){return this.Zo}aa(){return this.fh}l(){return this.Jn}jr(){if(this.Qo&&this.Ch)return new h(this.Qo,this.Ch)}ir(){return this.Qo}nr(){return!0===this.nn(s.Co)||!0===this.nn(s.Oo)}g(n){let t=!1;for(const i of this.Bo)i===n&&(t=!0);t||this.Bo.push(n)}dr(n){let t=!1;for(const i of this.Wo)i.constructor===n.constructor&&(t=!0);n instanceof lr&&!t&&this.Wo.push(n)}jt(n){n instanceof k&&this.zo.push(n)}removeAllSubscriptions(){if(this.rr())for(const n of this.zo)n.removeAllSubscriptions()}removeSubscription(n){if(this.rr())for(const t of this.zo)t.removeSubscription(n)}ae(n){this.Mo=n}ue(){return this.Ro}Ph(){return this.Mo}Us(){return this.Vo}}const i=new kl,dl={N:(n,r,u)=>{const f=new gt,e=i.aa();if(!e)return t.j.info(`Not logging event with type "${n}" because the current session ID could not be found.`),f;const o=e.bo();return f.ve.push(new ft(u||i.ir().getUserId(),n,(new Date).valueOf(),o,r)),f.O=i.l().co(f.ve),f}};y=dl;class gl{constructor(n){this.u=n;this.u=n}h(n,i){const r=new gt;if(n.p(),null==n.url||""===n.url)return t.j.info(`Card ${n.id} has no url. Not logging click to Braze servers.`),r;if(i&&n.id&&this.u){const t=this.u.v(u.k.C)||{};t[n.id]=!0;this.u.D(u.k.C,t)}const f=this.I([n]);if(null==f)return r;const e=i?t.q.$:t.q.B;return y.N(e,f)}A(n){const i=new gt;if(!n.F())return t.j.info(`Card ${n.id} refused this dismissal. Ignoring analytics event.`),i;if(n.id&&this.u){const t=this.u.v(u.k.G)||{};t[n.id]=!0;this.u.D(u.k.G,t)}const r=this.I([n]);return null==r?i:y.N(t.q.H,r)}J(n,i){const r=new gt(!0),s=[],h=[];let f;this.u&&(f=i?this.u.v(u.k.K)||{}:this.u.v(u.k.L)||{});for(const t of n)t.M(),t instanceof sr?h.push(t):s.push(t),t.id&&(f[t.id]=!0);const e=this.I(s),o=this.I(h);if(null==e&&null==o)return r.O=!1,r;if(this.u&&(i?this.u.D(u.k.K,f):this.u.D(u.k.L,f)),null!=e){const n=i?t.q.P:t.q.R,u=y.N(n,e);r.S(u)}if(null!=o&&i){const n=y.N(t.q.T,o);r.S(n)}return r}I(n){let i,t=null;for(let r=0;r<n.length;r++)i=n[r].id,null!=i&&""!==i&&(t=t||{},t.ids=t.ids||[],t.ids.push(i));return t}}const ri={t:!1,i:null,m:()=>(ri.o(),ri.i||(ri.i=new gl(i.l())),ri.i),o:()=>{ri.t||(i.g(ri),ri.t=!0)},destroy:()=>{ri.i=null,ri.t=!1}};eu=ri;class di{constructor(n,t){this.cards=n;this.lastUpdated=t}getUnreadCardCount(){let n=0;for(const t of this.cards)t.viewed||t instanceof sr||n++;return n}ur(){throw new Error("Must be implemented in a subclass");}logCardImpressions(){throw new Error("Must be implemented in a subclass");}logCardClick(){throw new Error("Must be implemented in a subclass");}sr(){throw new Error("Must be implemented in a subclass");}}di.mr=6e4;di.Th=500;di.uo=1e4;class ra extends lr{constructor(n,r,u,f,e){super();this.ft=n;this.u=r;this.wt=u;this.vt=f;this.gt=e;this.ft=n;this.u=r;this.wt=u;this.vt=f;this.gt=e;this.yt=new k;i.jt(this.yt);this.kt=0;this.Ut=0;this.cards=[];this.Lt();const o=t.zt.Ft;new t.xt(o,t.j).Mt(o.Jt.qt,n=>{this.Pt(n)});this.$t=null;this._t=null;this.Bt=null;this.Gt=null;this.Ht=null;this.Kt=null;this.Ot=10;this.Qt=0}Vt(){return this._t}Wt(n){this._t=n}Xt(){return this.Bt}Yt(n){this.Bt=n}Lt(){if(this.u){const n=this.u.v(u.k.Zt)||[],t=[];for(let i=0;i<n.length;i++){const r=go(n[i]);null!=r&&t.push(r)}this.cards=this.Cs(this.ws(t,!1));this.kt=this.u.v(u.k.vs)||this.kt;this.Ut=this.u.v(u.k.ys)||this.Ut}}Ns(n,t=!1,i=0,r=0){let f;if(t){f=[];for(const n of this.cards)n.test&&f.push(n)}else f=this.cards.slice();for(let i=0;i<n.length;i++){const r=n[i];let u=null;for(let n=0;n<this.cards.length;n++)if(r.id===this.cards[n].id){u=this.cards[n];break}if(t){const n=wf(r);null!=u&&u.viewed&&n&&(n.viewed=!0);null!=n&&f.push(n)}else if(null==u){const n=wf(r);null!=n&&f.push(n)}else if(!u.ot(r))for(let n=0;n<f.length;n++)if(r.id===f[n].id){f.splice(n,1);break}}this.cards=this.Cs(this.ws(f,t));this.Rs();this.kt=i;this.Ut=r;this.u&&(this.u.D(u.k.vs,this.kt),this.u.D(u.k.ys,this.Ut))}Ts(n){if(this.Ds()&&null!=n&&n.cards){this.u&&this.u.D(u.k.Ss,i.Us());const t=n.full_sync;t||this.Lt();this.Ns(n.cards,t,n.last_full_sync_at,n.last_card_updated_at);this.yt.Et(this.As(!0))}}Ls(n){this.u&&this.u.D(u.k.Fs,n)}Ms(n,i,r){const s=()=>{this.Es(i,r,!0)},h=kc(n);let o;if(this.qs(),!h["retry-after"])return void this.Ls(0);const f=h["retry-after"];if(isNaN(f)&&!isNaN(Date.parse(f)))o=Date.parse(f)-(new Date).getTime(),o<0&&s();else{if(isNaN(parseFloat(f.toString())))return y.N(t.q.Is,{e:"Received unexpected value for retry-after header in /sync response: "+f}),void this.Ls(0);o=1e3*parseFloat(f.toString())}this.Gt=window.setTimeout(()=>{s()},o);let e=0;this.u&&(e=this.u.v(u.k.Fs));(null==e||isNaN(parseInt(e.toString())))&&(e=0);this.Ls(parseInt(e.toString())+1)}Pt(n){if(this.Ds()){this.Lt();const t=this.cards.slice();let i=null;this.ft&&(i=this.ft.getUserId());for(let r=0;r<n.length;r++)if(i===n[r].userId||null==i&&null==n[r].userId){const i=n[r].card;let u=null;for(let n=0;n<this.cards.length;n++)if(i.id===this.cards[n].id){u=this.cards[n];break}if(null==u){const n=wf(i);null!=n&&t.push(n)}else if(!u.ot(i))for(let n=0;n<t.length;n++)if(i.id===t[n].id){t.splice(n,1);break}}this.cards=this.Cs(this.ws(t,!1));this.Rs();this.yt.Et(this.As(!0))}}ws(n,t){let i={},r={},f={};this.u&&(i=this.u.v(u.k.C)||{},r=this.u.v(u.k.K)||{},f=this.u.v(u.k.G)||{});const e={},o={},s={};for(let t=0;t<n.length;t++){const u=n[t].id;u&&(i[u]&&(n[t].clicked=!0,e[u]=!0),r[u]&&(n[t].viewed=!0,o[u]=!0),f[u]&&(n[t].dismissed=!0,s[u]=!0))}return t&&this.u&&(this.u.D(u.k.C,e),this.u.D(u.k.K,o),this.u.D(u.k.G,s)),n}Cs(n){const r=[],e=new Date;let i={};this.u&&(i=this.u.v(u.k.G)||{});let f=!1;for(let u=0;u<n.length;u++){const s=n[u].url;if(!this.vt&&s&&af(s)){t.j.error(`Card with url ${s} will not be displayed because Javascript URLs are disabled. Use the "allowUserSuppliedJavascript" option for braze.initialize to enable this card.`);continue}const h=n[u].expiresAt;let o=!0;if(null!=h&&(o=h>=e),o=o&&!n[u].dismissed,o)r.push(n[u]);else{const t=n[u].id;t&&(i[t]=!0);f=!0}}return f&&this.u&&this.u.D(u.k.G,i),r}Rs(){if(this.u){const n=[];for(let t=0;t<this.cards.length;t++)n.push(this.cards[t].ss());this.u.D(u.k.Zt,n)}}qs(){this.Gt&&(clearTimeout(this.Gt),this.Gt=null)}Js(){null!=this.Ht&&(clearTimeout(this.Ht),this.Ht=null)}Ps(n=1e3*this.Ot,t,i){this.Js();this.Ht=window.setTimeout(()=>{this.Es(t,i,!0)},n);this.Kt=n}Es(n,r,f=!1,e=!0){var c;const o=this.gt,a=this.u;if(!o||!a)return void("function"==typeof r&&r());const l=!f;if(l&&(this.qs(),this.Ls(0)),!this.Ds())return void(!this.$t&&this.wt&&(this.$t=this.wt.$s(()=>{this.Es(n,r)})));let v=!0;if(l&&(null===(c=this.wt)||void 0===c?void 0:c._s())&&(v=this.Bs()),!v)return void t.j.info("Content card sync being throttled.");e&&this.Js();const s=o.Gs({},!0);a.v(u.k.Ss)!==i.Us()&&this.Hs();s.last_full_sync_at=this.kt;s.last_card_updated_at=this.Ut;const y=o.Ks(s,w.Qs.Os,f);let h=!1;o.Vs(s,()=>{if(this.u){const n=(new Date).valueOf();l&&this.u.D(u.k.Ws,n);w.Xs(this.u,w.Qs.Os,n)}nu.Ys({url:o.Zs()+"/content_cards/sync",data:s,headers:y,O:(t,i)=>{if(!o.ti(s,t,y))return h=!0,void("function"==typeof r&&r());o.si();this.Ms(i,n,r);this.Ts(t);h=!1;"function"==typeof n&&n()},error:n=>{o.ii(n,"retrieving content cards"),h=!0,"function"==typeof r&&r()},ei:()=>{if(h&&e&&!this.Ht&&this.Qt+1<uc){let t=this.Kt;(null==t||t<1e3*this.Ot)&&(t=1e3*this.Ot);this.Ps(Math.min(3e5,tu(1e3*this.Ot,3*t)),n,r);this.Qt=this.Qt+1}}})})}As(n){n||this.Lt();const i=this.Cs(this.cards);i.sort((n,t)=>n.pinned&&!t.pinned?-1:t.pinned&&!n.pinned?1:n.updated&&t.updated&&n.updated>t.updated?-1:n.updated&&t.updated&&t.updated>n.updated?1:0);let t=Math.max(this.Ut||0,this.kt||0);return 0===t&&(t=void 0),this.u&&this.u.v(u.k.ys)===this.Ut&&void 0===t&&(t=this.Ut),new si(i,lt(t))}hi(n){return this.yt.lt(n)}Hs(){this.kt=0;this.Ut=0;this.u&&(this.u.ri(u.k.vs),this.u.ri(u.k.ys))}changeUser(n){n||(this.cards=[],this.yt.Et(new si(this.cards.slice(),null)),this.u&&(this.u.ri(u.k.Zt),this.u.ri(u.k.C),this.u.ri(u.k.K),this.u.ri(u.k.G)));this.Hs()}clearData(n){this.kt=0;this.Ut=0;this.cards=[];this.yt.Et(new si(this.cards.slice(),null));n&&this.u&&(this.u.ri(u.k.Zt),this.u.ri(u.k.C),this.u.ri(u.k.K),this.u.ri(u.k.G),this.u.ri(u.k.vs),this.u.ri(u.k.ys))}Ds(){return!(this.wt&&!this.wt.ni())||(0!==this.wt.oi()&&this.li(),!1)}ai(n){this.u&&this.u.D(u.k.ui,n)}ci(){return this.u?this.u.v(u.k.ui):null}Bs(){const f=this.u,t=this.wt;if(!f||!t)return!0;const i=f.v(u.k.Ws);if(null==i||isNaN(i))return!0;const r=t.fi(),e=t.di();if(-1===r||-1===e)return!0;let n=this.ci();(null==n||isNaN(n))&&(n=r);const o=((new Date).valueOf()-i)/1e3;return n=Math.min(n+o/e,r),!(n<1)&&(n=Math.trunc(n)-1,this.ai(n),!0)}li(){this.yt.Et(new si([],new Date));this.u&&this.u.ri(u.k.Zt)}}const yt={t:!1,provider:null,er:()=>(yt.o(),yt.provider||(yt.provider=new ra(i.ir(),i.l(),i.tr(),i.nr(),i.ar()),i.dr(yt.provider)),yt.provider),o:()=>{yt.t||(i.g(yt),yt.t=!0)},destroy:()=>{yt.provider=null,yt.t=!1}};ur=yt;class si extends di{constructor(n,t){super(n,t)}getUnviewedCardCount(){return super.getUnreadCardCount()}logCardImpressions(n){su(n,!0)}logCardClick(n){ou(n,!0)}sr(){ns()}ur(){return!0}}si.mr=6e4;hu={en:{NO_CARDS_MESSAGE:"We have no updates for you at this time.<br/>Please check again later.",FEED_TIMEOUT_MESSAGE:"Sorry, this refresh timed out.<br/>Please try again later."},ar:{NO_CARDS_MESSAGE:"   .     ",FEED_TIMEOUT_MESSAGE:"   "},cs:{NO_CARDS_MESSAGE:"V tuto chvli pro vs nemme dn aktualizace.<br/>Zkontrolujte prosm znovu pozdji.",FEED_TIMEOUT_MESSAGE:"Prosm zkuste to znovu pozdji."},da:{NO_CARDS_MESSAGE:"Vi har ingen updates.<br/>Prv venligst senere.",FEED_TIMEOUT_MESSAGE:"Prv venligst senere."},de:{NO_CARDS_MESSAGE:"Derzeit sind keine Updates verfgbar.<br/>Bitte spter noch einmal versuchen.",FEED_TIMEOUT_MESSAGE:"Bitte spter noch einmal versuchen."},es:{NO_CARDS_MESSAGE:"No tenemos actualizaciones.<br/>Por favor comprubelo ms tarde.",FEED_TIMEOUT_MESSAGE:"Por favor intntelo ms tarde."},"es-mx":{NO_CARDS_MESSAGE:"No tenemos ninguna actualizacin.<br/>Vuelva a verificar ms tarde.",FEED_TIMEOUT_MESSAGE:"Por favor, vuelva a intentarlo ms tarde."},et:{NO_CARDS_MESSAGE:"Uuendusi pole praegu saadaval.<br/>Proovige hiljem uuesti.",FEED_TIMEOUT_MESSAGE:"Palun proovige hiljem uuesti."},fi:{NO_CARDS_MESSAGE:"Pivityksi ei ole saatavilla.<br/>Tarkista myhemmin uudelleen.",FEED_TIMEOUT_MESSAGE:"Yrit myhemmin uudelleen."},fr:{NO_CARDS_MESSAGE:"Aucune mise  jour disponible.<br/>Veuillez vrifier ultrieurement.",FEED_TIMEOUT_MESSAGE:"Veuillez ressayer ultrieurement."},he:{NO_CARDS_MESSAGE:".  .    ",FEED_TIMEOUT_MESSAGE:".   "},hi:{NO_CARDS_MESSAGE:"            .",FEED_TIMEOUT_MESSAGE:"     ."},id:{NO_CARDS_MESSAGE:"Kami tidak memiliki pembaruan. Coba lagi nanti.",FEED_TIMEOUT_MESSAGE:"Coba lagi nanti."},it:{NO_CARDS_MESSAGE:"Non ci sono aggiornamenti.<br/>Ricontrollare pi tardi.",FEED_TIMEOUT_MESSAGE:"Riprovare pi tardi."},ja:{NO_CARDS_MESSAGE:"<br/>",FEED_TIMEOUT_MESSAGE:""},ko:{NO_CARDS_MESSAGE:" .    .",FEED_TIMEOUT_MESSAGE:"   ."},ms:{NO_CARDS_MESSAGE:"Tiada kemas kini. Sila periksa kemudian.",FEED_TIMEOUT_MESSAGE:"Sila cuba kemudian."},nl:{NO_CARDS_MESSAGE:"Er zijn geen updates.<br/>Probeer het later opnieuw.",FEED_TIMEOUT_MESSAGE:"Probeer het later opnieuw."},no:{NO_CARDS_MESSAGE:"Vi har ingen oppdateringer.<br/>Vennligst sjekk igjen senere.",FEED_TIMEOUT_MESSAGE:"Vennligst prv igjen senere."},pl:{NO_CARDS_MESSAGE:"Brak aktualizacji.<br/>Prosz sprawdzi ponownie pniej.",FEED_TIMEOUT_MESSAGE:"Prosz sprbowa ponownie pniej."},pt:{NO_CARDS_MESSAGE:"No temos atualizaes.<br/>Por favor, verifique mais tarde.",FEED_TIMEOUT_MESSAGE:"Por favor, tente mais tarde."},"pt-br":{NO_CARDS_MESSAGE:"No temos nenhuma atualizao.<br/>Verifique novamente mais tarde.",FEED_TIMEOUT_MESSAGE:"Tente novamente mais tarde."},ru:{NO_CARDS_MESSAGE:" .<br/>,   .",FEED_TIMEOUT_MESSAGE:",   ."},sv:{NO_CARDS_MESSAGE:"Det finns inga uppdateringar.<br/>Frsk igen senare.",FEED_TIMEOUT_MESSAGE:"Frsk igen senare."},th:{NO_CARDS_MESSAGE:" .",FEED_TIMEOUT_MESSAGE:"."},uk:{NO_CARDS_MESSAGE:" .<br/>,   .",FEED_TIMEOUT_MESSAGE:" ,    ."},vi:{NO_CARDS_MESSAGE:"Chng ti khng c cp nht no.<br/>Vui lng kim tra li sau.",FEED_TIMEOUT_MESSAGE:"Vui lng th li sau."},"zh-hk":{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."},"zh-hans":{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."},"zh-hant":{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."},"zh-tw":{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."},zh:{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."}};class aa{constructor(n,i){if(null!=n&&(n=n.toLowerCase()),null!=n&&null==hu[n]){const t=n.indexOf("-");t>0&&(n=n.substring(0,t))}if(null==hu[n]){const r="Braze does not yet have a localization for language "+n+", defaulting to English. Please contact us if you are willing and able to help us translate our SDK into this language.";i?t.j.error(r):t.j.info(r);n="en"}this.language=n}get(n){return hu[this.language][n]}}const pt={t:!1,i:null,m:()=>{if(pt.o(),!pt.i){let n=it.language,t=!1;i.nn(s.Mn)&&(n=i.nn(s.Mn),t=!0);pt.i=new aa(n,t)}return pt.i},o:()=>{pt.t||(i.g(pt),pt.t=!0)},destroy:()=>{pt.i=null,pt.t=!1}};const us="data-last-requested-refresh";kf={GOOGLE_TAG_MANAGER:"gg",MPARTICLE:"mp",SEGMENT:"sg",TEALIUM:"tl",MANUAL:"manu",NPM:"npm",CDN:"wcd",SHOPIFY:"shp"};as=Object.freeze({__proto__:null,changeUser:ls});df=Object.freeze({__proto__:null,logCustomEvent:vs});ps=Object.freeze({__proto__:null,logPurchase:ys});bs=Object.freeze({__proto__:null,requestImmediateDataFlush:ws});class sv extends lr{constructor(n,t){super();this.u=n;this.Ci=t;this.cards=[];this.Ui=null;this.u=n;this.Ci=t;this.yt=new k;i.jt(this.yt);this.Lt()}Lt(){let n=[];this.u&&(n=this.u.v(u.k.ki)||[]);const t=[];for(let i=0;i<n.length;i++){const r=go(n[i]);null!=r&&t.push(r)}this.cards=t;this.u&&(this.Ui=vi(this.u.v(u.k.Ai)))}Bi(n){const t=[];let i=null,r={};this.u&&(r=this.u.v(u.k.L)||{});const f={};for(let u=0;u<n.length;u++){i=n[u];const e=ia(i);if(null!=e){const n=e.id;n&&r[n]&&(e.viewed=!0,f[n]=!0);t.push(e)}}this.cards=t;this.Rs();this.Ui=new Date;this.u&&(this.u.D(u.k.L,f),this.u.D(u.k.Ai,this.Ui))}Rs(){if(this.u){const n=[];for(let t=0;t<this.cards.length;t++)n.push(this.cards[t].ss());this.u.D(u.k.ki,n)}}Ts(n){null!=n&&n.feed&&(this.Lt(),this.Bi(n.feed),this.yt.Et(new gi(this.cards.slice(),this.Ui)))}Ei(){this.Lt();const n=[],t=new Date;for(let i=0;i<this.cards.length;i++){const r=this.cards[i].expiresAt;let u=!0;null!=r&&(u=r>=t);u&&n.push(this.cards[i])}return new gi(n,this.Ui)}Es(){this.Ci&&this.Ci.requestFeedRefresh()}hi(n){return this.yt.lt(n)}clearData(n){null==n&&(n=!1);this.cards=[];this.Ui=null;n&&this.u&&(this.u.ri(u.k.ki),this.u.ri(u.k.Ai));this.yt.Et(new gi(this.cards.slice(),this.Ui))}}const wt={t:!1,provider:null,er:()=>(wt.o(),wt.provider||(wt.provider=new sv(i.l(),i.cr()),i.dr(wt.provider)),wt.provider),o:()=>{wt.t||(i.g(wt),wt.t=!0)},destroy:()=>{wt.provider=null,wt.t=!1}};yr=wt;class gi extends di{constructor(n,t){super(n,t)}logCardImpressions(n){su(n,!1)}logCardClick(n){ou(n,!1)}sr(){ks()}ur(){return!1}}nh=Object.freeze({__proto__:null,showFeed:gf});class au{constructor(n,t,i,r,u,f,e,o,s,h){this.Wr=n;this.Yr=t;this.Xr=i;this.Zr=u;this.sn=f;this.wt=e;this.rn=o;this.on=s;this.u=h;this.Wr=n;this.Yr=t;this.Xr=i;this.un=r+"/safari/"+t;this.Zr=u||"/service-worker.js";this.sn=f;this.wt=e;this.rn=o||!1;this.on=s||!1;this.u=h;this.hn=rt.an();this.cn=rt.fn()}ln(){return this.on}dn(n,i,r,u,f){n.unsubscribe().then(n=>{n?this.pn(i,r,u,f):(t.j.error("Failed to unsubscribe device from push."),"function"==typeof f&&f(!1))}).catch(n=>{t.j.error("Push unsubscription error: "+n),"function"==typeof f&&f(!1)})}bn(n,t,i){const r=(n=>{if("string"==typeof n)return n;if(0!==n.endpoint.indexOf("https://android.googleapis.com/gcm/send"))return n.endpoint;let i=n.endpoint;const t=n;return t.mn&&-1===n.endpoint.indexOf(t.mn)&&(i=n.endpoint+"/"+t.mn),i})(n);let u=null,f=null;if(n instanceof PushSubscription&&null!=n.getKey)try{const t=Array.from(new Uint8Array(n.getKey("p256dh"))),i=Array.from(new Uint8Array(n.getKey("auth")));u=btoa(String.fromCharCode.apply(null,t));f=btoa(String.fromCharCode.apply(null,i))}catch(n){if(n instanceof Error&&"invalid arguments"!==n.message)throw n;}const e=(n=>{let t;return n.options&&(t=n.options.applicationServerKey)&&t.byteLength&&t.byteLength>0?btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(t)))).replace(/\+/g,"-").replace(/\//g,"_"):null})(n);this.Wr&&this.Wr.yn(r,t,u,f,e);r&&"function"==typeof i&&i(r,u,f)}gn(){this.Wr&&this.Wr.wn(!0)}vn(n,i){this.Wr&&this.Wr.wn(!1);t.j.info(n);"function"==typeof i&&i(!1)}kn(n,i,r,u){var f;if("default"===i.permission)try{window.safari.pushNotification.requestPermission(this.un,n,{api_key:this.Yr,device_id:(null===(f=this.Xr)||void 0===f?void 0:f.te().id)||""},t=>{"granted"===t.permission&&this.Wr&&this.Wr.setPushNotificationSubscriptionType(h.NotificationSubscriptionTypes.OPTED_IN),this.kn(n,t,r,u)})}catch(n){this.vn("Could not request permission for push: "+n,u)}else"denied"===i.permission?this.vn("The user has blocked notifications from this site, or Safari push is not configured in the Braze dashboard.",u):"granted"===i.permission&&(t.j.info("Device successfully subscribed to push."),this.bn(i.deviceToken,new Date,r))}requestPermission(n,i,r){const u=u=>{switch(u){case"granted":return void("function"==typeof n&&n());case"default":return void("function"==typeof i&&i());case"denied":return void("function"==typeof r&&r());default:t.j.error("Received unexpected permission result "+u)}};let f=!1;const e=window.Notification.requestPermission(n=>{f&&u(n)});e?e.then(n=>{u(n)}):f=!0}pn(n,i,r,u){const f={userVisibleOnly:!0};null!=i&&(f.applicationServerKey=i);n.pushManager.subscribe(f).then(n=>{t.j.info("Device successfully subscribed to push."),this.bn(n,new Date,r)}).catch(n=>{rt.isPushBlocked()?(t.j.info("Permission for push notifications was denied."),"function"==typeof u&&u(!1)):(t.j.error("Push subscription failed: "+n),"function"==typeof u&&u(!0))})}Pn(){return this.rn?navigator.serviceWorker.getRegistration():navigator.serviceWorker.register(this.Zr).then(()=>navigator.serviceWorker.ready.then(n=>(n&&"function"==typeof n.update&&n.update().catch(n=>{t.j.info("ServiceWorker update failed: "+n)}),n)))}Dn(n){this.rn||(n.unregister(),t.j.info("Service worker successfully unregistered."))}subscribe(n,i){if(!rt.isPushSupported())return t.j.info(au.Sn),void("function"==typeof i&&i(!1));if(this.hn){if(!this.rn&&null!=window.location){let n=this.Zr;-1===n.indexOf(window.location.host)&&(n=window.location.host+n);-1===n.indexOf(window.location.protocol)&&(n=window.location.protocol+"//"+n);const r=n.substr(0,n.lastIndexOf("/")+1);if(0!==li.An().indexOf(r))return t.j.error("Cannot subscribe to push from a path higher than the service worker location (tried to subscribe from "+window.location.pathname+" but service worker is at "+n+")"),void("function"==typeof i&&i(!0))}if(rt.isPushBlocked())return void this.vn("Notifications from this site are blocked. This may be a temporary embargo or a permanent denial.",i);if(this.wt&&!this.wt.jn()&&0===this.wt.oi())return t.j.info("Waiting for VAPID key from server config before subscribing to push."),void this.wt.Un(()=>{this.subscribe(n,i)});const r=()=>{t.j.info("Permission for push notifications was denied."),"function"==typeof i&&i(!1)},f=()=>{let n="Permission for push notifications was ignored.";rt.isPushBlocked()&&(n+=" The browser has automatically blocked further permission requests for a period (probably 1 week).");t.j.info(n);"function"==typeof i&&i(!0)},e=rt.isPushPermissionGranted(),o=()=>{!e&&this.Wr&&this.Wr.setPushNotificationSubscriptionType(h.NotificationSubscriptionTypes.OPTED_IN),this.Pn().then(r=>{if(null==r)return t.j.error("No service worker registration. Set the `manageServiceWorkerExternally` initialization option to false or ensure that your service worker is registered before calling registerPush."),void("function"==typeof i&&i(!0));r.pushManager.getSubscription().then(f=>{let e=null;if(this.wt&&null!=this.wt.jn()&&(e=t._n.Wn(this.wt.jn())),f){let o,s=null,h=null;if(this.u&&(o=this.u.v(u.k.xn)),o&&!b(o)){let n;try{n=yf.Tn(o).Nn}catch(t){n=null}null==n||isNaN(n.getTime())||0===n.getTime()||(s=n,h=new Date(s),h.setMonth(s.getMonth()+6))}null!=e&&f.options&&f.options.applicationServerKey&&f.options.applicationServerKey.byteLength&&f.options.applicationServerKey.byteLength>0&&!ai(e,new Uint8Array(f.options.applicationServerKey))?(f.options.applicationServerKey.byteLength>12?t.j.info("Device was already subscribed to push using a different VAPID provider, creating new subscription."):t.j.info("Attempting to upgrade a gcm_sender_id-based push registration to VAPID - depending on the browser this may or may not result in the same gcm_sender_id-based subscription."),this.dn(f,r,e,n,i)):f.expirationTime&&new Date(f.expirationTime).valueOf()<=(new Date).valueOf()?(t.j.info("Push subscription is expired, creating new subscription."),this.dn(f,r,e,n,i)):o&&b(o)?this.dn(f,r,e,n,i):null==h?(t.j.info("No push subscription creation date found, creating new subscription."),this.dn(f,r,e,n,i)):h.valueOf()<=(new Date).valueOf()?(t.j.info("Push subscription older than 6 months, creating new subscription."),this.dn(f,r,e,n,i)):(t.j.info("Device already subscribed to push, sending existing subscription to backend."),this.bn(f,s,n))}else this.pn(r,e,n,i)}).catch(n=>{t.j.error("Error checking current push subscriptions: "+n)})}).catch(n=>{t.j.error("ServiceWorker registration failed: "+n)})};this.requestPermission(o,f,r)}else if(this.cn){if(null==this.sn||""===this.sn)return t.j.error("You must supply the safariWebsitePushId initialization option in order to use registerPush on Safari"),void("function"==typeof i&&i(!0));const r=window.safari.pushNotification.permission(this.sn);this.kn(this.sn,r,n,i)}}unsubscribe(n,i){if(!rt.isPushSupported())return t.j.info(au.Sn),void("function"==typeof i&&i());this.hn?navigator.serviceWorker.getRegistration().then(r=>{r?r.pushManager.getSubscription().then(u=>{u&&(this.gn(),u.unsubscribe().then(u=>{u?(t.j.info("Device successfully unsubscribed from push."),"function"==typeof n&&n()):(t.j.error("Failed to unsubscribe device from push."),"function"==typeof i&&i()),this.Dn(r)}).catch(n=>{t.j.error("Push unsubscription error: "+n),"function"==typeof i&&i()}))}).catch(n=>{t.j.error("Error unsubscribing from push: "+n),"function"==typeof i&&i()}):(t.j.info("Device already unsubscribed from push."),"function"==typeof n&&n())}):this.cn&&(this.gn(),t.j.info("Device unsubscribed from push."),"function"==typeof n&&n())}}au.Sn="Push notifications are not supported in this browser.";const ui={t:!1,i:null,m:()=>(ui.o(),ui.i||(ui.i=new au(i.jr(),i.ea(),i.ie(),i.Zs(),i.nn(s.na),i.nn(s.ra),i.tr(),i.nn(s.ta),i.nn(s.ia),i.l())),ui.i),o:()=>{ui.t||(i.g(ui),ui.t=!0)},destroy:()=>{ui.i=null,ui.t=!1}};vu=ui;ih=Object.freeze({__proto__:null,"default":vu});ne=Object.freeze({__proto__:null,requestPushPermission:rh});fh=Object.freeze({__proto__:null,unregisterPush:uh});class p{constructor(n,t=!1,i={}){this.id=n;this.enabled=t;this.properties=i;this.id=n;this.enabled=t;this.properties=i}getStringProperty(n){const t=this.properties[n];return null==t?(this.Er(n),null):this.Br(t)?t.value:(this.Ir("string"),null)}getNumberProperty(n){const t=this.properties[n];return null==t?(this.Er(n),null):this.Nr(t)?t.value:(this.Ir("number"),null)}getBooleanProperty(n){const t=this.properties[n];return null==t?(this.Er(n),null):this.Tr(t)?t.value:(this.Ir("boolean"),null)}ss(){const n={};return n[p.hs.ns]=this.id,n[p.hs.Fe]=this.enabled,n[p.hs.we]=this.properties,n}Ir(n){t.j.info(`Property is not of type ${n}.`)}Er(n){t.j.info(`${n} not found in feature flag properties.`)}Br(n){return"string"===n.type&&"string"==typeof n.value}Nr(n){return"number"===n.type&&"number"==typeof n.value}Tr(n){return"boolean"===n.type&&"boolean"==typeof n.value}}p.hs={ns:"id",Fe:"e",we:"pr"};p.Tt={ns:"id",Fe:"enabled",we:"properties"};class wv extends lr{constructor(n,t,r){super();this.wt=n;this.gt=t;this.u=r;this.mi=[];this.pi=0;this.wt=n;this.gt=t;this.u=r;this.gi=null;this.Fi=new k;this.wi=10;this.yi=null;this.ji=null;i.jt(this.Fi)}Ts(n){if((!this.wt||this.wt.bi())&&null!=n&&n.feature_flags){this.mi=[];for(const t of n.feature_flags){const n=yv(t);n&&this.mi.push(n)}this.pi=(new Date).getTime();this.vi();this.Fi.Et(this.mi)}}Ti(){let n={};this.u&&(n=this.u.v(u.k.Di));const t={};for(const i in n){const r=pv(n[i]);r&&(t[r.id]=r)}return t}hi(n){return this.Fi.lt(n)}refreshFeatureFlags(n,t,i=!1,r=!0){if(!this.Ri(i))return!this.gi&&this.wt&&(this.gi=this.wt.Ni(()=>{this.refreshFeatureFlags(n,t)})),void("function"==typeof t&&t());if(r&&this.qi(),!this.gt)return void("function"==typeof t&&t());const u=this.gt.Gs({},!0),e=this.gt.Ks(u,w.Qs.xi);let f=!1;this.gt.Vs(u,()=>{this.gt?(w.Xs(this.u,w.Qs.xi,(new Date).valueOf()),nu.Ys({url:`${this.gt.Zs()}/feature_flags/sync`,headers:e,data:u,O:i=>{if(!this.gt.ti(u,i,e))return f=!0,void("function"==typeof t&&t());this.gt.si();this.Ts(i);f=!1;"function"==typeof n&&n()},error:n=>{this.gt.ii(n,"retrieving feature flags"),f=!0,"function"==typeof t&&t()},ei:()=>{if(r&&f&&!this.ji){let r=this.yi;(null==r||r<1e3*this.wi)&&(r=1e3*this.wi);this.zi(Math.min(3e5,tu(1e3*this.wi,3*r)),n,t,i)}}})):"function"==typeof t&&t()})}qi(){null!=this.ji&&(clearTimeout(this.ji),this.ji=null)}zi(n=1e3*this.wi,t,i,r){this.qi();this.ji=window.setTimeout(()=>{this.refreshFeatureFlags(t,i,r)},n);this.yi=n}Ri(n){if(!this.wt)return!1;if(!n){const n=parseFloat(this.wt.Si());let i=!1;if(!isNaN(n)){if(-1===n)return t.j.info("Feature flag refreshes not allowed"),!1;i=(new Date).getTime()>=(this.pi||0)+1e3*n}if(!i)return t.j.info(`Feature flag refreshes were rate limited to ${n} seconds`),!1}return this.wt.bi()}vi(){if(this.u){const n={};for(const t of this.mi){const i=t.ss();n[t.id]=i}this.u.D(u.k.Di,n);this.u.D(u.k.$i,this.pi)}}}const bt={t:!1,provider:null,er:()=>(bt.o(),bt.provider||(bt.provider=new wv(i.tr(),i.ar(),i.l()),i.dr(bt.provider)),bt.provider),o:()=>{bt.t||(i.g(bt),bt.t=!0)},destroy:()=>{bt.provider=null,bt.t=!1}};pr=bt;te=Object.freeze({__proto__:null,refreshFeatureFlags:oh,"default":eh});hh=Object.freeze({__proto__:null,WindowUtils:li,logCardClick:ou,logCardDismissal:ko,logCardImpressions:su,logContentCardImpressions:na,logContentCardClick:ta,Card:r,Banner:ae,CaptionedImage:ve,ClassicCard:ye,ControlCard:sr,ContentCards:si,getCachedContentCards:ua,hideContentCards:ss,logContentCardsDisplayed:va,requestContentCardsRefresh:ns,showContentCards:hs,subscribeToContentCardsUpdates:cs,toggleContentCards:ya,addSdkMetadata:pa,changeUser:ls,destroy:wa,BrazeSdkMetadata:kf,DeviceProperties:c,disableSDK:ba,enableSDK:ka,getDeviceId:da,getUser:lf,initialize:ga,isDisabled:nv,logCustomEvent:vs,logPurchase:ys,openSession:tv,removeAllSubscriptions:iv,removeSubscription:rs,requestImmediateDataFlush:ws,setLogger:rv,setSdkAuthenticationSignature:uv,subscribeToSdkAuthenticationFailures:fv,toggleLogging:ev,wipeData:ov,handleBrazeAction:al,Feed:gi,getCachedFeed:hv,destroyFeed:ds,logFeedDisplayed:gs,requestFeedRefresh:ks,showFeed:gf,subscribeToFeedUpdates:th,toggleFeed:cv,InAppMessage:f,InAppMessageButton:wi,ControlMessage:yi,FullScreenMessage:bi,HtmlMessage:oi,ModalMessage:ir,SlideUpMessage:ki,automaticallyShowInAppMessages:pl,logInAppMessageButtonClick:yo,logInAppMessageClick:ao,logInAppMessageHtmlClick:fu,logInAppMessageImpression:ru,showInAppMessage:po,subscribeToInAppMessage:wo,isPushBlocked:lv,isPushPermissionGranted:av,isPushSupported:vv,requestPushPermission:rh,unregisterPush:uh,User:h,FeatureFlag:p,refreshFeatureFlags:oh,getFeatureFlag:bv,subscribeToFeatureFlagsUpdates:kv,getAllFeatureFlags:sh});ch=vh(hh);window.braze=ch;var kt="Appboy",ie="v4",re=28,dv="4.1.2",ue={PageView:3,PageEvent:4,Commerce:16},nt=mParticle.CommerceEventType,lh={"01":"sdk.iad-01.braze.com","02":"sdk.iad-02.braze.com","03":"sdk.iad-03.braze.com","04":"sdk.iad-04.braze.com","05":"sdk.iad-05.braze.com","06":"sdk.iad-06.braze.com","08":"sdk.iad-08.braze.com",EU:"sdk.fra-01.braze.eu",EU02:"sdk.fra-02.braze.eu"},fe=function(){function k(n){var t=!1;return t=s?d(n):g(n),t===!0}function d(n){var r=1,i=ee(n.EventAttributes,{products:[]}),u=a(n.EventCategory);if(!n.ProductAction)return!1;n.ProductAction.TransactionId&&(i["Transaction Id"]=n.ProductAction.TransactionId);n.ProductAction.ProductList&&n.ProductAction.ProductList.length&&(i.products=l(n.ProductAction.ProductList));t("braze.logPurchase",u,n.ProductAction.TotalAmount,n.CurrencyCode,r,i);reportEvent=braze.logPurchase(u,n.ProductAction.TotalAmount,n.CurrencyCode,r,i)}function g(i){return i.ProductAction.ProductList&&i.ProductAction.ProductList.forEach(function(u){var h,f,c,o,s;if(h=n.forwardSkuAsProductName==="True"?u.Sku:u.Name,f=r(h),u.Attributes==null&&(u.Attributes={}),u.Attributes.Sku=u.Sku,c=ee(u.Attributes,{"Transaction Id":i.ProductAction.TransactionId}),o=e(c),o==null)return"Properties did not pass validation for "+f;s=parseFloat(u.Price);t("braze.logPurchase",f,s,i.CurrencyCode,u.Quantity,o);reportEvent=braze.logPurchase(f,s,i.CurrencyCode,u.Quantity,o)}),reportEvent===!0}function a(n){let t;switch(n){case nt.ProductAddToCart:t="add_to_cart";break;case nt.ProductRemoveFromCart:t="remove_from_cart";break;case nt.ProductCheckout:t="checkout";break;case nt.ProductCheckoutOption:t="checkout_option";break;case nt.ProductClick:t="click";break;case nt.ProductViewDetail:t="view_detail";break;case nt.ProductPurchase:t="purchase";break;case nt.ProductRefund:t="refund";break;case nt.ProductAddToWishlist:t="add_to_wishlist";break;case nt.ProductRemoveFromWishlist:t="remove_from_wishlist";break;case nt.PromotionView:t="view";break;case nt.PromotionClick:t="click";break;case nt.ProductImpression:t="Impression";break;default:t="unknown"}return["eCommerce",t].join(" - ")}function tt(i){var u,f,s,o=i.EventAttributes||{},h;return o.hostname=window.location.hostname,o.title=window.document.title,s=n.setEventNameForPageView==="True"?i.EventName:window.location.pathname,u=r(s),f=e(o),t("braze.logCustomEvent",u,f),h=braze.logCustomEvent(u,f),h===!0}function v(n,i){var u,r,e;if(n==="dob")if(i instanceof Date)t("braze.getUser().setDateOfBirth",i.getFullYear(),i.getMonth()+1,i.getDate()),braze.getUser().setDateOfBirth(i.getFullYear(),i.getMonth()+1,i.getDate());else return"Can't call removeUserAttribute or setUserAttribute on forwarder "+kt+", removeUserAttribute or setUserAttribute must set 'dob' to a date";else if(n==="$Age")if(typeof i=="number")u=(new Date).getFullYear()-i,t("braze.getUser().setDateOfBirth",u,1,1),braze.getUser().setDateOfBirth(u,1,1);else return"$Age must be a number";else{if(i==null&&(i=""),!(typeof i=="string"))return"Can't call removeUserAttribute or setUserAttribute on forwarder "+kt+", removeUserAttribute or setUserAttribute must set this value to a string";if(r=[],r.push(i),t("braze.getUser()."+f[n],r),e=braze.getUser(),!e[f[n]].apply(e,r))return"removeUserAttribute or setUserAttribute on forwarder "+kt+" failed to call, an invalid attribute value was passed in"}}function c(n){var i=r(n.EventName),u=e(n.EventAttributes),f;return u==null?"Properties did not pass validation for "+i:(t("braze.logCustomEvent",i,u),f=braze.logCustomEvent(i,u),f===!0)}function it(t){var i=!1;if(t.EventDataType==ue.Commerce)i=rt(t);else if(t.EventDataType==ue.PageEvent)i=c(t);else if(t.EventDataType==ue.PageView)n.forwardScreenViews=="True"&&(i=tt(t));else return"Can't send event type to forwarder "+kt+", event type is not supported";i===!0&&h&&h(u,t)}function rt(n){return n.EventCategory===nt.ProductPurchase?(reportEvent=k(n),reportEvent===!0):(reportEvent=ut(n),reportEvent===!0)}function ut(n){return s?ft(n):ht(n)}function ft(n){var s;const t={},h=a(n.EventCategory);try{switch(n.EventCategory){case nt.PromotionClick:case nt.PromotionView:t.promotions=et(n.PromotionAction);break;case nt.ProductImpression:t.impressions=ot(n.ProductImpressions);break;default:n.ProductAction.ProductList&&(t.products=l(n.ProductAction.ProductList));var i=n.ProductAction.TransactionId,r=n.ProductAction.TotalAmount,u=n.ProductAction.TaxAmount,f=n.ProductAction.ShippingAmount,o=n.ProductAction.Affiliation;i&&(t["Transaction Id"]=i);r&&(t["Total Amount"]=r);u&&(t["Tax Amount"]=u);f&&(t["Shipping Amount"]=f);o&&(t.Affiliation=o)}s=e(n.EventAttributes);const a={EventName:h,EventAttributes:ee(t,s)};return reportEvent=c(a)}catch(v){return"Error logging commerce event"+v.message}}function et(n){return n&&n.PromotionList?n.PromotionList:[]}function ot(n){return n.length?n.map(function(n){return{"Product Impression List":n.ProductImpressionList,products:l(n.ProductList)}}):[]}function l(n){const t=[];return!n||n.length===0?t:(n.forEach(function(n){var i=st(e(n));t.push(i)}),t)}function st(n){var i={};for(var t in n)switch(t){case"Sku":i.Id=n[t];break;case"CouponCode":i["Coupon Code"]=n[t];break;case"TotalAmount":i["Total Product Amount"]=n[t];break;default:i[t]=n[t]}return i}function ht(n){var i=mParticle.eCommerce.expandCommerceEvent(n),t,r;if(i!==null){for(t=0;t<i.length;t++){r=!1;try{reportEvent=c(i[t]);reportEvent===!0&&(r=!0)}catch(u){return"Error logging page event"+u.message}}reportEvent=r===!0}return reportEvent}function ct(n){if(n in f)return v(n,null);var i=r(n);t("braze.getUser().setCustomUserAttribute",i,null);braze.getUser().setCustomUserAttribute(i,null)}function lt(n,i){if(n in f)return v(n,i);var e=r(n),u=r(i);if(i!=null&&u==null)return"Value did not pass validation for "+n;t("braze.getUser().setCustomUserAttribute",e,u);braze.getUser().setCustomUserAttribute(e,u)}function at(n,i){if(window.mParticle.getVersion().split(".")[0]==="1")if(i==window.mParticle.IdentityType.CustomerId)t("braze.changeUser",n),braze.changeUser(n);else if(i==window.mParticle.IdentityType.Email)t("braze.getUser().setEmail",n),braze.getUser().setEmail(n);else return"Can't call setUserIdentity on forwarder "+kt+", identity type not supported."}function y(i){var u,r=i.getUserIdentities().userIdentities;u=n.userIdentificationType==="MPID"?i.getMPID():r[n.userIdentificationType.toLowerCase()];t("braze.changeUser",u);braze.changeUser(u);r.email&&(t("braze.getUser().setEmail",r.email),braze.getUser().setEmail(r.email))}function vt(){braze.subscribeToInAppMessage(function(t){var r=!0,i=!1,u;t instanceof braze.InAppMessage&&(u=t.extras["msg-id"],u=="push-primer"&&(i=!0,(!braze.isPushSupported()||braze.isPushPermissionGranted()||braze.isPushBlocked())&&(r=!1),t.buttons[0]!=null&&t.buttons[0].subscribeToClickedEvent(function(){braze.requestPushPermission()})));(i&&r||!i&&n.register_inapp==="True")&&braze.showInAppMessage(t)})}function yt(n){braze.openSession();n.softPushCustomEventName&&(t("braze.logCustomEvent",n.softPushCustomEventName),braze.logCustomEvent(n.softPushCustomEventName))}function pt(t,r,f,e,c,l,a,v,y){var b,k,d;u.logger||(u.logger={verbose:function(){}});o=y;try{if(n=t,s=n.bundleCommerceEventData==="True",h=r,i.sessionTimeoutInSeconds=n.ABKSessionTimeoutKey||1800,i.sdkFlavor="mparticle",i.enableHtmlInAppMessages=n.enableHtmlInAppMessages=="True",i.doNotLoadFontAwesome=n.doNotLoadFontAwesome=="True",n.safariWebsitePushId&&(i.safariWebsitePushId=n.safariWebsitePushId),n.serviceWorkerLocation&&(i.serviceWorkerLocation=n.serviceWorkerLocation),b=n.cluster||n.dataCenterLocation,lh.hasOwnProperty(b)?i.baseUrl=lh[b]:(k=w(b),k&&(i.baseUrl=k)),o&&o[re.toString()]&&(d=o[re.toString()],typeof d.initOptions=="function"&&d.initOptions(i)),f!==!0)braze.initialize(n.apiKey,i),p(n);else{if(!braze.initialize(n.apiKey,i))return"Failed to initialize: "+kt;p(n)}return"Successfully initialized: "+kt}catch(g){return"Failed to initialize: "+kt+" with error: "+g.message}}function p(n){braze.addSdkMetadata(["mp"]);vt();n.userIdentificationType==="MPID"&&mParticle.Identity!=null&&mParticle.Identity.getCurrentUser().getMPID()!=null&&y(mParticle.Identity.getCurrentUser());yt(n)}function w(n){var i,t;if(n){i=n.replace(/&amp;/g,"&");i=n.replace(/&quot;/g,'"');try{if(t=JSON.parse(i),t&&t.JS)return"https://"+t.JS+"/api/v3"}catch(r){console.log("Unable to configure custom Braze cluster: "+r.toString())}}}function b(n){return typeof n=="string"?n.substr(0,1)==="$"?n.replace(/^\$+/g,""):n:null}function r(n){var t,r,u,i;if(typeof n=="string")return b(n);if(Array.isArray(n)){t=[];for(r in n){if(u=n[r],i=b(u),i==null)return null;t.push(i)}return t}return n}function e(n){var u={},t,f,e,i;if(n==null&&(n={}),typeof n!="object")return null;for(i in n)t=n[i],f=r(i),e=typeof t=="string"?r(t):t,u[f]=e;return u}function t(n){var t="mParticle - Braze Web Kit log:",i=Array.prototype.slice.call(arguments,1);t+="\n"+n+":\n";i.forEach(function(n){t+=oe(n)||Array.isArray(n)?JSON.stringify(n):n;t+=",\n"});u.logger.verbose(t)}var u=this,n,i={},h,o,f,s;u.name=kt;u.suffix=ie;f={$LastName:"setLastName",$FirstName:"setFirstName",Email:"setEmail",$Gender:"setGender",$Country:"setCountry",$City:"setHomeCity",$Mobile:"setPhoneNumber",$Age:"setDateOfBirth",last_name:"setLastName",first_name:"setFirstName",email:"setEmail",gender:"setGender",country:"setCountry",home_city:"setHomeCity",email_subscribe:"setEmailNotificationSubscriptionType",push_subscribe:"setPushNotificationSubscriptionType",phone:"setPhoneNumber",dob:"setDateOfBirth"};s=!1;this.init=pt;this.process=it;this.setUserIdentity=at;this.setUserAttribute=lt;this.onUserIdentified=y;this.removeUserAttribute=ct;this.decodeClusterSetting=w};return window&&window.mParticle&&window.mParticle.addForwarder&&window.mParticle.addForwarder({name:kt,constructor:fe,getId:gv,suffix:ie}),ah={register:ny,getVersion:function(){return dv}},n["default"]=ah,Object.defineProperty(n,"__esModule",{value:!0}),n}({}) ;;
; window.mParticle.config.kitConfigs.push({"name":"Appboy","moduleId":28,"isDebug":false,"isVisible":true,"isDebugString":"false","hasDebugString":"true","settings":{"softPushCustomEventName":null,"doNotLoadFontAwesome":"False","setEventNameForPageView":"False","includeEnrichedUserIdentities":"True","enableEventStreamForwarding":"False","enableAttributeTypeDetection":"None","cluster":"06","removeEventAttributeList":"","addEventAttributeList":"","forwardSkuAsProductName":"False","sendListsAsArrays":"False","emailIdentificationType":"Email","abkDisableAutomaticLocationCollectionKey":"False","apiKey":"91ac64b1-3e86-476a-9953-ccba0370c1d6","serviceWorkerLocation":null,"safariWebsitePushId":null,"abkMinimumTriggerTimeIntervalKey":null,"bundleCommerceEventData":"False","abkCollectIDFA":"False","enableHtmlInAppMessages":"True","abkRequestProcessingPolicyOptionKey":null,"register_inapp":"True","userIdentificationType":"CustomerId","includeEnrichedUserAttributes":"True","abkFlushIntervalOptionKey":null,"forwardScreenViews":"False","singleItemEventAttributeList":"","abkSessionTimeoutKey":null,"sendSessionInformation":"True","enableTypeDetection":"False","userTagsValue":"true","push_enabled":"True"},"screenNameFilters":[],"screenAttributeFilters":[],"userIdentityFilters":[],"userAttributeFilters":[],"eventNameFilters":[],"eventTypeFilters":[],"attributeFilters":[],"githubPath":null,"filteringEventAttributeValue":null,"filteringUserAttributeValue":null,"filteringConsentRuleValues":null,"consentRegulationFilters":[],"consentRegulationPurposeFilters":[],"messageTypeFilters":[],"messageTypeStateFilters":[],"eventSubscriptionId":48764,"excludeAnonymousUser":false,"suffix":"v4"});;
; window.mParticle.config.kitConfigs.push({"name":"Appboy","moduleId":28,"isDebug":true,"isVisible":true,"isDebugString":"true","hasDebugString":"false","settings":{"softPushCustomEventName":null,"doNotLoadFontAwesome":"False","setEventNameForPageView":"False","includeEnrichedUserIdentities":"True","enableEventStreamForwarding":"False","enableAttributeTypeDetection":"None","cluster":"06","removeEventAttributeList":"","addEventAttributeList":"","forwardSkuAsProductName":"False","sendListsAsArrays":"False","emailIdentificationType":"Email","abkDisableAutomaticLocationCollectionKey":"False","apiKey":"b9035229-8b5b-4c0d-9923-c1259181ce08","serviceWorkerLocation":null,"safariWebsitePushId":null,"abkMinimumTriggerTimeIntervalKey":null,"bundleCommerceEventData":"False","abkCollectIDFA":"False","enableHtmlInAppMessages":"True","abkRequestProcessingPolicyOptionKey":null,"register_inapp":"True","userIdentificationType":"CustomerId","includeEnrichedUserAttributes":"True","abkFlushIntervalOptionKey":null,"forwardScreenViews":"False","singleItemEventAttributeList":"","abkSessionTimeoutKey":null,"sendSessionInformation":"True","enableTypeDetection":"False","userTagsValue":"true","push_enabled":"True"},"screenNameFilters":[],"screenAttributeFilters":[],"userIdentityFilters":[],"userAttributeFilters":[],"eventNameFilters":[],"eventTypeFilters":[],"attributeFilters":[],"githubPath":null,"filteringEventAttributeValue":null,"filteringUserAttributeValue":null,"filteringConsentRuleValues":null,"consentRegulationFilters":[],"consentRegulationPurposeFilters":[],"messageTypeFilters":[],"messageTypeStateFilters":[],"eventSubscriptionId":48765,"excludeAnonymousUser":false,"suffix":"v4"});;
; window.mParticle.config.kitConfigs.push({"name":"Optimizely","moduleId":54,"isDebug":true,"isVisible":true,"isDebugString":"true","hasDebugString":"false","settings":{"userIdField":"otherid","useFullStack":"True","datafileInterval":null,"projectId":"N33RTBmswWmRaoUCg9hw5","eventInterval":null},"screenNameFilters":[],"screenAttributeFilters":[],"userIdentityFilters":[],"userAttributeFilters":[],"eventNameFilters":[],"eventTypeFilters":[],"attributeFilters":[],"githubPath":null,"filteringEventAttributeValue":null,"filteringUserAttributeValue":null,"filteringConsentRuleValues":null,"consentRegulationFilters":[],"consentRegulationPurposeFilters":[],"messageTypeFilters":[],"messageTypeStateFilters":[],"eventSubscriptionId":48931,"excludeAnonymousUser":false,"suffix":null});;
; window.mParticle.config.kitConfigs.push({"name":"Optimizely","moduleId":54,"isDebug":false,"isVisible":true,"isDebugString":"false","hasDebugString":"true","settings":{"userIdField":"otherid","datafileInterval":null,"useFullStack":"True","projectId":"2bvPEzigPrHgVeKpkykLo","eventInterval":null},"screenNameFilters":[],"screenAttributeFilters":[],"userIdentityFilters":[],"userAttributeFilters":[],"eventNameFilters":[],"eventTypeFilters":[],"attributeFilters":[],"githubPath":null,"filteringEventAttributeValue":null,"filteringUserAttributeValue":null,"filteringConsentRuleValues":null,"consentRegulationFilters":[],"consentRegulationPurposeFilters":[],"messageTypeFilters":[],"messageTypeStateFilters":[],"eventSubscriptionId":48932,"excludeAnonymousUser":false,"suffix":null});;
window.mParticle.config.requestConfig = false;;
mParticle.init('1fd01205ffa1f44fae751e3256894c33', window.mParticle.config);;